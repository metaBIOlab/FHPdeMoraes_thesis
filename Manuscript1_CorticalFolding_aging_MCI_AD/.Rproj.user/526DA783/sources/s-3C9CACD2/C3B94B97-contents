# taxa de caimento da girificacao (espessura)----

decay_AvgThickness <- filter(dados, Session == "1")  %>%
  group_by(Diagnostic, ROI) %>%
  do(fit_decay_AvgThickness = rlm(logAvgThickness ~ Age, data = .))

# get the coefficients por intervalo de idade ----
decay_AvgThickness_Coef = tidy(
  decay_AvgThickness,
  fit_decay_AvgThickness,
  conf.int = TRUE,
  conf.level = 0.95
)
decay_AvgThickness_Coef

decay_AvgThickness_Pred = augment(decay_AvgThickness, fit_decay_AvgThickness)
decay_AvgThickness_Pred

decay_AvgThickness_R2 = glance(decay_AvgThickness, fit_decay_AvgThickness)
decay_AvgThickness_R2

# lambda, b e Ko CTL ----

lambda_t_CTL_hemi <-
  decay_AvgThickness_Coef$estimate[decay_AvgThickness_Coef$Diagnostic == "CONTROLE" &
                                     decay_AvgThickness_Coef$term == "Age" &
                                     decay_AvgThickness_Coef$ROI == "hemisphere"]

b_t_CTL_hemi <-
  decay_AvgThickness_Coef$estimate[decay_AvgThickness_Coef$Diagnostic == "CONTROLE" &
                                     decay_AvgThickness_Coef$term == "(Intercept)" &
                                     decay_AvgThickness_Coef$ROI == "hemisphere"]

t0_CTL_hemi <- exp(b_t_CTL_hemi)

lambda_t_CTL_F <-
  decay_AvgThickness_Coef$estimate[decay_AvgThickness_Coef$Diagnostic == "CONTROLE" &
                                     decay_AvgThickness_Coef$term == "Age" &
                                     decay_AvgThickness_Coef$ROI == "F"]

b_t_CTL_F <-
  decay_AvgThickness_Coef$estimate[decay_AvgThickness_Coef$Diagnostic == "CONTROLE" &
                                     decay_AvgThickness_Coef$term == "(Intercept)" &
                                     decay_AvgThickness_Coef$ROI == "F"]

t0_CTL_F <- exp(b_t_CTL_F)

lambda_t_CTL_F <-
  decay_AvgThickness_Coef$estimate[decay_AvgThickness_Coef$Diagnostic == "CONTROLE" &
                                     decay_AvgThickness_Coef$term == "Age" &
                                     decay_AvgThickness_Coef$ROI == "F"]

b_t_CTL_F <-
  decay_AvgThickness_Coef$estimate[decay_AvgThickness_Coef$Diagnostic == "CONTROLE" &
                                     decay_AvgThickness_Coef$term == "(Intercept)" &
                                     decay_AvgThickness_Coef$ROI == "F"]

t0_CTL_F <- exp(b_t_CTL_F)

lambda_t_CTL_O <-
  decay_AvgThickness_Coef$estimate[decay_AvgThickness_Coef$Diagnostic == "CONTROLE" &
                                     decay_AvgThickness_Coef$term == "Age" &
                                     decay_AvgThickness_Coef$ROI == "O"]

b_t_CTL_O <-
  decay_AvgThickness_Coef$estimate[decay_AvgThickness_Coef$Diagnostic == "CONTROLE" &
                                     decay_AvgThickness_Coef$term == "(Intercept)" &
                                     decay_AvgThickness_Coef$ROI == "O"]

t0_CTL_O <- exp(b_t_CTL_O)

lambda_t_CTL_P <-
  decay_AvgThickness_Coef$estimate[decay_AvgThickness_Coef$Diagnostic == "CONTROLE" &
                                     decay_AvgThickness_Coef$term == "Age" &
                                     decay_AvgThickness_Coef$ROI == "P"]

b_t_CTL_P <-
  decay_AvgThickness_Coef$estimate[decay_AvgThickness_Coef$Diagnostic == "CONTROLE" &
                                     decay_AvgThickness_Coef$term == "(Intercept)" &
                                     decay_AvgThickness_Coef$ROI == "P"]

t0_CTL_P <- exp(b_t_CTL_P)

lambda_t_CTL_T <-
  decay_AvgThickness_Coef$estimate[decay_AvgThickness_Coef$Diagnostic == "CONTROLE" &
                                     decay_AvgThickness_Coef$term == "Age" &
                                     decay_AvgThickness_Coef$ROI == "T"]

b_t_CTL_T <-
  decay_AvgThickness_Coef$estimate[decay_AvgThickness_Coef$Diagnostic == "CONTROLE" &
                                     decay_AvgThickness_Coef$term == "(Intercept)" &
                                     decay_AvgThickness_Coef$ROI == "T"]

t0_CTL_T <- exp(b_t_CTL_T)
