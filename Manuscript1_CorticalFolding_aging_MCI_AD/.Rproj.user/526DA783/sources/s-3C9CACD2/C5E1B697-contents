# CORRIGINDO OS PARAMETROS PELA IDADE ----

# AvgThickness -----

source("analises/decaimento_idade/decay_thickness.R")

dados <- mutate(dados,
                logAvgThickness_age_decay = as.numeric(
                  ifelse(
                    dados$ROI == "hemisphere",
                    dados$logAvgThickness - lambda_t_CTL_hemi * (dados$Age - Idade),
                    ifelse(
                      dados$ROI == "F",
                      dados$logAvgThickness  - lambda_t_CTL_F * (dados$Age - Idade),
                      ifelse(
                        dados$ROI == "O",
                        dados$logAvgThickness  - lambda_t_CTL_O * (dados$Age - Idade),
                        ifelse(
                          dados$ROI == "P",
                          dados$logAvgThickness  - lambda_t_CTL_P * (dados$Age - Idade),
                          dados$logAvgThickness  - lambda_t_CTL_T * (dados$Age - Idade)
                        )
                      )
                    )
                  )
                ))

# AreaTotal ----

source("analises/decaimento_idade/decay_areatotal.R")

dados <- mutate(dados,
                logTotalArea_age_decay = as.numeric(
                  ifelse(
                    dados$ROI == "hemisphere",
                    dados$logTotalArea_corrected - lambda_At_CTL_hemi * (dados$Age - Idade),
                    ifelse(
                      dados$ROI == "F",
                      dados$logTotalArea_corrected - lambda_At_CTL_F * (dados$Age - Idade),
                      ifelse(
                        dados$ROI == "O",
                        dados$logTotalArea_corrected - lambda_At_CTL_O * (dados$Age - Idade),
                        ifelse(
                          dados$ROI == "P",
                          dados$logTotalArea_corrected - lambda_At_CTL_P * (dados$Age - Idade),
                          dados$logTotalArea_corrected - lambda_At_CTL_T * (dados$Age - Idade)
                        )
                      )
                    )
                  )
                ))

# ExposedArea ----

source("analises/decaimento_idade/decay_areasmooth.R")

dados <- mutate(dados,
                logExposedArea_age_decay = as.numeric(
                  ifelse(
                    dados$ROI == "hemisphere",
                    dados$logExposedArea_corrected - lambda_Ae_CTL_hemi * (dados$Age - Idade),
                    ifelse(
                      dados$ROI == "F",
                      dados$logExposedArea_corrected - lambda_Ae_CTL_F * (dados$Age - Idade),
                      ifelse(
                        dados$ROI == "O",
                        dados$logExposedArea_corrected - lambda_Ae_CTL_O * (dados$Age - Idade),
                        ifelse(
                          dados$ROI == "P",
                          dados$logExposedArea_corrected - lambda_Ae_CTL_P * (dados$Age - Idade),
                          dados$logExposedArea_corrected - lambda_Ae_CTL_T * (dados$Age - Idade)
                        )
                      )
                    )
                  )
                ))

# LocalGI ----

source("analises/decaimento_idade/decay_localgI.R")

dados <- mutate(dados,
                localGI_age_decay = as.numeric(
                  ifelse(
                    dados$ROI == "hemisphere",
                    dados$localGI - lambda_lGI_CTL_hemi * (dados$Age - Idade),
                    ifelse(
                      dados$ROI == "F",
                      dados$localGI - lambda_lGI_CTL_F * (dados$Age - Idade),
                      ifelse(
                        dados$ROI == "O",
                        dados$localGI - lambda_lGI_CTL_O * (dados$Age - Idade),
                        ifelse(
                          dados$ROI == "P",
                          dados$localGI - lambda_lGI_CTL_P * (dados$Age - Idade),
                          dados$localGI - lambda_lGI_CTL_T * (dados$Age - Idade)
                        )
                      )
                    )
                  )
                ))


# logkteorico ----

#source("analises/decaimento_idade/decay_logkteorico.R")

dados <- dados %>% 
  mutate(
    logkteorico_age_decay = (
      dados$log_TotalArea_age_decay + (1 / 2) * dados$log_AvgThickness_age_decay -
        ((5/4) * dados$log_ExposedArea_age_decay)
    )
  )