# PREPARO --------

# define a area de trabalho ----
setwd("F:/idor/Gyrification/") # se no pendrive
#setwd("~/idor/Gyrification/") # se no computador

# PREPARO ----
source("RRRRRR/aging/V6/preparo/preparo.R")

# organiza os arquivos ----
source("RRRRRR/aging/V6/organiza/rotina_arquivos_hemisferio.R")
# source("RRRRRR/aging/V6/rotina_arquivos_neuroquant_comparisson.R")

# retira os outros diagnosticos e deixa so Philips
dados_all <- dados
dados_raw <- dados

dados <-
  filter(
    dados,
    Diagnostic == "CONTROLE" |
      Diagnostic == "CCL" | Diagnostic == "ALZ",
    RM_Maquina == "Philips"
  )

# organiza para calculo dos follows
source("RRRRRR/aging/V6/organiza/wide_organizer.R")

# FOLLOW UP - ve as diferencas entre a ultima e a primeira visita ----
source("RRRRRR/aging/V6/analises/analise_follow/evolucao.R")

# separa em arquivo de hemisferios e de lobos ----

dados_hemi <- filter(dados, ROI == "hemisphere", Visit == 1)

dados_lobos <- filter(dados, ROI == "F" | ROI == "T" | ROI == "O" | ROI == "P", Visit == 1)

dados$Diagnostic <- as.factor(dados$Diagnostic)
dados$Age_interval10 <- as.factor(dados$Age_interval10)
dados$Sex <- as.factor(dados$Sex)
dados$ROI <- as.factor(dados$ROI)


dados_hemi$Diagnostic <- as.factor(dados_hemi$Diagnostic)
dados_hemi$Age_interval10 <- as.factor(dados_hemi$Age_interval10)
dados_hemi$Sex <- as.factor(dados_hemi$Sex)

dados_lobos$Diagnostic <- as.factor(dados_lobos$Diagnostic)
dados_lobos$Age_interval10 <- as.factor(dados_lobos$Age_interval10)
dados_lobos$Sex <- as.factor(dados_lobos$Sex)
dados_lobos$ROI <- as.factor(dados_lobos$ROI)

# Analises exploratorias ----
# basic_eda(dados)
# basic_eda(filter(dados_hemi))
# basic_eda(filter(dados_lobos))

# teste de normalidade ----
#source("RRRRRR/aging/V6/teste_normalidade.R")

# analises estatisticas ----
## hemisferios
source("RRRRRR/aging/V6/analises/analise_regressao.R")

# COMPARACAO COM OS DADOS DO ARTIGO ORIGINAL MOTTA&HOUZEL 2015 ----

source("RRRRRR/aging/V6/analises/MotaHouzel2015/comp_paper.R")

# INFLUENCIA DO GENERO, IDADE e DIAGNOSTICO ----

source("RRRRRR/aging/V6/analises/influencia_hemi.R")
source("RRRRRR/aging/V6/analises/influencia_sex.R")
source("RRRRRR/aging/V6/analises/influencia_idade.R")
source("RRRRRR/aging/V6/analises/influencia_diag.R")
source("RRRRRR/aging/V6/analises/influencia_sex_diag.R")
source("RRRRRR/aging/V6/analises/influencia_diag_age.R")

## TAXA DE DECAIMENTO DA GIRIFICACAO comparando o "decaimento" da girificacao com a idade ----
# corrigindo as medidas pela idade ----
Idade <- 25

source("RRRRRR/aging/V6/analises/decaimento_idade/decaimento_grafico.R")


decay_log_kteorico_Coef %>% pander
model_age_corr_decay

# LOBOS ----

source("RRRRRR/aging/V6/analises/lobos/analise_lobos.R")