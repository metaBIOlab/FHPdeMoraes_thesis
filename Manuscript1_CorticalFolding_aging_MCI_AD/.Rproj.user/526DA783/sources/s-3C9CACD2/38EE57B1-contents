# LOCALGI - COM CORRECAO LONGITUDINAL

decay_localGI_longcor <- filter(dados, Session == "1" , Longitudinal_correction == "yes")  %>%
  group_by(Diagnostic, ROI) %>%
  do(fit_decay_localGI_longcor = lm(localGI ~ Age, data = .))

# get the coefficients por intervalo de idade ----
decay_localGI_Coef = tidy(
  decay_localGI_longcor,
  fit_decay_localGI_longcor,
  conf.int = TRUE,
  conf.level = 0.95
)

# lambda, b e Ko CTL ----

lambda_lGI_CTL_hemi_longcor <-
  decay_localGI_Coef_longcor$estimate[decay_localGI_Coef_longcor$Diagnostic == "CONTROLE" &
                                        decay_localGI_Coef_longcor$term == "Age" &
                                        decay_localGI_Coef_longcor$ROI == "hemisphere"]

b_lGI_CTL_hemi_longcor <-
  decay_localGI_Coef_longcor$estimate[decay_localGI_Coef_longcor$Diagnostic == "CONTROLE" &
                                        decay_localGI_Coef_longcor$term == "(Intercept)" &
                                        decay_localGI_Coef_longcor$ROI == "hemisphere"]

lambda_lGI_CTL_F_longcor <-
  decay_localGI_Coef_longcor$estimate[decay_localGI_Coef_longcor$Diagnostic == "CONTROLE" &
                                        decay_localGI_Coef_longcor$term == "Age" &
                                        decay_localGI_Coef_longcor$ROI == "F"]

b_lGI_CTL_F_longcor <-
  decay_localGI_Coef_longcor$estimate[decay_localGI_Coef_longcor$Diagnostic == "CONTROLE" &
                                        decay_localGI_Coef_longcor$term == "(Intercept)" &
                                        decay_localGI_Coef_longcor$ROI == "F"]

lambda_lGI_CTL_O_longcor <-
  decay_localGI_Coef_longcor$estimate[decay_localGI_Coef_longcor$Diagnostic == "CONTROLE" &
                                        decay_localGI_Coef_longcor$term == "Age" &
                                        decay_localGI_Coef_longcor$ROI == "O"]

b_lGI_CTL_O_longcor <-
  decay_localGI_Coef_longcor$estimate[decay_localGI_Coef_longcor$Diagnostic == "CONTROLE" &
                                        decay_localGI_Coef_longcor$term == "(Intercept)" &
                                        decay_localGI_Coef_longcor$ROI == "O"]

lambda_lGI_CTL_P_longcor <-
  decay_localGI_Coef_longcor$estimate[decay_localGI_Coef_longcor$Diagnostic == "CONTROLE" &
                                        decay_localGI_Coef_longcor$term == "Age" &
                                        decay_localGI_Coef_longcor$ROI == "P"]

b_lGI_CTL_P_longcor <-
  decay_localGI_Coef_longcor$estimate[decay_localGI_Coef_longcor$Diagnostic == "CONTROLE" &
                                        decay_localGI_Coef_longcor$term == "(Intercept)" &
                                        decay_localGI_Coef_longcor$ROI == "P"]

lambda_lGI_CTL_T_longcor <-
  decay_localGI_Coef_longcor$estimate[decay_localGI_Coef_longcor$Diagnostic == "CONTROLE" &
                                        decay_localGI_Coef_longcor$term == "Age" &
                                        decay_localGI_Coef_longcor$ROI == "T"]

b_lGI_CTL_T_longcor <-
  decay_localGI_Coef_longcor$estimate[decay_localGI_Coef_longcor$Diagnostic == "CONTROLE" &
                                        decay_localGI_Coef_longcor$term == "(Intercept)" &
                                        decay_localGI_Coef_longcor$ROI == "T"]

lambda_lGI_CTL_CC_longcor <-
  decay_localGI_Coef_longcor$estimate[decay_localGI_Coef_longcor$Diagnostic == "CONTROLE" &
                                        decay_localGI_Coef_longcor$term == "Age" &
                                        decay_localGI_Coef_longcor$ROI == "CC"]

b_lGI_CTL_CC_longcor <-
  decay_localGI_Coef_longcor$estimate[decay_localGI_Coef_longcor$Diagnostic == "CONTROLE" &
                                        decay_localGI_Coef_longcor$term == "(Intercept)" &
                                        decay_localGI_Coef_longcor$ROI == "CC"]
