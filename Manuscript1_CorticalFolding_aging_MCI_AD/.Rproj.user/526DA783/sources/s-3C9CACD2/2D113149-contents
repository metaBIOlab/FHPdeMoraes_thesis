# taxa de caimento da girificacao (log k teorico)----

decay_ExposedArea <- dados  %>%
  group_by(Diagnostic, ROI) %>%
  do(fit_decay_ExposedArea = rlm(logExposedArea_corrected ~ Age, data = .))

# get the coefficients por intervalo de idade ----
decay_ExposedArea_Coef = tidy(
  decay_ExposedArea,
  fit_decay_ExposedArea,
  conf.int = TRUE,
  conf.level = 0.95
)
decay_ExposedArea_Coef

# lambda, b e Ko CTL ----

lambda_Ae_CTL_hemi <-
  decay_ExposedArea_Coef$estimate[decay_ExposedArea_Coef$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef$term == "Age" &
                                    decay_ExposedArea_Coef$ROI == "hemisphere"]

b_Ae_CTL_hemi <-
  decay_ExposedArea_Coef$estimate[decay_ExposedArea_Coef$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef$term == "(Intercept)" &
                                    decay_ExposedArea_Coef$ROI == "hemisphere"]


lambda_Ae_CTL_F <-
  decay_ExposedArea_Coef$estimate[decay_ExposedArea_Coef$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef$term == "Age" &
                                    decay_ExposedArea_Coef$ROI == "F"]

b_Ae_CTL_F <-
  decay_ExposedArea_Coef$estimate[decay_ExposedArea_Coef$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef$term == "(Intercept)" &
                                    decay_ExposedArea_Coef$ROI == "F"]
lambda_Ae_CTL_O <-
  decay_ExposedArea_Coef$estimate[decay_ExposedArea_Coef$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef$term == "Age" &
                                    decay_ExposedArea_Coef$ROI == "O"]

b_Ae_CTL_O <-
  decay_ExposedArea_Coef$estimate[decay_ExposedArea_Coef$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef$term == "(Intercept)" &
                                    decay_ExposedArea_Coef$ROI == "O"]


lambda_Ae_CTL_P <-
  decay_ExposedArea_Coef$estimate[decay_ExposedArea_Coef$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef$term == "Age" &
                                    decay_ExposedArea_Coef$ROI == "P"]

b_Ae_CTL_P <-
  decay_ExposedArea_Coef$estimate[decay_ExposedArea_Coef$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef$term == "(Intercept)" &
                                    decay_ExposedArea_Coef$ROI == "P"]

lambda_Ae_CTL_T <-
  decay_ExposedArea_Coef$estimate[decay_ExposedArea_Coef$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef$term == "Age" &
                                    decay_ExposedArea_Coef$ROI == "T"]

b_Ae_CTL_T <-
  decay_ExposedArea_Coef$estimate[decay_ExposedArea_Coef$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef$term == "(Intercept)" &
                                    decay_ExposedArea_Coef$ROI == "T"]

lambda_Ae_CTL_insula <-
  decay_ExposedArea_Coef$estimate[decay_ExposedArea_Coef$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef$term == "Age" &
                                    decay_ExposedArea_Coef$ROI == "Insula"]

b_Ae_CTL_insula <-
  decay_ExposedArea_Coef$estimate[decay_ExposedArea_Coef$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef$term == "(Intercept)" &
                                    decay_ExposedArea_Coef$ROI == "Insula"]
lambda_Ae_CTL_CC <-
  decay_ExposedArea_Coef$estimate[decay_ExposedArea_Coef$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef$term == "Age" &
                                    decay_ExposedArea_Coef$ROI == "CC"]
b_Ae_CTL_CC <-
  decay_ExposedArea_Coef$estimate[decay_ExposedArea_Coef$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef$term == "(Intercept)" &
                                    decay_ExposedArea_Coef$ROI == "CC"]

# COM CORRECAO LONGITUDINAL -----

decay_ExposedArea_long_cor <- dados  %>%
  group_by(Diagnostic, ROI) %>%
  do(fit_decay_ExposedArea_long_cor = rlm(logExposedArea_corrected ~ Age, data = .))

# get the coefficients por intervalo de idade ----
decay_ExposedArea_Coef_long_cor = tidy(
  decay_ExposedArea_long_cor,
  fit_decay_ExposedArea_long_cor,
  conf.int = TRUE,
  conf.level = 0.95
)
decay_ExposedArea_Coef_long_cor

# lambda, b e Ko CTL ----

lambda_Ae_CTL_hemi_long_cor <-
  decay_ExposedArea_Coef_long_cor$estimate[decay_ExposedArea_Coef_long_cor$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef_long_cor$term == "Age" &
                                    decay_ExposedArea_Coef_long_cor$ROI == "hemisphere"]

b_Ae_CTL_hemi_long_cor <-
  decay_ExposedArea_Coef_long_cor$estimate[decay_ExposedArea_Coef_long_cor$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef_long_cor$term == "(Intercept)" &
                                    decay_ExposedArea_Coef_long_cor$ROI == "hemisphere"]

lambda_Ae_CTL_F_long_cor <-
  decay_ExposedArea_Coef_long_cor$estimate[decay_ExposedArea_Coef_long_cor$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef_long_cor$term == "Age" &
                                    decay_ExposedArea_Coef_long_cor$ROI == "F"]

b_Ae_CTL_F_long_cor <-
  decay_ExposedArea_Coef_long_cor$estimate[decay_ExposedArea_Coef_long_cor$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef_long_cor$term == "(Intercept)" &
                                    decay_ExposedArea_Coef_long_cor$ROI == "F"]

lambda_Ae_CTL_O_long_cor <-
  decay_ExposedArea_Coef_long_cor$estimate[decay_ExposedArea_Coef_long_cor$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef_long_cor$term == "Age" &
                                    decay_ExposedArea_Coef_long_cor$ROI == "O"]

b_Ae_CTL_O_long_cor <-
  decay_ExposedArea_Coef_long_cor$estimate[decay_ExposedArea_Coef_long_cor$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef_long_cor$term == "(Intercept)" &
                                    decay_ExposedArea_Coef_long_cor$ROI == "O"]

lambda_Ae_CTL_P_long_cor <-
  decay_ExposedArea_Coef_long_cor$estimate[decay_ExposedArea_Coef_long_cor$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef_long_cor$term == "Age" &
                                    decay_ExposedArea_Coef_long_cor$ROI == "P"]

b_Ae_CTL_P_long_cor <-
  decay_ExposedArea_Coef_long_cor$estimate[decay_ExposedArea_Coef_long_cor$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef_long_cor$term == "(Intercept)" &
                                    decay_ExposedArea_Coef_long_cor$ROI == "P"]

lambda_Ae_CTL_T_long_cor <-
  decay_ExposedArea_Coef_long_cor$estimate[decay_ExposedArea_Coef_long_cor$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef_long_cor$term == "Age" &
                                    decay_ExposedArea_Coef_long_cor$ROI == "T"]

b_Ae_CTL_T_long_cor <-
  decay_ExposedArea_Coef_long_cor$estimate[decay_ExposedArea_Coef_long_cor$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef_long_cor$term == "(Intercept)" &
                                    decay_ExposedArea_Coef_long_cor$ROI == "T"]

lambda_Ae_CTL_insula_long_cor <-
  decay_ExposedArea_Coef_long_cor$estimate[decay_ExposedArea_Coef_long_cor$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef_long_cor$term == "Age" &
                                    decay_ExposedArea_Coef_long_cor$ROI == "Insula"]

b_Ae_CTL_insula_long_cor <-
  decay_ExposedArea_Coef_long_cor$estimate[decay_ExposedArea_Coef_long_cor$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef_long_cor$term == "(Intercept)" &
                                    decay_ExposedArea_Coef_long_cor$ROI == "Insula"]

lambda_Ae_CTL_CC_long_cor <-
  decay_ExposedArea_Coef_long_cor$estimate[decay_ExposedArea_Coef_long_cor$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef_long_cor$term == "Age" &
                                    decay_ExposedArea_Coef_long_cor$ROI == "CC"]

b_Ae_CTL_CC_long_cor <-
  decay_ExposedArea_Coef_long_cor$estimate[decay_ExposedArea_Coef_long_cor$Diagnostic == "CONTROLE" &
                                    decay_ExposedArea_Coef_long_cor$term == "(Intercept)" &
                                    decay_ExposedArea_Coef_long_cor$ROI == "CC"]