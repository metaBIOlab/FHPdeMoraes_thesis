---
title: "Typical"
author: "Fernanda Hansen P. de Moraes"
date: "05/03/2021"
output: 
  html_document: 
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message=FALSE)
knitr::opts_chunk$set(warning=FALSE)
```

```{r preparo, message=FALSE, warning=FALSE, include=FALSE}
# PREPARO

# define a area de trabalho
setwd("C:/Users/ferna/Documents/idor/Gyrification/RRRRRR/comparing_samples/") # se no computador

# carrega os pacotes utilizados
source("01-call_packages.R")

# Chama funcoes caso necess√°rio
source("02-funcoes.R")

# onde estao os arquivos de resultados:
path <- str_c("C:/Users/ferna/Documents/idor/Gyrification/STATS/long_tables/")

path_yujiangscript <- str_c("C:/Users/ferna/Documents/idor/Gyrification/STATS/Wang_code_extraction/")

path_yujiangscript_newsurfaces <- str_c("C:/Users/ferna/Documents/idor/Gyrification/STATS/Wang_code_extraction/")
  
path_lobes <- str_c("C:/Users/ferna/Documents/idor/Gyrification/STATS/LobesScaling/")
 
path_sessions <- str_c("C:/Users/ferna/Documents/idor/Gyrification/Processamento_longitudinal/V6/data/")

Age.cor = 25

# Prepara os dados para analise
source("05-analises_prep.R")

dados_datasetscomp <- dados_datasetscomp %>% filter(Sample != "HCP500r")

# dados_datasetscomp <- dados_datasetscomp %>% filter(Age == 18 | Age > 18)

# write.csv(dados_datasetscomp,"dados_datasetscomp.csv")
```

# Decreasing rate

```{r}
dados_datasetscomp_rate <- filter(dados_datasetscomp, ROI == "hemisphere", Diagnostic == "CTL" | Diagnostic == "MCI"| Diagnostic == "AD", Sample != "IDOR-CCD-Control")
dados_datasetscomp_rate$Diagnostic <- factor(dados_datasetscomp_rate$Diagnostic, levels = c("CTL", "MCI","AD"))
dados_datasetscomp_rate$Sample <- as.factor(dados_datasetscomp_rate$Sample)

N_SUBJ <- dados_datasetscomp_rate %>% group_by(Diagnostic) %>% summarise(N_SUBJ = n_distinct(SUBJ))

```


## AvgThickness \~ Age

```{r}
m.1 <- lme4::lmer(Age ~ AvgThickness * Diagnostic + (1|Sample/Diagnostic), data = dados_datasetscomp_rate)

performance::check_model(m.1)

anova(m.1)
summary(m.1)
sigma.hat(m.1)
r.squaredGLMM(m.1)

```

## K \~ Age

```{r}
m.1 <- lme4::lmer(Age ~ K * Diagnostic + (1|Sample/Diagnostic), data = dados_datasetscomp_rate)

performance::check_model(m.1)

anova(m.1)
summary(m.1)
sigma.hat(m.1)
r.squaredGLMM(m.1)

```

## S \~ Age

```{r}
m.1 <- lme4::lmer(Age ~ S * Diagnostic + (1|Sample/Diagnostic), data = dados_datasetscomp_rate)

performance::check_model(m.1)

anova(m.1)
summary(m.1)
sigma.hat(m.1)
r.squaredGLMM(m.1)

```

## I \~ Age

```{r}
m.1 <- lme4::lmer(Age ~ I * Diagnostic + (1|Sample/Diagnostic), data = dados_datasetscomp_rate)

performance::check_model(m.1)

anova(m.1)
summary(m.1)
sigma.hat(m.1)
r.squaredGLMM(m.1)

```
