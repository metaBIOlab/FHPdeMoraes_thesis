# taxa de caimento da girificacao (log k teorico)----

decay_TotalArea <- dados  %>%
  group_by(Diagnostic, ROI) %>%
  do(fit_decay_TotalArea = rlm(logTotalArea_corrected ~ Age, data = .))

# get the coefficients por intervalo de idade ----
decay_TotalArea_Coef = tidy(decay_TotalArea,
                            fit_decay_TotalArea,
                            conf.int = TRUE,
                            conf.level = 0.95)

# lambda, b e Ko CTL ----

lambda_At_CTL_hemi <-
  decay_TotalArea_Coef$estimate[decay_TotalArea_Coef$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef$term == "Age" &
                                  decay_TotalArea_Coef$ROI == "hemisphere"]

b_At_CTL_hemi <-
  decay_TotalArea_Coef$estimate[decay_TotalArea_Coef$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef$term == "(Intercept)" &
                                  decay_TotalArea_Coef$ROI == "hemisphere"]


lambda_At_CTL_F <-
  decay_TotalArea_Coef$estimate[decay_TotalArea_Coef$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef$term == "Age" &
                                  decay_TotalArea_Coef$ROI == "F"]

b_At_CTL_F <-
  decay_TotalArea_Coef$estimate[decay_TotalArea_Coef$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef$term == "(Intercept)" &
                                  decay_TotalArea_Coef$ROI == "F"]

lambda_At_CTL_O <-
  decay_TotalArea_Coef$estimate[decay_TotalArea_Coef$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef$term == "Age" &
                                  decay_TotalArea_Coef$ROI == "O"]

b_At_CTL_O <-
  decay_TotalArea_Coef$estimate[decay_TotalArea_Coef$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef$term == "(Intercept)" &
                                  decay_TotalArea_Coef$ROI == "O"]


lambda_At_CTL_P <-
  decay_TotalArea_Coef$estimate[decay_TotalArea_Coef$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef$term == "Age" &
                                  decay_TotalArea_Coef$ROI == "P"]

b_At_CTL_P <-
  decay_TotalArea_Coef$estimate[decay_TotalArea_Coef$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef$term == "(Intercept)" &
                                  decay_TotalArea_Coef$ROI == "P"]

lambda_At_CTL_T <-
  decay_TotalArea_Coef$estimate[decay_TotalArea_Coef$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef$term == "Age" &
                                  decay_TotalArea_Coef$ROI == "T"]

b_At_CTL_T <-
  decay_TotalArea_Coef$estimate[decay_TotalArea_Coef$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef$term == "(Intercept)" &
                                  decay_TotalArea_Coef$ROI == "T"]

lambda_At_CTL_insula <-
  decay_TotalArea_Coef$estimate[decay_TotalArea_Coef$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef$term == "Age" &
                                  decay_TotalArea_Coef$ROI == "Insula"]

b_At_CTL_insula <-
  decay_TotalArea_Coef$estimate[decay_TotalArea_Coef$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef$term == "(Intercept)" &
                                  decay_TotalArea_Coef$ROI == "Insula"]

lambda_At_CTL_CC <-
  decay_TotalArea_Coef$estimate[decay_TotalArea_Coef$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef$term == "Age" &
                                  decay_TotalArea_Coef$ROI == "CC"]

b_At_CTL_CC <-
  decay_TotalArea_Coef$estimate[decay_TotalArea_Coef$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef$term == "(Intercept)" &
                                  decay_TotalArea_Coef$ROI == "CC"]
# COM CORRECAO LONGITUDINAL ----

decay_TotalArea_longcor <- dados  %>%
  group_by(Diagnostic, ROI) %>%
  do(fit_decay_TotalArea_longcor = rlm(logTotalArea_corrected ~ Age, data = .))

# get the coefficients por intervalo de idade ----
decay_TotalArea_Coef_longcor = tidy(
  decay_TotalArea_longcor,
  fit_decay_TotalArea_longcor,
  conf.int = TRUE,
  conf.level = 0.95
)

# lambda, b e Ko CTL ----

lambda_At_CTL_hemi_longcor <-
  decay_TotalArea_Coef_longcor$estimate[decay_TotalArea_Coef_longcor$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef_longcor$term == "Age" &
                                  decay_TotalArea_Coef_longcor$ROI == "hemisphere"]

b_At_CTL_hemi_longcor <-
  decay_TotalArea_Coef_longcor$estimate[decay_TotalArea_Coef_longcor$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef_longcor$term == "(Intercept)" &
                                  decay_TotalArea_Coef_longcor$ROI == "hemisphere"]


lambda_At_CTL_F_longcor <-
  decay_TotalArea_Coef_longcor$estimate[decay_TotalArea_Coef_longcor$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef_longcor$term == "Age" &
                                  decay_TotalArea_Coef_longcor$ROI == "F"]

b_At_CTL_F_longcor <-
  decay_TotalArea_Coef_longcor$estimate[decay_TotalArea_Coef_longcor$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef_longcor$term == "(Intercept)" &
                                  decay_TotalArea_Coef_longcor$ROI == "F"]

lambda_At_CTL_O_longcor <-
  decay_TotalArea_Coef_longcor$estimate[decay_TotalArea_Coef_longcor$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef_longcor$term == "Age" &
                                  decay_TotalArea_Coef_longcor$ROI == "O"]

b_At_CTL_O_longcor <-
  decay_TotalArea_Coef_longcor$estimate[decay_TotalArea_Coef_longcor$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef_longcor$term == "(Intercept)" &
                                  decay_TotalArea_Coef_longcor$ROI == "O"]


lambda_At_CTL_P_longcor <-
  decay_TotalArea_Coef_longcor$estimate[decay_TotalArea_Coef_longcor$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef_longcor$term == "Age" &
                                  decay_TotalArea_Coef_longcor$ROI == "P"]

b_At_CTL_P_longcor <-
  decay_TotalArea_Coef_longcor$estimate[decay_TotalArea_Coef_longcor$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef_longcor$term == "(Intercept)" &
                                  decay_TotalArea_Coef_longcor$ROI == "P"]


lambda_At_CTL_T_longcor <-
  decay_TotalArea_Coef_longcor$estimate[decay_TotalArea_Coef_longcor$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef_longcor$term == "Age" &
                                  decay_TotalArea_Coef_longcor$ROI == "T"]

b_At_CTL_T_longcor <-
  decay_TotalArea_Coef_longcor$estimate[decay_TotalArea_Coef_longcor$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef_longcor$term == "(Intercept)" &
                                  decay_TotalArea_Coef_longcor$ROI == "T"]


lambda_At_CTL_insula_longcor <-
  decay_TotalArea_Coef_longcor$estimate[decay_TotalArea_Coef_longcor$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef_longcor$term == "Age" &
                                  decay_TotalArea_Coef_longcor$ROI == "Insula"]

b_At_CTL_insula_longcor <-
  decay_TotalArea_Coef_longcor$estimate[decay_TotalArea_Coef_longcor$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef_longcor$term == "(Intercept)" &
                                  decay_TotalArea_Coef_longcor$ROI == "Insula"]

lambda_At_CTL_CC_longcor <-
  decay_TotalArea_Coef_longcor$estimate[decay_TotalArea_Coef_longcor$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef_longcor$term == "Age" &
                                  decay_TotalArea_Coef_longcor$ROI == "CC"]

b_At_CTL_CC_longcor <-
  decay_TotalArea_Coef_longcor$estimate[decay_TotalArea_Coef_longcor$Diagnostic == "CONTROLE" &
                                  decay_TotalArea_Coef_longcor$term == "(Intercept)" &
                                  decay_TotalArea_Coef_longcor$ROI == "CC"]
