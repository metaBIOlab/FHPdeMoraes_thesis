---
title: "Relatorio PRJ Girificacao"
author: "Fernanda Hansen Pacheco de Moraes"
date: "11 de dezembro de 2018"
output:
  html_document:
    df_print: kable
    fig_caption: yes
    number_sections: yes
    theme: paper
    toc: yes
    toc_depth: 5
  pdf_document:
    toc: yes
    toc_depth: '5'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)
```

```{r rotinas preparo, message=FALSE, warning=FALSE, include=FALSE}
source("preparo/preparo.R")

source("organiza/rotina_arquivos_hemisferio.R")

dados_all <- dados

dados <-
filter(
dados,
Diagnostic == "CONTROLE" |
Diagnostic == "CCL" |
Diagnostic == "ALZ",
RM_Maquina == "Philips",
Visit == 1
)

dados_hemi_v1 <- filter(dados,
ROI == "hemisphere",
Visit == 1,
Longitudinal_correction == "no")

dados_lobos_v1 <-
filter(dados, ROI == "F" |
ROI == "T" | ROI == "O" | ROI == "P", Visit == 1)

dados_CC <- filter(dados, ROI == "CC", Visit == 1)

```

# Metodo

## Numero de sujeitos

```{r N sujeitos, echo=FALSE, message=FALSE, warning=FALSE}
summary_dados_all <- filter(dados_all, Visit == 1) %>%
  group_by(Diagnostic) %>%
  summarise(
  N = n_distinct(SUBJ_ID),
  Mean = mean(Age),
  Max = max(Age),
  Min = min(Age),
  Median = median(Age),
  Std = sd(Age)
  )
  summary_dados_all %>% kable() %>% kable_styling()

summary_dados_hemi_v1 <- filter(dados_hemi_v1, Visit == 1) %>%
  group_by(Gender, Diagnostic) %>%
  summarise(
  N = n_distinct(SUBJ),
  Mean = mean(Age),
  Max = max(Age),
  Min = min(Age),
  Median = median(Age),
  Std = sd(Age)
  )
  summary_dados_hemi_v1 %>% kable() %>% kable_styling()
  
summary_dados_hemi_v1_diag <- filter(dados_hemi_v1, Visit == 1) %>%
  group_by(Diagnostic) %>%
  summarise(
  N = n_distinct(SUBJ),
  Mean = mean(Age),
  Max = max(Age),
  Min = min(Age),
  Median = median(Age),
  Std = sd(Age)
  )
  summary_dados_hemi_v1_diag %>% kable() %>% kable_styling()
  
```

# Resultados
## Estudo transversal
### Aplicacao do modelo

```{r rotinas analises, include=FALSE}
#source("analises/analise_regressao.R")
source("analises/comp_samples/preparing-yujiang-datasets.R")
source("analises/comp_samples/preparing-Motahouzel-dataset.R")
source("analises/comp_samples/comp.R")

```

Todos os sujeitos (IDOR)
```{r modelo_todos, echo=FALSE}

fit_comp <-
  lm(1 / 2 * logAvgThickness + logTotalArea ~ logExposedArea, data = filter(dados_datasetscomp, Amostra == "IDOR" | Amostra == "Mota&Houzel2015"), na.action=na.omit)

ggplot(filter(dados_datasetscomp, Amostra == "IDOR" | Amostra == "Mota&Houzel2015"), aes(log(ExposedArea),
                               1/2*log(AvgThickness) +log(TotalArea))) +
  geom_point(aes(color = Amostra)) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(
    title = "Mota & Houzel, 2015 wth IDOR subjects",
    subtitle = paste(
      "Adj R2 = ",
      signif(summary(fit_comp)$adj.r.squared, 5),
      ", Intercept (log(k)) = ",
      signif(fit_comp$coef[[1]], 5),
      ",\nalpha = ",
      signif(fit_comp$coef[[2]], 5),
      ",  p = ",
      signif(summary(fit_comp)$coefficients[2,4], 3)
    ),
    x = "Log Exposed Area",
    y = "Log (T^(1/2)*At)",
    colour = "Amostra") +
  theme_pubclean()

summary(fit_comp)

dados_datasetscomp_IHM <- filter(dados_datasetscomp, Amostra == "IDOR" | Amostra == "Mota&Houzel2015")

```

#### Apenas humanos IDOR

```{r modelo_humanos, echo=FALSE, message=FALSE, warning=FALSE}
modelo_sujeitos_idor + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL"))

```

##### SLOPE diferente?
Comparando com outras bases de dados de humanos
```{r}
summary_dados_datasets <- filter(dados_datasetscomp, Amostra != "IDOR" | Amostra != "Mota&Houzel2015") %>%
  group_by(Amostra, Diagnostic) %>%
  summarise(
  N = n_distinct(SubjectID),
  Mean = mean(Age),
  Std = sd(Age)
  )
  summary_dados_datasets %>% kable() %>% kable_styling()

amostra_Coef %>% kable(digits = 4) %>% kable_styling()

ggplot(filter(dados_datasetscomp, Amostra != "Mota&Houzel2015"), aes(log(ExposedArea),
                               1 / 2 * log(AvgThickness) + log(TotalArea))) +
                               geom_point(aes(color = Amostra)) +
                               geom_smooth(method = "lm", se = FALSE) +
                               theme_pubclean() + facet_grid(Amostra ~ .) + stat_regline_equation()
```
Que sao compostas por sujietos de muitas idades diferentes.

# hipótese

<!-- ### Interferencia da maquina de aquisicao -->

```{r interferencia maquina, eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}

source("analises/influencia_maquina.R")

figure2_maquina
hist_logk_maquina

figure2bxplt_maquina
bxplt_logk_maquina

model_maquina

```

### Interferencia da lateralidade

```{r interferencia lateralidade, echo=FALSE, message=FALSE, warning=FALSE}

source("analises/influencia_hemi.R")

figure2_hemi
hist_logk_hemi

figure2bxplt_hemi
bxplt_logk_hemi

model_hemi

model_1 = lm(log(sqrt(AvgThickness) * TotalArea) ~ log(ExposedArea) + hemi + log(ExposedArea):hemi, data = dados_hemi_v1)

Anova(model_1, type = "II")

model_2 = lm(log(sqrt(AvgThickness) * TotalArea) ~ log(ExposedArea) + hemi , data = dados_hemi_v1)

Anova(model_2, type = "II")
summary(model_2)

```

### Interferencia do Genero

```{r interferencia_Genero, echo=FALSE, message=FALSE, warning=FALSE}

source("analises/influencia_Gender.R")

ggplot(data = dados_hemi_v1, aes(Gender, Age, color = Gender)) +
geom_boxplot() +
labs(title = "Age e grupos de Diagnostic",
x = "Gender",
y = "Age") +
theme_pubclean() + stat_compare_means(method = "t.test")

#+ stat_compare_means(, label = "p.signif")

aov_age_Gender_groups
summary(aov_age_Gender_groups)


figure2
hist_logk

figure2bxplt
bxplt_logk

model

model_3 = lm(log(sqrt(AvgThickness) * TotalArea) ~ log(ExposedArea) + Gender + log(ExposedArea):Gender, data = dados_hemi_v1)

Anova(model_3, type = "II")

model_4 = lm(log(sqrt(AvgThickness) * TotalArea) ~ log(ExposedArea) + Gender , data = dados_hemi_v1)

Anova(model_4, type = "II")
summary(model_4)

```


### Interferencia da Age 


```{r interferencia_idade, echo=FALSE, message=FALSE, warning=FALSE}
Idade = 25

my_comparisons <-
list(c("CONTROLE", "CCL"), c("CONTROLE", "ALZ"), c("CCL", "ALZ"))

source("analises/decaimento_idade/decaimento_grafico.R")
source("analises/influencia_idade.R")

dados_hemi_v1_Ctl <-
filter(dados, ROI == "hemisphere", Diagnostic == "CONTROLE")
dados_hemi_v1_CCL <-
filter(dados, ROI == "hemisphere", Diagnostic == "CCL")
dados_hemi_v1_Alz <-
filter(dados, ROI == "hemisphere", Diagnostic == "ALZ")


ggplot(data = dados_hemi_v1, aes(Diagnostic, Age, color = Diagnostic)) +
geom_boxplot() +
labs(title = "Age e grupos de Diagnostic",
x = "Diagnostic",
y = "Age") +
theme_pubclean() + stat_compare_means(method = "anova") +
stat_compare_means(comparisons = my_comparisons, label = "p.signif")

ggplot(dados_hemi_v1,
       aes(
         x = (log(ExposedArea)),
         y = (log(sqrt(AvgThickness) * TotalArea)),
         color = Age_interval10
       )) +
  geom_point() +
  geom_smooth(method = "lm",
              se = FALSE) +
  labs(
    title = "Girificacao por decadas",
    x = "Log Area exposta",
    y = "Log T^(1/2)*At",
    colour = "Idade em decadas"
  ) +
  theme_pubclean() + facet_grid(Diagnostic ~ .)


ggplot(data = dados_hemi_v1, aes(Age, TotalArea, color = Diagnostic)) +
geom_point() + geom_smooth(method = "lm") +
theme_pubclean() + xlim(40, 95) + stat_cor(aes(color = Diagnostic))

ggplot(data = dados_hemi_v1, aes(Age, ExposedArea,  color = Diagnostic)) +
geom_point() + geom_smooth(method = "lm") +
theme_pubclean() + xlim(40, 95) + stat_cor(aes(color = Diagnostic))

ggplot(data = dados_hemi_v1, aes(Age, AvgThickness,  color = Diagnostic)) +
geom_point() + geom_smooth(method = "lm") +
theme_pubclean() + xlim(40, 95) + stat_cor(aes(color = Diagnostic))

ggplot(data = dados_hemi_v1, aes(Age, logkteorico,  color = Diagnostic)) +
geom_point() + geom_smooth(method = "lm") +
theme_pubclean()  + xlim(40, 95) + stat_cor(aes(color = Diagnostic)) + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL")) + labs(y = "log(Offset k)")

lm_age_diag_groups
summary(lm_age_diag_groups)
summary(aov(lm_age_diag_groups))

model_age
figure4

```

### Interferencia da doenca

```{r echo=FALSE, message=FALSE, warning=FALSE}
source("analises/influencia_diag.R")

# diag_Coef %>% kable() %>% kable_styling()

modelo_diag

diag_boxplot

aov_diag
summary(aov_diag)

diag_Coef %>% kable(digits = 4) %>% kable_styling()

diag_R2 %>% kable(digits = 4) %>% kable_styling()


model_5 = lm(log(sqrt(AvgThickness) * TotalArea) ~ log(ExposedArea) + Diagnostic + log(ExposedArea):Diagnostic, data = dados_hemi_v1)

Anova(model_5, type = "II")

model_6 = lm(log(sqrt(AvgThickness) * TotalArea) ~ log(ExposedArea) + Diagnostic , data = dados_hemi_v1)

Anova(model_6, type = "II")
summary(model_6)

```

```{r echo=FALSE, message=FALSE, warning=FALSE}
source("analises/influencia_diag_age.R")
source("analises/influencia_diag.R")

dados_kteorico_diag <-
  filter(
    dados_hemi_v1,
    RM_Maquina == "Philips",
    Visit == 1,
    Diagnostic == "CONTROLE"|
      Diagnostic == "CCL"|
      Diagnostic == "ALZ"
  )   %>%
  group_by(Diagnostic) %>%
  dplyr::summarise(
    avg_log_kteorico = mean(logkteorico),
    uci_log_kteorico = CI(logkteorico)[1],
    lci_log_kteorico = CI(logkteorico)[3]
  )

ggplot(
  data = dados_hemi_v1,
  mapping = aes(color = Diagnostic)
) +
  geom_density(mapping = aes(x = logkteorico)) +
  labs(
    title = "Comparando o offset log(k) para os diagnosticos",
    x = "Offset log(k)",
    y = "Densidade",
    colour = "Diagnostic"
  ) +
  theme_pubclean() +
  geom_vline(data = dados_kteorico_diag,
             aes(
               xintercept = uci_log_kteorico,
               linetype = "dashed",
               color = Diagnostic
             )) +
  geom_vline(data = dados_kteorico_diag,
             aes(
               xintercept = lci_log_kteorico,
               linetype = "dashed",
               color = Diagnostic
             )) +
  geom_vline(data = dados_kteorico_diag,
             aes(
               xintercept = avg_log_kteorico,
               linetype = "solid",
               color = Diagnostic
             ))
lm_diag
summary(lm_diag)
anova(lm_diag) %>% kable %>% kable_styling()
```

```{r eval=FALSE, include=FALSE}
dados_kteorico_age_diag_age <-
  filter(
    dados_hemi_v1,
    RM_Maquina == "Philips",
    Visit == 1,
    Diagnostic == "CONTROLE"|
      Diagnostic == "CCL"|
      Diagnostic == "ALZ"
  )   %>%
  group_by(Gender, Diagnostic, Age_interval10) %>%
  dplyr::summarise(
    avg_log_kteorico = mean(logkteorico),
    uci_log_kteorico = CI(logkteorico)[1],
    lci_log_kteorico = CI(logkteorico)[3]
  )

ggplot(
  data = dados_hemi_v1,
  mapping = aes(color = Diagnostic)
) +
  geom_density(mapping = aes(x = logkteorico)) +
  labs(
    title = "Comparando o offset log(k) para os diagnosticos",
    subtitle = "Visita 1",
    x = "Offset log(k)",
    y = "Densidade",
    colour = "Diagnostic"
  ) +
  theme_pubclean() +
  geom_vline(data = dados_kteorico_age_diag_age,
             aes(
               xintercept = uci_log_kteorico,
               linetype = "dashed",
               color = Diagnostic
             )) +
  geom_vline(data = dados_kteorico_age_diag_age,
             aes(
               xintercept = lci_log_kteorico,
               linetype = "dashed",
               color = Diagnostic
             )) +
  geom_vline(data = dados_kteorico_age_diag_age,
             aes(
               xintercept = avg_log_kteorico,
               linetype = "solid",
               color = Diagnostic
             )) + facet_grid(Age_interval10 ~ Gender) + ylim(0,50)
```
### Doença e Gendero

```{r}
source("analises/influencia_Gender.R")
source("analises/influencia_Gender_diag.R")
model_facet
figure_Gender_diag
bxplt_logk_diagnostic_Gender

aov_gen_diag
summary(aov_gen_diag)
```


### Doença e Age
```{r echo=FALSE}
source("analises/influencia_diag.R")
source("analises/influencia_diag_age.R")

ggplot(
  data = filter(
    dados_hemi_v1,
    RM_Maquina == "Philips",
    Visit == 1),
  aes(Age, logkteorico, color = Diagnostic)
) + geom_point() +
  geom_smooth(method = "lm") +
  labs(
    title = "Comparando o offset log(k) pela Age",
    x = "Age",
    y = "log Offset (k)",
    colour = "Diagnostic"
  ) +
  theme_pubclean() +  ggsave("logk_age_decay.png", width = 7, height = 5)

summary(lm_age_diag)
anova(lm_age_diag)

```

#### Decaimento da girificacao com a Age

Fizemos uma correcao das medidas das Areas e Espessura para todos os sujeitos para um Age ficticia de 25 anos (sem influencia do fator Age na girificacao).

```{r decaimento_idade, echo=FALSE}
# corrigindo as medidas pela Age ----

Age = 25

source("analises/decaimento_idade/decaimento_grafico.R")

# diag_corr_Coef %>% kable %>% kable_styling()

model_age_corr_decay

# modelo corrigido pela idade ---

dados_lm_diag_corr <- dados_hemi_v1 %>%
  group_by(Diagnostic) %>%
  do(fit_diag_corr = lm(log_TotalArea_corr_decay + log_AvgThickness_corr_decay/ 2 ~ (log_SmoothArea_corr_decay), data = .))

diag_corr_Coef = tidy(dados_lm_diag_corr,
                 fit_diag_corr,
                 conf.int = TRUE,
                 conf.level = 0.95)

diag_corr_Coef %>% kable() %>% kable_styling()

dados_lm_diag_age_corr <- dados_hemi_v1 %>%
  group_by(Diagnostic) %>%
  do(fit_diag_age_corr = lm(logkteorico_corr_decay ~ Age, data = .))

diag_corr_age_Coef = tidy(dados_lm_diag_age_corr,
                 fit_diag_age_corr,
                 conf.int = TRUE,
                 conf.level = 0.95)

diag_corr_age_Coef %>% kable() %>% kable_styling()

summary(aov(logkteorico_corr_decay ~Age*Diagnostic, data = dados_hemi_v1))

summary(aov(logkteorico_corr_decay ~Age+Diagnostic, data = dados_hemi_v1))

summary(lm(logkteorico_corr_decay ~Age+Diagnostic, data = dados_hemi_v1))

ggplot(
  data = filter(
    dados_hemi_v1,
    RM_Maquina == "Philips",
    Visit == 1),
  aes(Age, logkteorico_corr_decay, color = Diagnostic)
) + geom_point() +
  geom_smooth(method = "lm") +
  labs(
    title = "Comparando o offset log(k) (corrigido para 25 anos) pela Age",
    x = "Age",
    y = "log Offset (k)",
    colour = "Diagnostic"
  ) +
  theme_pubclean() + ggsave("age_decay.png", width = 7.5, height = 5)

# lm_logk_decay
# summary(lm_logk_decay)
# anova(lm_logk_decay)



```

#### Medidas corrigidas para Age

```{r decaimento_idade_outrasmedidas, echo=FALSE}
# corrigindo as medidas pela Age ----

Age = 25

my_comparisons <-
  list(c("CONTROLE", "CCL"), c("CONTROLE", "ALZ"), c("CCL", "ALZ"))

source("analises/decaimento_idade/decaimento_grafico.R")

bxplt_AreaT_diagnostic_Gender_agecorrected <-
  ggplot(data = dados_hemi_v1,
         aes(Diagnostic, log_TotalArea_corr_decay, color = Diagnostic)) +
  geom_boxplot() +
  labs(title = "log Total grey matter surface area",
       x = "Diagnostic",
       y = "log Total Area (mm^2) (corrected to age)") +
  theme_pubclean() + stat_compare_means(method = "anova") +
  stat_compare_means(comparisons = my_comparisons)

bxplt_AreaE_diagnostic_Gender_agecorrected <-
  ggplot(data = dados_hemi_v1,
         aes(Diagnostic, log_SmoothArea_corr_decay, color = Diagnostic)) +
  geom_boxplot() +
  labs(title = "log Exposed grey matter surface area",
       x = "Diagnostic",
       y = "log Smooth Area (mm^2) (corrected to age)") +
  theme_pubclean() + stat_compare_means(method = "anova") +
  stat_compare_means(comparisons = my_comparisons)

bxplt_AvgThick_diagnostic_Gender_agecorrected <-
  ggplot(data = dados_hemi_v1,
         aes(Diagnostic, log_AvgThickness_corr_decay, color = Diagnostic)) +
  geom_boxplot() +
  labs(title = "log Average Cortical Thickness",
       x = "Diagnostic",
       y = "log Average Thickness (mm) (corrected to age)") +
  theme_pubclean() + stat_compare_means(method = "anova") +
  stat_compare_means(comparisons = my_comparisons)

bxplt_lGI_diagnostic_Gender_agecorrected <-
  ggplot(data = dados_hemi_v1, aes(Diagnostic, localGI_corr_decay, color = Diagnostic)) +
  geom_boxplot() +
  labs(title = "Local Gyrification Index",
       x = "Diagnostic",
       y = "local Gyrification Index (corrected to age)") +
  theme_pubclean() + stat_compare_means(method = "anova") +
  stat_compare_means(comparisons = my_comparisons)

bxplt_logk_diagnostic_Gender_agecorrected <-
  ggplot(data = dados_hemi_v1, aes(Diagnostic, logkteorico_corr_decay, color = Diagnostic)) +
  geom_boxplot() +
  labs(title = "log Offset k",
       x = "Diagnostic",
       y = "log Offset k") +
  theme_pubclean() + stat_compare_means(method = "anova") +
  stat_compare_means(comparisons = my_comparisons)

bxplt_AreaT_diagnostic_Gender_agecorrected
bxplt_AreaE_diagnostic_Gender_agecorrected
bxplt_AvgThick_diagnostic_Gender_agecorrected
bxplt_lGI_diagnostic_Gender_agecorrected
bxplt_logk_diagnostic_Gender_agecorrected

```



## Analise da divisao por lobos

```{r lobos, echo=FALSE, message=FALSE, warning=FALSE}

source("analises/lobos/analise_lobos.R")
source("analises/lobos/analise_lobos_diag.R")

lobos1

lobos1_corrected


lobos4

lobos4_age_corr

aov_diag_ROI
summary(aov_diag_ROI)

lobos4_thick
aov_diag_ROI_thick
summary(aov_diag_ROI_thick)

lobos4_areat
aov_diag_ROI_areat
summary(aov_diag_ROI_areat)

lobos4_areae
aov_diag_ROI_areae
summary(aov_diag_ROI_areae)

lobos4_lGI
aov_diag_ROI_lGI
summary(aov_diag_ROI_lGI)


ggplot(
  data = dados_lobos_v1,
  aes(Age, logkteorico_corr_decay, color = Diagnostic)
) + geom_point() +
  geom_smooth(method = "lm") +
  labs(
    title = "Comparando o offset log(k) (corrigido para 25 anos) pela Age",
    x = "Age",
    y = "log Offset (k)",
    colour = "Diagnostic"
  ) +
  theme_pubclean() + facet_grid( ~ ROI)

dados_lm_ROI <- dados_lobos_v1  %>%
  group_by(ROI) %>%
  do(fit_ROI = lm(log(sqrt(AvgThickness) * TotalArea_corrected) ~ log(SmoothArea_corrected), data = .))

ROI_Coef = tidy(dados_lm_ROI,
                 fit_ROI,
                 conf.int = TRUE,
                 conf.level = 0.95)
ROI_Coef %>% kable(digits = 4) %>% kable_styling()

ROI_R2 = glance(dados_lm_ROI, fit_ROI)
ROI_R2 %>% kable(digits = 4) %>% kable_styling()

dados_lm_diag_ROI <- dados_lobos_v1  %>%
  group_by(Diagnostic, ROI) %>%
  do(fit_diag_ROI = lm(log(sqrt(AvgThickness) * TotalArea_corrected) ~ log(SmoothArea_corrected), data = .))

diag_ROI_Coef = tidy(dados_lm_diag_ROI,
                 fit_diag_ROI,
                 conf.int = TRUE,
                 conf.level = 0.95)
diag_ROI_Coef %>% kable(digits = 4) %>% kable_styling()

diag_ROI_R2 = glance(dados_lm_diag_ROI, fit_diag_ROI)
diag_ROI_R2 %>% kable(digits = 4) %>% kable_styling()


```


```{r statistics, eval=FALSE, include=FALSE}
## ANOVAS, TUKEYS 

dados_hemi_v1$Diagnostic <- as.factor(dados_hemi_v1$Diagnostic)
dados_hemi_v1$Age <- as.factor(dados_hemi_v1$Age)
dados_hemi_v1$Gender <- as.factor(dados_hemi_v1$Gender)
dados_hemi_v1$Age_interval10 <- as.factor(dados_hemi_v1$Age_interval10)


aov_all <-
  aov(logkteorico ~ Gender + Age + Diagnostic,
  data = dados_hemi_v1
  )

summary(aov_all)

tuk <- TukeyHSD(aov_all)
tuk
plot(tuk)

levene <- leveneTest(logkteorico ~ Gender * Age * Diagnostic,
  data = dados_hemi_v1)
levene

aov_all_interval <-
  aov(logkteorico ~ Gender * Age_interval10 * Diagnostic,
  data = dados_hemi_v1
  )

summary(aov_all_interval)

tuk2 <- TukeyHSD(aov_all_interval)
tuk2
plot(tuk2)


levene2 <- leveneTest(logkteorico ~ Gender * Age * Diagnostic,
  data = dados_hemi_v1)
levene2

aov_all_corr <-
  aov(logkteorico_corr_decay ~ Gender * Diagnostic,
  data = dados_hemi_v1
  )

summary(aov_all_corr)

tuk3 <- TukeyHSD(aov_all_corr)
tuk3
plot(tuk3)


levene3 <- leveneTest(logkteorico_corr_decay ~ Gender * Diagnostic,
  data = dados_hemi_v1)
levene3

dados_hemi_v1$Diagnostic[dados_hemi_v1$Diagnostic == "CONTROLE"] <- 1
dados_hemi_v1$Diagnostic[dados_hemi_v1$Diagnostic == "CCL"] <- 2 
dados_hemi_v1$Diagnostic[dados_hemi_v1$Diagnostic == "ALZ"] <- 3


cor(dados_hemi_v1[, c(8,17,19,21,22,23)])

```

## COMPARING Z-SCORES
```{r analise variancia, echo=FALSE}

source("analises/variancia_test.R")

dados_hemi_v1 <- filter(dados, ROI == "hemisphere", Visit == 1)

dados_lobos_v1 <- filter(dados, ROI == "F"| ROI == "T"| ROI == "O"| ROI == "P", Visit == 1)

# ggplot(dados_hemi_v1,
#        aes(x = z_logkteorico_corr_decay, fill = Diagnostic)) +
#        geom_histogram(aes(y = ..density..),
#        colour = "black") +
#        stat_function(fun = dnorm, args = list(
#        mean = mean(dados$logkteorico_corr_decay[dados$Diagnostic == "CONTROLE"&
#        dados$ROI == "hemisphere"]),
#        sd = sd(dados$logkteorico_corr_decay[dados$Diagnostic == "CONTROLE"&
#        dados$ROI == "hemisphere"])
#        ))

ggplot(dados_hemi_v1,
       aes(x = Diagnostic, y = z_log_AvgThickness_corr_decay, color = Diagnostic)) +
       geom_boxplot() + stat_compare_means(method = "anova") +
       theme_pubclean() + facet_grid( ~ ROI) +
  stat_compare_means(comparisons = my_comparisons, label = "p.signif")


ggplot(dados_hemi_v1,
       aes(x = Diagnostic, y = z_log_AvgThickness_corr_decay, color = Diagnostic)) +
       geom_boxplot() + stat_compare_means(method = "anova") +
       theme_pubclean() +
  stat_compare_means(comparisons = my_comparisons, label = "p.signif")

ggplot(dados_hemi_v1,
       aes(x = Diagnostic, y = z_log_TotalArea_corr_decay, color = Diagnostic)) +
       geom_boxplot() + stat_compare_means(method = "anova") +
       theme_pubclean() +
  stat_compare_means(comparisons = my_comparisons, label = "p.signif")

ggplot(dados_hemi_v1,
       aes(x = Diagnostic, y = z_log_SmoothArea_corr_decay, color = Diagnostic)) +
       geom_boxplot() + stat_compare_means(method = "anova") +
       theme_pubclean() +
  stat_compare_means(comparisons = my_comparisons, label = "p.signif")

ggplot(dados_hemi_v1,
       aes(x = Diagnostic, y = z_logkteorico_corr_decay, color = Diagnostic)) +
       geom_boxplot() + stat_compare_means(method = "anova") +
       theme_pubclean() +
  stat_compare_means(comparisons = my_comparisons, label = "p.signif")

```

## Dados clínicos

```{r}
source("analises/clinic_data.R")
dados_CC <- filter(dados, ROI == "CC")

dados <- filter(dados, ROI == "F"| ROI == "T"| ROI == "O"| ROI == "P"| ROI == "hemisphere", Visit == 1)
dados_hemi_v1 <- filter(dados, ROI == "hemisphere", Visit == 1)
dados_lobos_v1 <- filter(dados, ROI == "F"| ROI == "T"| ROI == "O"| ROI == "P"| ROI == "CC", Visit == 1)

  
ggplot(dados_hemi_v1, aes(y = logkteorico_corr_decay, x = `TMT B-A`, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + stat_cor(aes(color = Diagnostic))

ggplot(dados_lobos_v1, aes(y = logkteorico_corr_decay, x = `TMT B-A`, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + facet_wrap(ROI ~ .) + stat_cor(aes(color = Diagnostic))

ggplot(dados_hemi_v1, aes(y = logkteorico_corr_decay, x = MMSE, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + stat_cor(aes(color = Diagnostic))

ggplot(dados_lobos_v1, aes(y = logkteorico_corr_decay, x = MMSE, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + facet_wrap(ROI ~ .) + stat_cor(aes(color = Diagnostic))

ggplot(dados_hemi_v1, aes(y = logkteorico_corr_decay, x = `A7/A5`, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + stat_cor(aes(color = Diagnostic))

ggplot(dados_lobos_v1, aes(y = logkteorico_corr_decay, x = `A7/A5`, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + facet_wrap(ROI ~ .) + stat_cor(aes(color = Diagnostic))

ggplot(dados_hemi_v1, aes(y = logkteorico_corr_decay, x = relogio, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + stat_cor(aes(color = Diagnostic))

ggplot(dados_lobos_v1, aes(y = logkteorico_corr_decay, x = relogio, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + facet_wrap(ROI ~ .) + stat_cor(aes(color = Diagnostic))

ggplot(dados_hemi_v1, aes(y = logkteorico_corr_decay, x = `DIGIT SPAN BACK`, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + stat_cor(aes(color = Diagnostic))

ggplot(dados_lobos_v1, aes(y = logkteorico_corr_decay, x = `DIGIT SPAN BACK`, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + facet_wrap(ROI ~ .) + stat_cor(aes(color = Diagnostic))

```

### Z-scores
```{r}
source("analises/clinic_data.R")
source("analises/variancia_test.R")
dados_CC <- filter(dados, ROI == "CC")
dados <- filter(dados, ROI == "F"| ROI == "T"| ROI == "O"| ROI == "P"| ROI == "hemisphere", Visit == 1)
dados_hemi_v1 <- filter(dados, ROI == "hemisphere", Visit == 1)
dados_lobos_v1 <- filter(dados, ROI == "F"| ROI == "T"| ROI == "O"| ROI == "P", Visit == 1)

ggplot(dados_hemi_v1, aes(y = z_logkteorico_corr_decay, x = z_TMT_B_A, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + stat_cor(aes(color = Diagnostic))

ggplot(dados_lobos_v1, aes(y = z_logkteorico_corr_decay, x = z_TMT_B_A, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + facet_wrap(ROI ~ .) + stat_cor(aes(color = Diagnostic))

ggplot(dados_hemi_v1, aes(y = z_logkteorico_corr_decay, x = z_MMSE, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + stat_cor(aes(color = Diagnostic))

ggplot(dados_lobos_v1, aes(y = z_logkteorico_corr_decay, x = z_MMSE, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + facet_wrap(ROI ~ .) + stat_cor(aes(color = Diagnostic))

ggplot(dados_hemi_v1, aes(y = z_logkteorico_corr_decay, x = z_A7_A5, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + stat_cor(aes(color = Diagnostic))

ggplot(dados_lobos_v1, aes(y = z_logkteorico_corr_decay, x = z_A7_A5, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + facet_wrap(ROI ~ .) + stat_cor(aes(color = Diagnostic))

ggplot(dados_hemi_v1, aes(y = z_logkteorico_corr_decay, x = z_relogio, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + stat_cor(aes(color = Diagnostic))

ggplot(dados_lobos_v1, aes(y = z_logkteorico_corr_decay, x = z_relogio, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + facet_wrap(ROI ~ .) + stat_cor(aes(color = Diagnostic))

ggplot(dados_hemi_v1, aes(y = z_logkteorico_corr_decay, x = z_DIGIT_SPAN_BACK, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + stat_cor(aes(color = Diagnostic))

ggplot(dados_lobos_v1, aes(y = z_logkteorico_corr_decay, x = z_DIGIT_SPAN_BACK, color = Diagnostic )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + facet_wrap(ROI ~ .) + stat_cor(aes(color = Diagnostic))

```

```{r correlacao, eval=FALSE, include=FALSE}

dados_num <-
  dplyr::select(
  dados,
  z_MMSE,
  z_A7_A5 ,
  z_TMT_B_A ,
  z_relogio,
  z_DIGIT_SPAN_BACK,
  z_log_AvgThickness_corr_decay ,
  z_log_TotalArea_corr_decay,
  z_log_SmoothArea_corr_decay ,
  z_localGI_corr_decay,
  z_logkteorico_corr_decay
  )

rcorr(as.matrix(dados_num))

cor(dados_num, use = "complete.obs", method = "kendall") 
cov(dados_num, use = "complete.obs")
```

# CORPO CALOSO
```{r corpo caloso, echo=FALSE}

source("corpo_caloso.R")

ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(y = logkteorico, x = log(TotalArea_corrected_CC))
  ) + geom_point() + geom_smooth(method = "lm") + stat_cor() + theme_pubclean() + labs(x = "log(CC Total Area)", y = "log(Offset k)")
  
ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(y = logkteorico, x = log(SmoothArea_corrected_CC))
  ) + geom_point() + geom_smooth(method = "lm") + stat_cor() + theme_pubclean() + labs(x = "log(CC Smooth Area)", y = "log(Offset k)")

ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(y = logkteorico_corr_decay, x = log_TotalArea_corr_decay_CC)
  ) + geom_point() + geom_smooth(method = "lm") + stat_cor() + theme_pubclean() + labs(x = "log(CC Total Area) - deaged", y = "log(Offset k) - deaged")
  
ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(y = logkteorico_corr_decay, x = log_SmoothArea_corr_decay_CC)
  ) + geom_point() + geom_smooth(method = "lm") + stat_cor() + theme_pubclean() + labs(x = "log(CC Smooth Area) - deaged", y = "log(Offset k) - deaged")
  
ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(y = logkteorico, x = log(WM_volume_CC))
  ) + geom_point() + geom_smooth(method = "lm") + stat_cor() + theme_pubclean() + labs(x = "log(CC White Matter Volume)", y = "log(Offset k)")

ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(y = logkteorico, x = log(TotalArea_corrected_CC), color = Diagnostic)
  ) + geom_point() + geom_smooth(method = "lm") + stat_cor(aes(color = Diagnostic)) + theme_pubclean() + labs(x = "log(CC Total Area)", y = "log(Offset k)") + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL"))
  
ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(y = logkteorico, x = log(SmoothArea_corrected_CC), color = Diagnostic)
  ) + geom_point() + geom_smooth(method = "lm") + stat_cor(aes(color = Diagnostic)) + theme_pubclean() + labs(x = "log(CC Smooth Area)", y = "log(Offset k)") + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL"))

ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(y = logkteorico_corr_decay, x = log_TotalArea_corr_decay_CC, color = Diagnostic)
  ) + geom_point() + geom_smooth(method = "lm") + stat_cor(aes(color = Diagnostic)) + theme_pubclean() + labs(x = "log(CC Total Area) - deaged", y = "log(Offset k) - deaged") + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL"))
  
ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(y = logkteorico_corr_decay, x = log_SmoothArea_corr_decay_CC, color = Diagnostic)
  ) + geom_point() + geom_smooth(method = "lm") + stat_cor(aes(color = Diagnostic)) + theme_pubclean() + labs(x = "log(CC Smooth Area) - deaged", y = "log(Offset k) - deaged") + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL"))
  
ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(y = logkteorico, x = log(WM_volume_CC), color = Diagnostic)
  ) + geom_point() + geom_smooth(method = "lm") + stat_cor(aes(color = Diagnostic)) + theme_pubclean() + labs(x = "log(CC White Matter Volume)", y = "log(Offset k)") + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL"))
```

```{r corpo caloso correlacoes, echo=FALSE}

source("corpo_caloso.R")
 
correl_k_areat_cc = rcorr(
  filter(dados, ROI == "hemisphere")$logkteorico,
  log(filter(dados, ROI == "hemisphere")$TotalArea_corrected_CC)
  )
correl_k_areat_cc

correl_k_areas_cc = rcorr(
  filter(dados, ROI == "hemisphere")$logkteorico,
  log(filter(dados, ROI == "hemisphere")$SmoothArea_corrected_CC
  ))
correl_k_areas_cc

correl_k_areat_decay_cc = rcorr(
  filter(dados, ROI == "hemisphere")$logkteorico_corr_decay,
  filter(dados, ROI == "hemisphere")$log_TotalArea_corr_decay_CC
  )
correl_k_areat_decay_cc  

correl_k_areas_decay_cc = rcorr(
  filter(dados, ROI == "hemisphere")$logkteorico_corr_decay,
  filter(dados, ROI == "hemisphere")$log_SmoothArea_corr_decay_CC
  )
correl_k_areas_decay_cc
  
correl_k_vol_cc = rcorr(
  filter(dados, ROI == "hemisphere")$logkteorico,
  log(filter(dados, ROI == "hemisphere")$WM_volume_CC)
  )
correl_k_vol_cc
```

## COMPARAR HEMIFERIOS - desvio interhemisferico
```{r corpo caloso 2, echo=FALSE}

source("corpo_caloso.R")

ggplot(data = dados_hemi_v1_comp,
       aes(
       y = logkteorico.L,
       x = logkteorico.R,
       color = Diagnostic,
       fill = Diagnostic
       )) + geom_point() + geom_smooth(method = "lm") + stat_cor(aes(color = Diagnostic)) + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL")) + labs(x = "log(Offset k) Right hemi", y = "log(Offset k) Left hemi")

ggplot(
  data = dados_hemi_v1_comp,
  aes(left_minus_right, color = Diagnostic)
  ) + geom_density() + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL"))

ggplot(data = dados_hemi_v1_comp,
       aes(
       y = abs((logkteorico.L - logkteorico.R) / (
       var(logkteorico.L, na.rm = TRUE) + var(logkteorico.R, na.rm = TRUE) - 2 *
       cov(logkteorico.L, logkteorico.R, use = "complete")
       ) ^ (1 / 4)),
       x = log(TotalArea_corrected_CC),
       color = Diagnostic,
       fill = Diagnostic
       )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL")) + labs(x = "log(TotalArea_CC)", y = "\varepsilon") + stat_cor() 

ggplot(data = dados_hemi_v1_comp,
       aes(
       y = abs((logkteorico.L - logkteorico.R) / (
       var(logkteorico.L, na.rm = TRUE) + var(logkteorico.R, na.rm = TRUE) - 2 *
       cov(logkteorico.L, logkteorico.R, use = "complete")
       ) ^ (1 / 4)),
       x = log(TotalArea_corrected_CC),
       color = Diagnostic,
       fill = Diagnostic
       )) + geom_point() + geom_smooth(method = "lm", fullrange = TRUE) + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL")) + labs(x = "log(TotalArea_CC)", y = "\varepsilon") + xlim(0, 15) + stat_cor() 

ggplot(data = dados_hemi_v1_comp,
       aes(
       y = abs((logkteorico.L - logkteorico.R) / (
       var(logkteorico.L, logkteorico.R, na.rm = TRUE)
       ) ^ (1 / 4)),
       x = TotalArea_corrected_CC,
       color = Diagnostic
       )) + geom_col() + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL"))

ggplot(data = dados_hemi_v1_comp,
       aes(
       y = abs((logkteorico.L - logkteorico.R) / (
       var(logkteorico.L, na.rm = TRUE) + var(logkteorico.R, na.rm = TRUE) - 2 *
       cov(logkteorico.L, logkteorico.R, use = "complete")
       ) ^ (1 / 4)),
       x = log(WM_volume_CC),
       color = Diagnostic,
       fill = Diagnostic
       )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL")) + labs(x = "log(WM_Volume_CC)", y = "\varepsilon") + stat_cor() 

ggplot(data = dados_hemi_v1_comp,
       aes(
       y = abs((logkteorico.L - logkteorico.R) / (
       var(logkteorico.L, na.rm = TRUE) + var(logkteorico.R, na.rm = TRUE) - 2 *
       cov(logkteorico.L, logkteorico.R, use = "complete")
       ) ^ (1 / 4)),
       x = log(WM_volume_CC),
       color = Diagnostic,
       fill = Diagnostic
       )) + geom_point() + geom_smooth(method = "lm", fullrange = TRUE) + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL")) + labs(x = "log(WM_Volume_CC)", y = "\varepsilon") + xlim(0, 10) + stat_cor() 

ggplot(data = dados_hemi_v1_comp,
       aes(
       y = abs((logkteorico.L - logkteorico.R) / (
       var(logkteorico.L, logkteorico.R, na.rm = TRUE)
       ) ^ (1 / 4)),
       x = log(WM_volume_CC),
       color = Diagnostic
       )) + geom_col() + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL"))

#### --sem o log na medida do eixo x -- ####

ggplot(data = dados_hemi_v1_comp,
       aes(
       y = abs((logkteorico.L - logkteorico.R) / (
       var(logkteorico.L, na.rm = TRUE) + var(logkteorico.R, na.rm = TRUE) - 2 *
       cov(logkteorico.L, logkteorico.R, use = "complete")
       ) ^ (1 / 4)),
       x = TotalArea_corrected_CC,
       color = Diagnostic,
       fill = Diagnostic
       )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL")) + labs(x = "TotalArea_CC", y = "\varepsilon") + stat_cor() 

ggplot(data = dados_hemi_v1_comp,
       aes(
       y = abs((logkteorico.L - logkteorico.R) / (
       var(logkteorico.L, na.rm = TRUE) + var(logkteorico.R, na.rm = TRUE) - 2 *
       cov(logkteorico.L, logkteorico.R, use = "complete")
       ) ^ (1 / 4)),
       x = TotalArea_corrected_CC,
       color = Diagnostic,
       fill = Diagnostic
       )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL")) + labs(x = "TotalArea_CC", y = "\varepsilon") + xlim(0, 4e+05) + stat_cor() 

ggplot(data = dados_hemi_v1_comp,
       aes(
       y = abs((logkteorico.L - logkteorico.R) / (
       var(logkteorico.L, logkteorico.R, na.rm = TRUE)
       ) ^ (1 / 4)),
       x = TotalArea_corrected_CC,
       color = Diagnostic
       )) + geom_col() + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL"))

ggplot(data = dados_hemi_v1_comp,
       aes(
       y = abs((logkteorico.L - logkteorico.R) / (
       var(logkteorico.L, na.rm = TRUE) + var(logkteorico.R, na.rm = TRUE) - 2 *
       cov(logkteorico.L, logkteorico.R, use = "complete")
       ) ^ (1 / 4)),
       x = WM_volume_CC,
       color = Diagnostic,
       fill = Diagnostic
       )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL")) + labs(x = "WM_Volume_CC", y = "\varepsilon") + stat_cor() 

ggplot(data = dados_hemi_v1_comp,
       aes(
       y = abs((logkteorico.L - logkteorico.R) / (
       var(logkteorico.L, na.rm = TRUE) + var(logkteorico.R, na.rm = TRUE) - 2 *
       cov(logkteorico.L, logkteorico.R, use = "complete")
       ) ^ (1 / 4)),
       x = WM_volume_CC,
       color = Diagnostic,
       fill = Diagnostic
       )) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL")) + labs(x = "WM_Volume_CC", y = "\varepsilon") + xlim(0, 4500) + stat_cor() 

ggplot(data = dados_hemi_v1_comp,
       aes(
       y = abs((logkteorico.L - logkteorico.R) / (
       var(logkteorico.L, logkteorico.R, na.rm = TRUE)
       ) ^ (1 / 4)),
       x = WM_volume_CC,
       color = Diagnostic
       )) + geom_col() + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL"))

```

## AREA E VOLUME DO CORPO CALOSO  - comprimento axonal medio ponderado
```{r corpo caloso 3, echo=FALSE, cache=FALSE}

source("corpo_caloso.R")

ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(y = logkteorico,x = log(WhiteSurfArea_corrected), color = Diagnostic)
  ) + geom_point() + geom_smooth(method = "lm") + stat_cor() + theme_pubclean()

ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(x = WM_volume_CC, y = TotalArea_corrected_CC, color = Diagnostic, fill = Diagnostic)
  ) + geom_point() + geom_smooth(method = "lm") + stat_cor() + theme_pubclean()


ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(y = logkteorico,x = log(TotalArea_corrected_CC), color = Diagnostic)
  ) + geom_point() + geom_smooth(method = "lm") + stat_cor() + theme_pubclean()

ggplot(
  data = filter(dados, ROI == "hemisphere")) + geom_density(aes(l, color = Diagnostic, alpha = 0.2, fill = Diagnostic)) + theme_pubclean()

my_comparisons <- list( c("CONTROLE", "CCL"), c("CONTROLE", "ALZ"), c("CCL", "ALZ") )


ggplot(
  data = filter(dados, ROI == "hemisphere"), aes(y = l, x = Diagnostic)) + geom_boxplot(aes(color = Diagnostic, alpha = 0.2, fill = Diagnostic)) + theme_pubclean() + stat_compare_means(method = "anova", label.y = 0.053) + stat_compare_means(label = "p.format", method = "t.test", comparisons = my_comparisons, hide.ns = TRUE)   

ggplot(
  data = filter(dados, ROI == "hemisphere"), aes(y = l, x = Diagnostic)) + geom_boxplot(aes(color = Diagnostic, alpha = 0.2, fill = Diagnostic)) + theme_pubclean() + stat_compare_means(method = "anova", label.y = 0.053) + stat_compare_means(label = "p.signif", method = "t.test", hide.ns = TRUE)   


ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(l, alpha = 0.2, fill = Diagnostic)
  ) + geom_histogram() + theme_pubclean()

ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(
  x = l,
  y = logkteorico,
  color = Diagnostic,
  fill = Diagnostic
  )
  ) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL")) + stat_cor() 

ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(
  x = l,
  y = logkteorico_corr_decay,
  color = Diagnostic,
  fill = Diagnostic
  )
  ) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL")) + stat_cor() 

```
## FRACAO CALOSA
```{r corpo caloso 4, echo=FALSE, cache=FALSE}

source("corpo_caloso.R")


ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(y = TotalArea_corrected_CC, x = WhiteSurfArea_corrected, color = Diagnostic, fill = Diagnostic)
  ) + geom_point() + geom_smooth(method = "lm") + stat_cor() + theme_pubclean()

ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(
  x = WhiteSurfArea,
  y = logkteorico,
  color = Diagnostic,
  fill = Diagnostic
  )
  ) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL")) + stat_cor() 

ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(
  x = fC,
  y = logkteorico,
  color = Diagnostic,
  fill = Diagnostic
  )
  ) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL")) + stat_cor() 

ggplot(
  data = filter(dados, ROI == "hemisphere"),
  aes(
  x = fC,
  y = logkteorico_corr_decay,
  color = Diagnostic,
  fill = Diagnostic
  )
  ) + geom_point() + geom_smooth(method = "lm") + theme_pubclean() + scale_color_discrete(name = "Diagnostic", labels = c("ALZ", "MCI", "CONTROL")) + stat_cor() 

```