---
title: "Relatorio PRJ Girificacao"
author: "Fernanda Hansen Pacheco de Moraes"
date: "11 de dezembro de 2018"
output:
  html_document: 
    df_print: kable
    fig_caption: yes
    fig_width: 8
    number_sections: yes
    theme: paper
    toc: yes
  pdf_document:
    toc: yes
    toc_depth: '5'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	warning = FALSE,
	messAge = FALSE
)
```

```{r preparo, warning=FALSE, include=FALSE, messAge=FALSE}
# PREPARO

# define a area de trabalho
# setwd("Z:/PRJ1513_GIRIFICACAO_CONTROLES/03_PROCS/STATISTICS/V6/")# se no idor
# setwd("E:/idor/Gyrification/") # se no pendrive
# setwd("C:/Users/fernanda.hansen/Desktop/aging/V6/") # se no pendrive
 setwd("C:/Users/ferna/Documents/idor/Gyrification/RRRRRR/aging/V6/") # se no computador

# carrega os pacotes utilizados
source("01-call_packages.R")

source("02-funcoes.R")
# onde estao os arquivos de resultados:
#path_yujiangscript <- str_c("C:/Users/ferna/Documents/idor/Gyrification/data/resultados")

alpha_beta <- str_c("C:/Users/ferna/Documents/idor/Gyrification/data/resultados/")
  
# path_lobes <- str_c("Z:/PRJ1513_GIRIFICACAO_CONTROLES/03_PROCS/PROC_DATA/STATS/LobesScaling/")
path_lobes <- str_c("C:/Users/ferna/Documents/idor/Gyrification/STATS/")
 
# path_sessions <- str_c("Z:/PRJ1513_GIRIFICACAO_CONTROLES/03_PROCS/RAW_DATA/BIDS/")
 path_sessions <- str_c("C:/Users/ferna/Documents/idor/Gyrification/Processamento_longitudinal/V6/data/")

# importa os resultados
source("import.R") # arquivos dos sujeitos

# organiza os arquivos ----
# source("04-organiza.R")
# source("rotina_arquivos_neuroquant_comparisson.R")

dados_raw <- dados

verificar_lGI_zero <- filter(dados, localGI == 0 | is.na(localGI))
write.csv(verificar_lGI_zero, "verificar_lGI_zero.csv")

# retira os outros diagnosticos e deixa so quem tem machine definido
dados_all <- dados %>% filter(
    Diagnostic == "CONTROLE" |
      Diagnostic == "CCL" |
      Diagnostic == "ALZ", localGI != 0 | !is.na(localGI), !is.infinite(logExposedArea)) %>% 
  droplevels()

dados_excluidos <- anti_join(dados_raw, dados_all)
write.csv(dados_excluidos, "dados_excluidos.csv")

dados <- dados_all

Idade <- 25

# Prepara os dados para analise
source("05-analises_prep.R")

dados$Diagnostic[dados$Diagnostic == "CONTROLE"] <- "Control"
dados$Diagnostic[dados$Diagnostic == "ALZ"] <- "AD"
dados$Diagnostic[dados$Diagnostic == "CCL"] <- "MCI                "

dados$Diagnostic <- factor(dados$Diagnostic, levels = c("ALZ", "CCL","CONTROLE"))

dados <- filter(dados, machine == "Philips-Achieva")

# separa em arquivo de hemisferios e de lobos

dados_lobos_v1 <- unique(filter(dados, ROI == "F" | ROI == "T" | ROI == "O" | ROI == "P", Session == 1, !is.na(K_age_decay), SUBJ != "SUBJ211", SUBJ != "SUBJ223")) %>% droplevels()

dados_v1 <- filter(dados, ROI == "F" | ROI == "T" | ROI == "O" | ROI == "P" | ROI == "hemisphere", Session == 1) %>% droplevels()

dados_hemi_v1 <- unique(filter(dados, ROI == "hemisphere", Session == 1, !is.na(K_age_decay)))

# write.csv(dados_v1,"dados_v1.csv")
```

# Metodo

```{r}

paste("N subjects LGI = 0 = ", n_distinct(filter(verificar_lGI_zero, machine == "Philips-Achieva", !is.na(Age), Diagnostic =="CCL" | Diagnostic == "ALZ" | Diagnostic == "CONTROLE", Session == "1")$SUBJ))

unique(filter(verificar_lGI_zero, machine == "Philips-Achieva", !is.na(Age), Diagnostic =="CCL" | Diagnostic == "ALZ" | Diagnostic == "CONTROLE", Session == "1")$SUBJ)
filter(verificar_lGI_zero, machine == "Philips-Achieva", !is.na(Age), Diagnostic =="CCL" | Diagnostic == "ALZ" | Diagnostic == "CONTROLE", Session == "1") %>% kable() %>% kable_styling()
```

# Distribuição da Sample

## Escolaridade mínima 8 anos

```{r}

ggplot(data = dados_hemi_v1, aes(x = Diagnostic, y = ESC, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + 
  geom_boxplot() + theme_pubr() +
  stat_compare_means(method = "anova")

paste("Escolaridade minima = ", min(dados_hemi_v1$ESC), "N de sujeitos com escolaridade = 4 anos, = ", n_distinct(filter(dados_hemi_v1, ESC == 4)$SUBJ))

paste("N de sujeitos com escolaridade = 5 anos, = ", n_distinct(filter(dados_hemi_v1, ESC == 5)$SUBJ))

paste("N de sujeitos com escolaridade = 7 anos, = ", n_distinct(filter(dados_hemi_v1, ESC == 7)$SUBJ))

dados <- filter(dados, ESC == 8 | ESC > 8)

dados_lobos_v1 <- unique(filter(dados, ROI == "F" | ROI == "T" | ROI == "O" | ROI == "P", Session == 1, !is.na(K_age_decay), SUBJ != "SUBJ211", SUBJ != "SUBJ223")) %>% droplevels()

dados_v1 <- filter(dados, ROI == "F" | ROI == "T" | ROI == "O" | ROI == "P" | ROI == "hemisphere", Session == 1) %>% droplevels()

dados_hemi_v1 <- unique(filter(dados, ROI == "hemisphere", Session == 1, !is.na(K_age_decay)))

```


## Numero de sujeitos

### Todos da lista
```{r N sujeitos, echo=FALSE, warning=FALSE, message=FALSE}
summary_dados_all <- filter(dados_raw, Session == 1) %>%
  group_by(machine, Diagnostic) %>%
  summarise(
  N = n_distinct(SUBJ),
  Mean = mean(Age),
  Max = max(Age),
  Min = min(Age),
  Median = median(Age),
  Std = sd(Age)
  )
  summary_dados_all %>% kable(digits = 2) %>% kable_styling()
  
paste("N sujeitos = ",n_distinct(filter(dados_raw, Session == 1)$SUBJ))  
paste("N sujeitos Philips = ",n_distinct(filter(dados_raw, Session == 1, machine == "Philips-Achieva")$SUBJ))
paste("N sujeitos Philips CTL, MCI e AD = ",n_distinct(filter(dados_raw, Session == 1, machine == "Philips-Achieva", Diagnostic =="CCL" | Diagnostic == "ALZ" | Diagnostic == "CONTROLE")$SUBJ))


# SUBJ_raw <- unique( dplyr::select(filter(dados_raw, Session == 1, machine == "Philips-Achieva", Diagnostic =="CCL" | Diagnostic == "ALZ" | Diagnostic == "CONTROLE"), c(SUBJ)))
# SUBJ_v1 <- unique( dplyr::select(dados_hemi_v1, c(SUBJ)))
# anti_join(SUBJ_raw, SUBJ_v1)
# filter(dados_raw, Session == 1, SUBJ == "SUBJ081"| SUBJ == "SUBJ139" | SUBJ == "SUBJ211" | SUBJ == "SUBJ223") %>% kable(digits =2) %>% kable_styling()
# filter(dados, Session == 1, SUBJ == "SUBJ081"| SUBJ == "SUBJ139" | SUBJ == "SUBJ211" | SUBJ == "SUBJ223") %>% kable(digits =2) %>% kable_styling()

```

### Todos processados pelo FreeSurfer com sucesso
```{r N sujeitos FS, echo=FALSE, warning=FALSE, message=FALSE}
summary_dados_all <- filter(dados_all, Session == 1) %>%
  group_by(Diagnostic, machine) %>%
  summarise(
  N = n_distinct(SUBJ),
  Mean = mean(Age),
  Max = max(Age),
  Min = min(Age),
  Median = median(Age),
  Std = sd(Age)
  )
  summary_dados_all %>% kable(digits = 2) %>% kable_styling()
  
  paste("N sujeitos = ",n_distinct(filter(dados_all, Session == 1)$SUBJ))  
```

### Somente Philips

```{r N sujeitos Philips, echo=FALSE, message=FALSE, warning=FALSE}
dados_hemi_v1 %>%
  group_by(Diagnostic) %>%
  summarise(
    N = n_distinct(SUBJ),
    age = paste(signif(mean(Age), 2), "±", signif(sd(Age), 2)),
    age_range = paste(signif(min(Age), 2), "; ", signif(max(Age), 2)),
    ESC = paste(signif(mean(ESC), 2), "±", signif(sd(ESC), 2)),
    COGNITIVE_INDEX = paste(signif(mean(COGNITIVE_INDEX), 2), "±", signif(sd(COGNITIVE_INDEX), 2)),
    TAU = paste(signif(mean(TAU), 2), "±", signif(sd(TAU), 2)),
    AB1_40 = paste(signif(mean(`AB1-40`), 2), "±", signif(sd(`AB1-40`), 2)),
    AB1_42 = paste(signif(mean(`AB1-42`), 2), "±", signif(sd(`AB1-42`), 2)),
    Lipoxin = paste(signif(mean(Lipoxina), 2), "±", signif(sd(Lipoxina), 2)),
    AvgT =  paste(signif(mean(AvgThickness), 2), "±", signif(sd(AvgThickness), 2)),
    AT =  paste(signif(mean(TotalArea), 2), "±", signif(sd(TotalArea), 2)),
    AE =  paste(signif(mean(ExposedArea), 2), "±", signif(sd(ExposedArea), 2)),
    k =  paste(signif(mean(k), 2), "±", signif(sd(k), 2)),
    K =  paste(signif(mean(K), 2), "±", signif(sd(K), 2)),
    S =  paste(signif(mean(S), 2), "±", signif(sd(S), 2)),
    I =  paste(signif(mean(I), 2), "±", signif(sd(I), 2))
  ) %>% kable(digits = 2) %>% kable_styling()

dados_hemi_v1 %>%
  group_by(Gender, Diagnostic) %>%
  summarise(
    N = n_distinct(SUBJ),
    age = paste(signif(mean(Age), 2), "±", signif(sd(Age), 2)),
    age_range = paste(signif(min(Age), 2), "; ", signif(max(Age), 2)),
    ESC = paste(signif(mean(ESC), 2), "±", signif(sd(ESC), 2)),
    COGNITIVE_INDEX = paste(signif(mean(COGNITIVE_INDEX), 2), "±", signif(sd(COGNITIVE_INDEX), 2)),
    TAU = paste(signif(mean(TAU), 2), "±", signif(sd(TAU), 2)),
    AB1_40 = paste(signif(mean(`AB1-40`), 2), "±", signif(sd(`AB1-40`), 2)),
    AB1_42 = paste(signif(mean(`AB1-42`), 2), "±", signif(sd(`AB1-42`), 2)),
    Lipoxin = paste(signif(mean(Lipoxina), 2), "±", signif(sd(Lipoxina), 2)),
    AvgT =  paste(signif(mean(AvgThickness), 2), "±", signif(sd(AvgThickness), 2)),
    AT =  paste(signif(mean(TotalArea), 2), "±", signif(sd(TotalArea), 2)),
    AE =  paste(signif(mean(ExposedArea), 2), "±", signif(sd(ExposedArea), 2)),
    k =  paste(signif(mean(k), 2), "±", signif(sd(k), 2)),
    K =  paste(signif(mean(K), 2), "±", signif(sd(K), 2)),
    S =  paste(signif(mean(S), 2), "±", signif(sd(S), 2)),
    I =  paste(signif(mean(I), 2), "±", signif(sd(I), 2))
  ) %>% kable(digits = 2) %>% kable_styling()

lm_Age <- lm(Age ~ Diagnostic, data = dados_hemi_v1)
anova(lm_Age)
Age_diag_tk <- TukeyHSD(aov(Age ~ Diagnostic, data = dados_hemi_v1))
Age_diag_tk

lm_esc <- lm(ESC ~ Diagnostic, data = dados_hemi_v1)
anova(lm_esc)
ESC_diag_TK <- TukeyHSD(aov(ESC ~ Diagnostic, data = dados_hemi_v1))
ESC_diag_TK

lm_COGNITIVE_INDEX <-
  lm(COGNITIVE_INDEX ~ Diagnostic, data = dados_hemi_v1)
anova(lm_COGNITIVE_INDEX)
COGINDX_diag_TK <-
  TukeyHSD(aov(COGNITIVE_INDEX ~ Diagnostic, data = dados_hemi_v1))
COGINDX_diag_TK

paste("N sujeitos = ", n_distinct(dados_hemi_v1$SUBJ))
paste("N sujeitos lobos = ", n_distinct(dados_lobos_v1$SUBJ))

SUBJ_hemi <- unique(dplyr::select(dados_hemi_v1, c(SUBJ)))
SUBJ_lobos <- unique(dplyr::select(dados_lobos_v1, c(SUBJ)))
anti_join(SUBJ_lobos, SUBJ_hemi)

```

### Sujeitos excluídos

```{r N sujeitos excluidos, echo=FALSE, message=FALSE, warning=FALSE}

excl <-
  dados_excluidos %>% dplyr::select(c(SUBJ, Age, Diagnostic, machine, ROI, localGI)) %>% filter(ROI == "hemisphere") %>% distinct(SUBJ, .keep_all = TRUE)
  
  excl %>% kable(digits = 2) %>% kable_styling()

  paste("N sujeitos = ",n_distinct(excl$SUBJ))  
```

### lista sujeitos
```{r subjs, eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}
dados_hemi_v1 %>% dplyr::select(SUBJ, acq_date, Age, Gender, Diagnostic) %>% unique() %>% kable(digits = 2) %>% kable_styling()
```


```{r distribuicao da Sample}
ggplot(data = dados_hemi_v1, aes(x = Diagnostic, y = Age, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + 
  geom_boxplot() + theme_pubr() +
  stat_compare_means(method = "anova")


ggplot(data = dados_hemi_v1, aes(x = Diagnostic, y = K, color = Gender, fill = Gender, alpha = 0.4)) +
  geom_boxplot() + theme_pubr() +
  stat_compare_means(method = "anova")

```

```{r}
dados_hemi_v1 %>%
group_by(Diagnostic)  %>%
summarise(
N = n_distinct(SUBJ),
    age = paste(signif(mean(Age), 2), "±", signif(sd(Age), 2)),
    age_range = paste(signif(min(Age), 2), "; ", signif(max(Age), 2)),
    ESC = paste(signif(mean(ESC), 2), "±", signif(sd(ESC), 2)),
    COGNITIVE_INDEX = paste(signif(mean(COGNITIVE_INDEX), 2), "±", signif(sd(COGNITIVE_INDEX), 2)),
    TAU = paste(signif(mean(TAU), 2), "±", signif(sd(TAU), 2)),
    AB1_40 = paste(signif(mean(`AB1-40`), 2), "±", signif(sd(`AB1-40`), 2)),
    AB1_42 = paste(signif(mean(`AB1-42`), 2), "±", signif(sd(`AB1-42`), 2)),
    Lipoxin = paste(signif(mean(Lipoxina), 2), "±", signif(sd(Lipoxina), 2)),
    AvgT =  paste(signif(mean(AvgThickness), 2), "±", signif(sd(AvgThickness), 2)),
    AT =  paste(signif(mean(TotalArea), 2), "±", signif(sd(TotalArea), 2)),
    AE =  paste(signif(mean(ExposedArea), 2), "±", signif(sd(ExposedArea), 2)),
    k =  paste(signif(mean(k), 2), "±", signif(sd(k), 2)),
    K =  paste(signif(mean(K), 2), "±", signif(sd(K), 2)),
    S =  paste(signif(mean(S), 2), "±", signif(sd(S), 2)),
    I =  paste(signif(mean(I), 2), "±", signif(sd(I), 2))) %>% kable(digits = 2) %>% kable_styling()

```


# Resultados

## Aplicacao do modelo

Todos os sujeitos
```{r model Mota & Houzel, echo=FALSE}

lm_amostra <- dados_datasetscomp %>%
  group_by(Sample) %>%
  do(fit_amostra = tidy(lm(1/2 * logAvgThickness + logTotalArea ~ logExposedArea, data = ., na.action = na.omit), conf.int=TRUE)) %>% unnest()

ggplot(dados_datasetscomp, aes(logExposedArea, 1/2*logAvgThickness + logTotalArea)) +
  geom_point(aes(color = Sample)) +
  geom_smooth(method = "lm", se = FALSE) +
  theme_pubr()

lm_amostra %>% kable(digits = 2) %>% kable_styling()

```

### Apenas humanos IDOR

```{r modelo_humanos, echo=FALSE, warning=FALSE, messAge=FALSE}
lm_fit_comp_idor <- dados_hemi_v1 %>%
  group_by(Diagnostic) %>%
  do(fit_comp_idor = tidy(lm(1/2 * logAvgThickness + logTotalArea ~ logExposedArea, data = ., na.action = na.omit), conf.int=TRUE)) %>% unnest()

lm_fit_comp_idor %>% kable(digits = 2) %>% kable_styling()

N_subj_diag <- dados_hemi_v1 %>%
  group_by(Diagnostic) %>%
  summarise(N_SUBJ = n_distinct(SUBJ))

fig2a <- ggplot(
  dados_hemi_v1,
  aes(logExposedArea, 1 / 2 * logAvgThickness + logTotalArea, color = Diagnostic, fill = Diagnostic )
  ) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  geom_abline(slope = 1.25, intercept = coef(lm(1 / 2 * logAvgThickness + logTotalArea ~ logExposedArea, data = dados_hemi_v1, na.action = na.omit))[1], color = "black") +
  labs(x = expression('log'[10]*'A'['e']),
       y = expression('log'[10]*'A'['t']*sqrt('T'))) +
  theme_pubr() +
  theme(axis.title = element_text(size = 11),
    axis.text = element_text(size = 10), text = element_text(size = 10))

fig2b <- ggplot(
  data = filter(lm_fit_comp_idor, term == "logExposedArea"),
  aes(
  x = Diagnostic,
  y = estimate, color = Diagnostic
  )
  ) +
  geom_point() +
  geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error)) +
  geom_hline(yintercept = 1.25, linetype = "dashed") +
  theme_pubr() +
  labs(y = "Slope") +
  theme(axis.title = element_text(size = 11),
    axis.text = element_text(size = 10), text = element_text(size = 10), legend.position = "none")
# +  geom_text(aes(label = N_subj_diag$N_SUBJ), nudge_y = 0.3)



fig2a
fig2b

paste("Verificando a diferenca entre o coeficiente obtido para a Sample e o teorico de 5/4, qual o valor t deste teste?", abs(coef(summary(lm(1 / 2 * logAvgThickness + logTotalArea ~ logExposedArea, data = dados_hemi_v1, na.action = na.omit)))[2,1]-1.25)/coef(summary(lm(1 / 2 * logAvgThickness + logTotalArea ~ logExposedArea, data = dados_hemi_v1, na.action = na.omit)))[2,2])
paste("Verificando a diferenca entre o coeficiente obtido para a Sample e o teorico de 5/4, qual o valor p deste teste?", test_coef(lm(1 / 2 * logAvgThickness + logTotalArea ~ logExposedArea, data = dados_hemi_v1, na.action = na.omit), 2, 1.25))

```

##### Gender
```{r Gender }
ggplot(dados_hemi_v1, aes(x = Gender, y = K, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
         geom_boxplot() + stat_compare_means(method = "anova") + theme_pubr()

ggplot(dados_hemi_v1, aes(logExposedArea, 1/2*logAvgThickness + logTotalArea, color = Gender, fill = Gender)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(Diagnostic ~ .) + stat_regline_equation() +
  theme_pubr()

lm_amostras_Gender <- dados_hemi_v1 %>%
  group_by(Gender, Diagnostic) %>%
  do(fit_amostras_Gender = tidy(lm(1/2 * logAvgThickness + logTotalArea ~ logExposedArea, data = ., na.action = na.omit), conf.int=TRUE)) %>% unnest()

lm_amostras_Gender %>% kable(digits = 2) %>% kable_styling()

ggplot(dados_hemi_v1, aes(x = Gender, y = S, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
         geom_boxplot() + stat_compare_means(method = "anova") + theme_pubr()
 

 ggplot(dados_hemi_v1, aes(x = Gender, y = I, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
         geom_boxplot() + stat_compare_means(method = "anova") + theme_pubr()

```


## Influencia do envelhecimento e diagnostico na girificacao
### Envelhecimento saudavel

```{r echo=FALSE}
ggplot(data = dados_hemi_v1, aes(Diagnostic, Age, color = Diagnostic, fill = Diagnostic, alpha = 0.2)) +
  geom_boxplot() +
  theme_pubr() + stat_compare_means(method = "anova", label.y = 88) +
  stat_compare_means(method = "t.test", label = "p.signif") + ylim(40, 90)

aov_Age <- aov(Age ~ Diagnostic, data = dados_hemi_v1)
summary(aov_Age)
#TukeyHSD(aov_Age)
```


```{r eval=FALSE, include=FALSE}

ggplot(data = dados_hemi_v1, aes(Age, AvgThickness, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()

ggplot(data = dados_hemi_v1, aes(Age, logAvgThickness, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()

ggplot(data = dados_hemi_v1, aes(Age, logAvgThickness_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_regline_equation() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()

ggplot(data = dados_hemi_v1, aes(Age, TotalArea, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()

ggplot(data = dados_hemi_v1, aes(Age, logTotalArea, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()

ggplot(data = dados_hemi_v1, aes(Age, logTotalArea_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_regline_equation() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()

ggplot(data = dados_hemi_v1, aes(Age, ExposedArea, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()

ggplot(data = dados_hemi_v1, aes(Age, logExposedArea, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()

ggplot(data = dados_hemi_v1, aes(Age, logExposedArea_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_regline_equation() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()

ggplot(data = filter(dados_hemi_v1, Diagnostic == "CTL"), aes(logExposedArea, 1/2*logAvgThickness + logTotalArea, color = Age_interval, fill = Age_interval)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()

```


```{r envelhecimento, echo=FALSE, messAge=FALSE, warning=FALSE}

lm_Age <- filter(dados_hemi_v1, Diagnostic == "CTL", Age_interval != "41-45", Age_interval != "81-85") %>%
  group_by(Age_interval) %>%
  do(fit_Age = tidy(lm(1/2 * logAvgThickness + logTotalArea ~ logExposedArea, data = ., na.action = na.omit), conf.int= TRUE)) %>% unnest(cols = c(fit_Age))

N_subj <- filter(dados_hemi_v1, Diagnostic == "CTL", Age_interval != "41-45", Age_interval != "81-85") %>%
  group_by(Age_interval) %>%
  summarise(N_SUBJ = n_distinct(SUBJ))
                                           
fig1a <- ggplot(
  data = filter(lm_Age, term == "logExposedArea"),
  aes(
  x = Age_interval,
  y = estimate
  )
  ) +
  geom_point() +
  geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error)) +
  geom_smooth(method = "lm", se = TRUE) +
  geom_hline(yintercept = 1.25, linetype = "dashed") +
  geom_text(aes(label = N_subj$N_SUBJ), nudge_y = 0.6) +
  theme_pubr() +
  labs(y = "Slope", x = "Age [years]") +
  theme(axis.title = element_text(size = 11),
    axis.text = element_text(size = 10), text = element_text(size = 10))

fig1a

Age_Coef_term <- filter(lm_Age, term == "logExposedArea")

Age_coef_aov <- (kruskal.test(estimate ~ Age_interval, data = Age_Coef_term))
Age_coef_aov
# Age_coef_aov_TK <- dunn_test(estimate ~ Age_interval, data = Age_Coef_term)

# plot(Age_coef_aov_TK , las=1 , col="brown")

Age_coef_aov_k <- (aov(K ~ Age_interval, data = dados_hemi_v1))
summary(Age_coef_aov_k)
Age_coef_aov_K_TK <- TukeyHSD(Age_coef_aov_k)
#Age_coef_aov_K_TK
#plot(Age_coef_aov_K_TK , las=1 , col="brown")


lm_Age_diag <- dados_hemi_v1 %>%
  group_by(Diagnostic, 
           Age_interval) %>%
  do(fit_Age_diag = tidy(lm(1/2 * logAvgThickness + logTotalArea ~ logExposedArea, data = ., na.action = na.omit), conf.int=TRUE)) %>% unnest()

lm_Age_diag

N_subj_diag <- dados_hemi_v1 %>%
  group_by(Diagnostic, 
           Age_interval) %>%
  summarise(N_SUBJ = n_distinct(SUBJ))

ggplot(
  data = filter(lm_Age_diag, term == "logExposedArea"),
  aes(
  x = Age_interval,
  y = estimate, color = Diagnostic
  )
  ) +
  geom_point() +
  geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error)) +
  geom_smooth(method = "lm", se = TRUE) +
  geom_text(aes(label = N_subj_diag$N_SUBJ), nudge_y = 0.6) +
  geom_hline(yintercept = 1.25, linetype = "dashed") +
  stat_compare_means(method = "kruskal.test") +
  theme_pubr() +
  labs(y = "slope") +
  facet_grid(Diagnostic ~ . )  +
  labs(caption = paste(
  "Todos, apenas 1 visita, N = ",
  n_distinct(dados_hemi_v1$SUBJ)))
```

Brain volume:
```{r}

ggplot(data = dados_hemi_v1, aes(GMvolume, K, alpha = 0.4)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE, color = "gray") +
  theme_pubr()

lm_Age <- dados_hemi_v1 %>%
  group_by(Diagnostic) %>%
  do(fit_Age = glance(lm(K ~ GMvolume, data = ., na.action = na.omit), conf.int = TRUE)) %>% unnest()

cor.test(x = filter(dados_hemi_v1, Diagnostic == "CTL")$GMvolume, y = filter(dados_hemi_v1, Diagnostic == "CTL")$K)

```

K:
```{r}

# fig1b <- ggplot(data = dados_hemi_v1, aes(Age, K, color = Diagnostic, fill = Diagnostic, shape = Diagnostic)) +
#   geom_point() +
#   geom_smooth(method = "lm", se = TRUE) +
#   theme_pubr() +
#   guides(alpha = FALSE, shape = FALSE) + 
#   labs(x = "Age in years") +
#     scale_fill_manual(values=c("#999999", "#666666", "#000000")) + scale_color_manual(values=c("#999999", "#666666", "#000000")) +
#   theme(axis.title = element_text(size = 11),
#     axis.text = element_text(size = 10), text = element_text(size = 10))

fig1b <- ggplot(data = dados_hemi_v1, aes(Age, K, color = Diagnostic, fill = Diagnostic)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() +
  guides(alpha = FALSE) + 
  labs(x = "Age [years]") +
  theme(axis.title = element_text(size = 11),
    axis.text = element_text(size = 10), text = element_text(size = 10))

fig1b

fig1 <- ggarrange(fig1a, fig1b, labels = c("A","B"), nrow = 2, ncol = 1, font.label = list(size = 11))

ggsave("fig1.pdf", plot = fig1, dpi=1200, width = 11, height = 11, units = "cm", device = "pdf")
ggsave("fig1.jpeg", plot = fig1, dpi=1200, width = 11, height = 11, units = "cm", device = "jpeg")


lm_Age <- dados_hemi_v1 %>%
  group_by(Diagnostic) %>%
  do(fit_Age = glance(lm(K ~ Age, data = ., na.action = na.omit), conf.int = TRUE)) %>% unnest()

cor.test(x = filter(dados_hemi_v1, Diagnostic == "CTL")$Age, y = filter(dados_hemi_v1, Diagnostic == "CTL")$K)

```


I:
```{r i Age}

ggplot(data = dados_hemi_v1, aes(Age, I, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()

lm_Age <- dados_hemi_v1 %>%
  group_by(Diagnostic) %>%
  do(fit_Age = glance(lm(I ~ Age, data = ., na.action = na.omit), conf.int =TRUE)) %>% unnest()

lm_Age

cor.test(x = filter(dados_hemi_v1, Diagnostic == "CTL")$Age, y = filter(dados_hemi_v1, Diagnostic == "CTL")$I)

Age_coef_aov_I <- (aov(I ~ Age_interval, data = dados_hemi_v1))
summary(Age_coef_aov_I)
Age_coef_aov_I_TK <- TukeyHSD(Age_coef_aov_I)
#Age_coef_aov_I_TK
#plot(Age_coef_aov_I_TK , las=1 , col="brown")

ggplot(data = dados_hemi_v1, aes(Age, I_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()

```

S:
```{r s Age}

ggplot(data = dados_hemi_v1, aes(Age, S, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()

lm_Age <- dados_hemi_v1 %>%
  group_by(Diagnostic) %>%
  do(fit_Age = glance(lm(S ~ Age, data = ., na.action = na.omit), conf.int=TRUE))%>%unnest()

lm_Age

cor.test(x = filter(dados_hemi_v1, Diagnostic == "CTL")$Age, y = filter(dados_hemi_v1, Diagnostic == "CTL")$S)

Age_coef_aov_S <- (aov(S ~ Age_interval, data = dados_hemi_v1))
summary(Age_coef_aov_S)
Age_coef_aov_S_TK <- TukeyHSD(Age_coef_aov_S)
#Age_coef_aov_S_TK
#plot(Age_coef_aov_S_TK , las=1 , col="brown")

ggplot(data = dados_hemi_v1, aes(Age, S_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()


```

#### Envelhecimento saudavel - lobes
```{r envelhecimento - lobes, eval=FALSE, warning=FALSE, include=FALSE, messAge=FALSE}

ggplot(data = dados_lobos_v1, aes(Age, AvgThickness, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + facet_grid(ROI ~ .)

ggplot(data = dados_lobos_v1, aes(Age, logAvgThickness, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + facet_grid(ROI ~ .)

ggplot(data = dados_lobos_v1, aes(Age, logAvgThickness_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_regline_equation() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + facet_grid(ROI ~ .)

ggplot(data = dados_lobos_v1, aes(Age, TotalArea, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + facet_grid(ROI ~ .)

ggplot(data = dados_lobos_v1, aes(Age, logTotalArea, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + facet_grid(ROI ~ .)

ggplot(data = dados_lobos_v1, aes(Age, logTotalArea_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_regline_equation() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + facet_grid(ROI ~ .)

ggplot(data = dados_lobos_v1, aes(Age, ExposedArea, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + facet_grid(ROI ~ .)

ggplot(data = dados_lobos_v1, aes(Age, logExposedArea, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + facet_grid(ROI ~ .)

ggplot(data = dados_lobos_v1, aes(Age, logExposedArea_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_regline_equation() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + facet_grid(ROI ~ .)

```

```{r}
lm_Age <- dados_lobos_v1 %>%
  group_by(ROI, Diagnostic, 
           Age_interval) %>%
  do(fit_Age = tidy(lm(1/2 * logAvgThickness + logTotalArea ~ logExposedArea, data = ., na.action = na.omit), conf.int=TRUE)) %>% unnest()

ggplot(
  data = filter(lm_Age, term == "logExposedArea"),
  aes(
  x = Age_interval,
  y = estimate, color = Diagnostic
  )
  ) +
  geom_point() + geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error)) + geom_smooth(method = "lm", se = TRUE) + geom_hline(yintercept = 1.25, linetype = "dashed")  + stat_compare_means(method = "kruskal.test") + theme_pubr() + labs(y = "slope") + facet_grid(ROI ~ Diagnostic) + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


### Girifcacao e envelhecimento


```{r eval=FALSE, include=FALSE}

ggplot(dados_hemi_v1, aes(x = Diagnostic, y = S, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_boxplot() +
 stat_compare_means(method = "anova") + theme_pubr()


aov_diag_S <- aov(S ~ Diagnostic, data = dados_hemi_v1)
summary(aov_diag_S)
aov_diag_S_diag_TK <- TukeyHSD(aov_diag_S)
#aov_diag_S_diag_TK

aov_diag_S_diag_TK_t <- mutate(as.data.frame(aov_diag_S_diag_TK$Diagnostic), Contrast = c("MCI-AD", "CTL-AD", "CTL-MCI") , morphological_parameter = "S", Age_correction = "no", ROI = "hemisphere")

ggplot(dados_hemi_v1, aes(x = Diagnostic, y = S_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_boxplot() +
 stat_compare_means(method = "anova") + theme_pubr()


aov_diag_S_age_decay <- aov(S_age_decay ~ Diagnostic, data = dados_hemi_v1)
summary(aov_diag_S_age_decay)
aov_diag_S_age_decay_diag_TK <- TukeyHSD(aov_diag_S_age_decay)
#aov_diag_S_age_decay_diag_TK

aov_diag_S_age_decay_diag_TK_t <- mutate(as.data.frame(aov_diag_S_age_decay_diag_TK$Diagnostic), Contrast = c("MCI-AD", "CTL-AD", "CTL-MCI") , morphological_parameter = "S", Age_correction = "yes", ROI = "hemisphere")

```

#### Reduzindo o efeito da idade

```{r girificacao e envelhecimento - Age decay, echo=FALSE, message=FALSE, warning=FALSE}

summary(lm(1/2 * logAvgThickness_age_decay + logTotalArea_age_decay ~ logExposedArea_age_decay, data = dados_hemi_v1, na.action = na.omit))


lm_diagnostic_Agedecay <- dados_hemi_v1 %>%
  group_by(Diagnostic) %>%
  do(fit_diagnostic_Agedecay = tidy(lm(1/2 * logAvgThickness_age_decay + logTotalArea_age_decay ~ logExposedArea_age_decay, data = ., na.action = na.omit), conf.int=TRUE)) %>% unnest()

lm_diagnostic_Agedecay %>% kable(digits = 2) %>% kable_styling()

aov_diag_slope <- kruskal.test(estimate ~ Diagnostic, data = filter(lm_diagnostic_Agedecay, term == "logExposedArea_age_decay"))
aov_diag_slope

ggplot(
  data = filter(lm_diagnostic_Agedecay, term == "logExposedArea_age_decay"),
  aes(
  x = Diagnostic,
  y = estimate, color = Diagnostic
  )
  ) +
  geom_point() + geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error)) + geom_smooth(method = "lm", se = TRUE) + geom_hline(yintercept = 1.25, linetype = "dashed") + theme_pubr() + labs(y = "slope")

ggplot(data = dados_hemi_v1, aes(logExposedArea_age_decay, 1/2 * logAvgThickness_age_decay + logTotalArea_age_decay , color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()+ labs(y = "1/2 log(AvgThickness) + log(TotalArea) (after age correction)", x = "log(ExposedArea) (after age correction)" )

ggplot(data = dados_hemi_v1, aes(Age, K_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_regline_equation() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(y = "K after age correction")

```

### Diferenca entre diagnosticos

```{r girificacao e envelhecimento, echo=FALSE, messAge=FALSE, warning=FALSE}

lm_diagnostic <- dados_hemi_v1 %>%
  group_by(Diagnostic) %>%
  do(fit_diagnostic = tidy(lm(1/2 * logAvgThickness + logTotalArea ~ logExposedArea, data = ., na.action = na.omit), conf.int=TRUE)) %>% unnest()

lm_diagnostic %>% kable(digits = 2) %>% kable_styling()

ggplot(
  data = filter(lm_diagnostic, term == "logExposedArea"),
  aes(
  x = Diagnostic,
  y = estimate, color = Diagnostic
  )
  ) +
  geom_point() + geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error)) + geom_smooth(method = "lm", se = TRUE) + geom_hline(yintercept = 1.25, linetype = "dashed") + theme_pubr() + labs(y = "slope")+ theme(legend.position = "none")

#kruskal.test(estimate, Diagnostic, data = filter(diagnostic_Coef, term == "logExposedArea"))

ggplot(data = dados_hemi_v1, aes(logExposedArea, 1/2 * logAvgThickness + logTotalArea, color = Diagnostic, fill = Diagnostic)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()

ggplot(data = dados_hemi_v1, aes(Age, K, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_regline_equation() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr()

fig2c <- ggplot(dados_hemi_v1, aes(x = Diagnostic, y = K, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_boxplot() +
  geom_point() +
  theme_pubr() +
  guides(alpha = FALSE) +
  theme(axis.title = element_text(size = 11),
    axis.text = element_text(size = 10), text = element_text(size = 10), legend.position = "none")


fig2c

fig2 <- ggarrange(fig2a, ggarrange(fig2b, fig2c, labels = c("B","C"), nrow = 1, ncol = 2, font.label = list(size = 11)),labels = c("A"),  ncol = 1, font.label = list(size = 11), common.legend = TRUE, legend = "top")

ggsave("fig2.pdf", plot = fig2, dpi=1200, width = 11, height = 11, units = "cm", device = "pdf")
ggsave("fig2.jpeg", plot = fig2, dpi=1200, width = 11, height = 11, units = "cm", device = "jpeg")


a <- aov(K ~ Diagnostic*ROI, data = dados)
summary(a)
a.TukeyHSD <- as.data.frame(TukeyHSD(a)$`Diagnostic:ROI`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a)$`Diagnostic:ROI`))
a.TukeyHSD <- as_tibble(cbind(Contrasts, a.TukeyHSD))
rownames(a.TukeyHSD) <- NULL
colnames(a.TukeyHSD)[1] <- c("Contrast")
a.TukeyHSD <- a.TukeyHSD %>%
  mutate(Contrast1 = str_split(a.TukeyHSD$Contrast, pattern = "-", simplify = TRUE)[,1],
         Contrast2 = str_split(a.TukeyHSD$Contrast, pattern = "-", simplify = TRUE)[,2])
a.TukeyHSD <- a.TukeyHSD %>%
  mutate(Diagnostic.1 = str_split(a.TukeyHSD$Contrast1, pattern = ":", simplify = TRUE)[,1],
         Diagnostic.2 = str_split(a.TukeyHSD$Contrast2, pattern = ":", simplify = TRUE)[,1],
         ROI.1 = str_split(a.TukeyHSD$Contrast1, pattern = ":", simplify = TRUE)[,2],
         ROI.2 = str_split(a.TukeyHSD$Contrast2, pattern = ":", simplify = TRUE)[,2],
         Contrast = str_c(Diagnostic.1, Diagnostic.2, sep="-")) %>% filter(ROI.1 == ROI.2) %>% dplyr::select(-c(Contrast1 , Contrast2))

a.TukeyHSD$ROI.1 <- as.factor(a.TukeyHSD$ROI.1)
a.TukeyHSD$ROI.1 <- relevel(a.TukeyHSD$ROI.1, ref = "hemisphere")


ggplot(data = filter(a.TukeyHSD, `p adj` < 0.05 | `p adj` == 0.05), aes(
    x = reorder(ROI.1, desc(ROI.1)),
    y = diff,
    ymin = lwr,
    ymax = upr, color = Contrast)) +
    geom_hline(yintercept = 0,
               linetype = "11",
               colour = "grey60") +
    geom_pointrange( position = position_dodge(width = 0.2)) +
geom_text(aes(label = str_c("p adj = ", signif(`p adj`, digits = 2))), nudge_x = 0.3) +
    coord_flip() + 
    labs(y =  "Differences in mean levels of Diagnostic", x = "ROI") +
  theme_pubr() + 
  theme(axis.title = element_text(size = 11),
    axis.text = element_text(size = 10), text = element_text(size = 10))


```

```{r}
ggplot(dados_hemi_v1, aes(x = Diagnostic, y = S, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_boxplot()  + theme_pubr()

ggplot(dados_hemi_v1, aes(x= S, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_density() + theme_pubr()

aov_diag <- aov(S ~ Diagnostic, data = dados_hemi_v1)
summary(aov_diag)
aov_diag_K_diag_TK <- TukeyHSD(aov_diag)
aov_diag_K_diag_TK

ggplot(dados_hemi_v1, aes(x = Diagnostic, y = I, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_boxplot()  + theme_pubr()

ggplot(dados_hemi_v1, aes(x= I, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_density() + theme_pubr()

aov_diag <- aov(I ~ Diagnostic, data = dados_hemi_v1)
summary(aov_diag)
aov_diag_K_diag_TK <- TukeyHSD(aov_diag)
aov_diag_K_diag_TK
```



Is it easier to diff diag when younger?
```{r}
ggplot(filter(dados_hemi_v1, Age_interval != "46-50"& Age_interval != "51-55"& Age_interval != "41-45"& Age_interval != "56-60"), aes(x = Age_interval, y = logAvgThickness, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_boxplot()  + theme_pubr()

aov_diag2 <- aov(logAvgThickness ~ Diagnostic*Age_interval, data = filter(dados_hemi_v1, Age_interval != "46-50"& Age_interval != "51-55"& Age_interval != "41-45"& Age_interval != "56-60"))
summary(aov_diag2)
aov_diag_2_diag_TK <- TukeyHSD(aov_diag2)
aov_diag_2_diag_TK$`Diagnostic:Age_interval`



ggplot(filter(dados_hemi_v1, Age_interval != "46-50"& Age_interval != "51-55"& Age_interval != "41-45"& Age_interval != "56-60"), aes(x = Age_interval, y = K, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_boxplot()  + theme_pubr()

aov_diag2 <- aov(logAvgThickness ~ Diagnostic*Age_interval, data = filter(dados_hemi_v1, Age_interval != "46-50"& Age_interval != "51-55"& Age_interval != "41-45"& Age_interval != "56-60"))
summary(aov_diag2)
aov_diag_2_diag_TK <- TukeyHSD(aov_diag2)
aov_diag_2_diag_TK$`Diagnostic:Age_interval`

```


```{r diag - Age decay}
ggplot(dados_hemi_v1, aes(x = Diagnostic, y = K_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_boxplot() +
 stat_compare_means(method = "anova") + theme_pubr()

```


```{r}
ggplot(dados_hemi_v1, aes(x = Diagnostic, y = S_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_boxplot()  + theme_pubr()

ggplot(dados_hemi_v1, aes(x= S_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_density() + theme_pubr()

```

Is it easier to diff diag when younger?
```{r}
ggplot(filter(dados_hemi_v1, Age_interval != "46-50"& Age_interval != "51-55"& Age_interval != "41-45"& Age_interval != "56-60"), aes(x = Age_interval, y = logAvgThickness_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_boxplot()  + theme_pubr()

```


### Podemos localizar partes com maior detrimento por idade e doenca?

```{r girificacao e lobos, echo=FALSE, messAge=FALSE, warning=FALSE}
dados_lobos_v1_F <- filter(dados_lobos_v1, ROI == "F")

dados_lobos_v1_T <- filter(dados_lobos_v1, ROI == "T")

dados_lobos_v1_O <- filter(dados_lobos_v1, ROI == "O")

dados_lobos_v1_P <- filter(dados_lobos_v1, ROI == "P")

dados_lobos_v1_OP <- filter(dados_lobos_v1, ROI == "O" | ROI == "P")


lm_diagnostic_lobe <- dados_lobos_v1 %>%
  group_by(ROI, Diagnostic) %>%
  do(
  fit_diagnostic_lobe = tidy(lm(
  1 / 2 * logAvgThickness + logTotalArea ~ logExposedArea,
  data = .,
  na.action = na.omit
  ), conf.int=TRUE
  )) %>% unnest()
  

  
ggplot(data = filter(dados_lobos_v1, Diagnostic == "CTL"), aes(logExposedArea, 1/2 * logAvgThickness + logTotalArea, color = ROI, fill = ROI)) +
  geom_point() + geom_smooth(method = "lm", se = TRUE) +
  geom_abline(slope = filter(lm_diagnostic_lobe, term == "logExposedArea", Diagnostic == "CTL", ROI == "hemisphere")$estimate, linetype = "dashed", intercept = filter(lm_diagnostic_lobe, term == "(Intercept)", Diagnostic == "CTL", ROI == "hemisphere")$estimate) +
  stat_regline_equation() +
  theme_pubr()

ggplot(
  data = dados_lobos_v1,
  aes(
  logExposedArea,
  1 / 2 * logAvgThickness + logTotalArea,
  color = Diagnostic,
  fill = Diagnostic
  )
  ) +
  geom_point() +
  geom_abline(slope = filter(lm_diagnostic_lobe, term == "logExposedArea", Diagnostic == "CTL", ROI == "hemisphere")$estimate, linetype = "dashed", intercept = filter(lm_diagnostic_lobe, term == "(Intercept)", Diagnostic == "CTL", ROI == "hemisphere")$estimate) +
  stat_regline_equation() + 
  facet_wrap(ROI ~ .) +
  theme_pubr() 

ggplot(
  data = filter(lm_diagnostic_lobe, term == "logExposedArea"),
  aes(
  x = Diagnostic,
  y = estimate,
  color = Diagnostic
  )) +
  geom_point() + 
  geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error)) + 
  geom_hline(yintercept = 1.25, linetype = "dashed")  + 
  stat_compare_means(method = "kruskal.test") + 
  labs(y = "slope") + 
  facet_wrap(ROI ~. ) + 
  theme_pubr()

```

#### Corrigindo pela curvatura

```{r girificaca e lobos - corrigido pela curvatura, echo=FALSE, messAge=FALSE, warning=FALSE}
lm_diagnostic_lobe_curv <- dados_lobos_v1 %>%
  group_by(Diagnostic) %>%
  do(fit_diagnostic_lobe_curv = tidy(lm(1/2 * logAvgThickness + logTotalArea_corrected ~ logExposedArea_corrected, data = ., na.action = na.omit),conf.int=TRUE)) %>% unnest()

lm_diagnostic_lobe_curv %>% kable(digits = 3) %>% kable_styling()

lm_diagnostic_lobe_curv <- dados_lobos_v1 %>%
  group_by(SUBJ, Diagnostic) %>%
  do(fit_diagnostic_lobe_curv = tidy(lm(1/2 * logAvgThickness + logTotalArea_corrected ~ logExposedArea_corrected, data = ., na.action = na.omit),conf.int=TRUE)) %>% unnest()

ggplot(data = filter(lm_diagnostic_lobe_curv, term == "logExposedArea_corrected"), aes(x = estimate, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + geom_density() + geom_vline(xintercept = 1.25) + theme_pubr()

lm_diagnostic_lobe_curv <- dados_lobos_v1 %>%
  group_by(ROI, Diagnostic) %>%
  do(fit_diagnostic_lobe_curv = tidy(lm(1/2 * logAvgThickness + logTotalArea_corrected ~ logExposedArea_corrected, data = ., na.action = na.omit), conf.int=TRUE)) %>% unnest()

lm_diagnostic_lobe_curv %>% kable(digits = 2) %>% kable_styling()

ggplot(data = filter(dados_lobos_v1, Diagnostic == "CTL"), aes(logExposedArea_corrected, 1/2 * logAvgThickness + logTotalArea_corrected, color = ROI, fill = ROI)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  geom_abline(slope = filter(lm_diagnostic_lobe_curv, term == "logExposedArea_corrected", Diagnostic == "CTL", ROI == "hemisphere")$estimate, linetype = "dashed", intercept = filter(lm_diagnostic_lobe_curv, term == "(Intercept)", Diagnostic == "CTL", ROI == "hemisphere")$estimate) + 
  stat_regline_equation() + 
  theme_pubr()

ggplot(data = dados_lobos_v1, aes(logExposedArea_corrected, 1/2 * logAvgThickness + logTotalArea_corrected, color = Diagnostic, fill = Diagnostic)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE)  +
  geom_abline(slope = filter(lm_diagnostic_lobe_curv, term == "logExposedArea_corrected", Diagnostic == "CTL", ROI == "hemisphere")$estimate, linetype = "dashed", intercept = filter(lm_diagnostic_lobe_curv, term == "(Intercept)", Diagnostic == "CTL", ROI == "hemisphere")$estimate) +
  stat_regline_equation() + 
  theme_pubr() + facet_wrap(ROI ~. )

ggplot(
  data = filter(lm_diagnostic_lobe_curv, term == "logExposedArea_corrected"),
  aes(
  x = reorder(Diagnostic, estimate),
  y = estimate,
  color = Diagnostic
  )
  ) +
  geom_point() + geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error)) + stat_compare_means(method = "kruskal.test") + theme_pubr() + labs(y = "slope") + facet_wrap(ROI ~. )

ggplot(data = dados_lobos_v1, aes(Age, K_corrected,color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_smooth(method = "lm", se = TRUE) + stat_regline_equation() +
  theme_pubr() + facet_wrap(ROI ~. ) +labs(y = "K")


ggplot(dados_lobos_v1, aes(x = Diagnostic, y = K_corrected, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_boxplot() + theme_pubr() + facet_wrap(ROI ~ . )+labs(y = "K")

```

#### Corrigindo pela idade 

```{r girificaca e lobos - Age decay, echo=FALSE, messAge=FALSE, warning=FALSE}

lm_diagnostic_lobe_curv <- dados_lobos_v1 %>%
  group_by(SUBJ, Diagnostic) %>%
  do(fit_diagnostic_lobe_curv = tidy(lm(1/2 * logAvgThickness_age_decay + logTotalArea_age_decay ~ logExposedArea_age_decay, data = ., na.action = na.omit), conf.int=TRUE)) %>% unnest()

ggplot(data = filter(lm_diagnostic_lobe_curv, term == "logExposedArea_age_decay"), aes(x = estimate, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + geom_density() + geom_vline(xintercept = 1.25) + theme_pubr()

aggregate(filter(lm_diagnostic_lobe_curv, term == "logExposedArea_age_decay")$estimate, by=list(diag=filter(lm_diagnostic_lobe_curv, term == "logExposedArea_age_decay")$Diagnostic), mean)

lm_diagnostic_Agedecay_lobe <- dados_lobos_v1 %>%
  group_by(ROI, Diagnostic) %>%
  do(fit_diagnostic_Agedecay_lobe = tidy(lm(1/2 * logAvgThickness_age_decay + logTotalArea_age_decay ~ logExposedArea_age_decay, data = ., na.action = na.omit), conf.int=TRUE)) %>% unnest()

lm_diagnostic_Agedecay_lobe %>% kable(digits = 2) %>% kable_styling()

ggplot(data = filter(lm_diagnostic_Agedecay_lobe, term == "logExposedArea_age_decay"), aes(x = estimate, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + geom_density() + geom_vline(xintercept = 1.25) + theme_pubr()

aggregate(filter(lm_diagnostic_Agedecay_lobe, term == "logExposedArea_age_decay")$estimate, by=list(diag=filter(lm_diagnostic_Agedecay_lobe, term == "logExposedArea_age_decay")$Diagnostic, ROI=filter(lm_diagnostic_Agedecay_lobe, term == "logExposedArea_age_decay")$ROI), mean)

lm_diagnostic_Agedecay_lobe %>% kable(digits = 2) %>% kable_styling()

ggplot(data = filter(dados_lobos_v1, Diagnostic == "CTL"), aes(logExposedArea_age_decay, 1/2 * logAvgThickness_age_decay + logTotalArea_age_decay, color = ROI, fill = ROI)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  geom_abline(slope = filter(lm_diagnostic_Agedecay_lobe, term == "logExposedArea_age_decay", Diagnostic == "CTL", ROI == "hemisphere")$estimate, linetype = "dashed", intercept = filter(lm_diagnostic_Agedecay_lobe, term == "(Intercept)", Diagnostic == "CTL", ROI == "hemisphere")$estimate) +
  stat_regline_equation() + 
  theme_pubr()

ggplot(data = dados_lobos_v1, aes(logExposedArea_age_decay, 1/2 * logAvgThickness_age_decay + logTotalArea_age_decay, color = Diagnostic, fill = Diagnostic)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  geom_abline(slope = filter(lm_diagnostic_Agedecay_lobe, term == "logExposedArea_age_decay", Diagnostic == "CTL", ROI == "hemisphere")$estimate, linetype = "dashed", intercept = filter(lm_diagnostic_Agedecay_lobe, term == "(Intercept)", Diagnostic == "CTL", ROI == "hemisphere")$estimate) +
  stat_regline_equation() + 
  theme_pubr() + facet_wrap(ROI ~. )

ggplot(
  data = filter(lm_diagnostic_Agedecay_lobe, term == "logExposedArea_age_decay"),
  aes(
  x = reorder(Diagnostic, estimate),
  y = estimate,
  color = Diagnostic
  )
  ) +
  geom_point() +
  geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error)) +
  geom_hline(yintercept = 1.25, linetype = "dashed") +
  stat_compare_means(method = "kruskal.test") + 
  theme_pubr() +
  labs(y = "slope") +
  facet_wrap(ROI ~. )

ggplot(data = filter(dados_lobos_v1, Diagnostic == "CTL"), aes(Age, K_corrected, alpha = 0.4)) +
  geom_smooth(se = TRUE) +
  stat_regline_equation() +
  theme_pubr() + facet_wrap(ROI ~ . )

ggplot(data = filter(dados_lobos_v1, Diagnostic == "CTL"), aes(Age, K_age_decay, alpha = 0.4)) +
  geom_smooth(se = TRUE) +
  stat_regline_equation() +
  theme_pubr() + facet_wrap(ROI ~ . )

ggplot(data = dados_lobos_v1, aes(Age, K_age_decay, color = Diagnostic, fill = Diagnostic)) +
  stat_regline_equation() +
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + facet_wrap(ROI ~ . ) + labs(y = "K (After age correction)")

ggplot(dados_lobos_v1, aes(x = Diagnostic, y = K_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_boxplot() +
 stat_compare_means(method = "anova") + theme_pubr() + facet_wrap(ROI ~ . )

```

### Comparing Anovas - diff and p-values

```{r eval=FALSE, include=FALSE}
### K -----

dados_aov <- dados %>% dplyr::select(c(Diagnostic, ROI, K, K_age_decay, logAvgThickness, logAvgThickness_age_decay)) %>%  pivot_longer(
   cols = K:logAvgThickness_age_decay ,
   names_to = "measure",
   values_to = "value"
 ) %>% mutate(agecorrection = ifelse(measure == "K_age_decay"|measure == "logAvgThickness_age_decay" , "yes", "no"))

dados_aov$measure[dados_aov$measure == "K_age_decay"] <- "K"
dados_aov$measure[dados_aov$measure == "logAvgThickness_age_decay"] <- "logAvgThickness"


a <- aov(value ~ measure*agecorrection*Diagnostic*ROI, data = dados_aov)
summary(a)
a.TukeyHSD <- as.data.frame(TukeyHSD(a)$`measure:agecorrection:Diagnostic:ROI`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a)$`measure:agecorrection:Diagnostic:ROI`))
a.TukeyHSD <- as_tibble(cbind(Contrasts, a.TukeyHSD))
rownames(a.TukeyHSD) <- NULL
colnames(a.TukeyHSD)[1] <- c("Contrast")
a.TukeyHSD <- a.TukeyHSD %>%
  mutate(Contrast1 = str_split(a.TukeyHSD$Contrast, pattern = "-", simplify = TRUE)[,1],
         Contrast2 = str_split(a.TukeyHSD$Contrast, pattern = "-", simplify = TRUE)[,2])
a.TukeyHSD <- a.TukeyHSD %>%
  mutate(measure.1 = str_split(a.TukeyHSD$Contrast1, pattern = ":", simplify = TRUE)[,1],
         measure.2 = str_split(a.TukeyHSD$Contrast2, pattern = ":", simplify = TRUE)[,1],
         agecorrection.1 = str_split(a.TukeyHSD$Contrast1, pattern = ":", simplify = TRUE)[,2],
         agecorrection.2 = str_split(a.TukeyHSD$Contrast2, pattern = ":", simplify = TRUE)[,2],
         Diagnostic.1 = str_split(a.TukeyHSD$Contrast1, pattern = ":", simplify = TRUE)[,3],
         Diagnostic.2 = str_split(a.TukeyHSD$Contrast2, pattern = ":", simplify = TRUE)[,3],
         ROI.1 = str_split(a.TukeyHSD$Contrast1, pattern = ":", simplify = TRUE)[,4],
         ROI.2 = str_split(a.TukeyHSD$Contrast2, pattern = ":", simplify = TRUE)[,4],
         Contrast = str_c(Diagnostic.1, Diagnostic.2, sep="-")) %>% filter(ROI.1 == ROI.2, measure.1 == measure.2, agecorrection.1 == agecorrection.2) %>% dplyr::select(-c(Contrast1 , Contrast2))

agecorrection <- c(
   "no" = "No age correction",
    "yes" = "After age correction"
)

ggplot(data = filter(a.TukeyHSD, `p adj` < 0.05 | `p adj` == 0.05), aes(
    x = reorder(ROI.1, desc(ROI.1)),
    y = diff,
    ymin = lwr,
    ymax = upr, color = Contrast)) +
    geom_hline(yintercept = 0,
               linetype = "11",
               colour = "grey60") +
    geom_pointrange( position = position_dodge(width = 0.2)) +
#  geom_text(aes(label = str_c("p adj = ", signif(`p adj`, digits = 2))), nudge_x = 0.3) +
    coord_flip() + 
    labs(y =  "Differences in mean levels of Diagnostic", x = "ROI") + facet_grid(measure.1 ~ agecorrection.1, labeller = labeller(agecorrection.1 = agecorrection)) +
  theme_pubr() + 
  theme(axis.title = element_text(size = 11),
    axis.text = element_text(size = 10), text = element_text(size = 10))
```

```{r}
# K ----

dados_hemi_v1 %>%
  group_by(Diagnostic) %>%
  summarise(N_SUBJ = n_distinct(SUBJ))

dados_lobos_v1 %>%
  group_by(Diagnostic) %>%
  summarise(N_SUBJ = n_distinct(SUBJ))

a <- aov(K ~ Diagnostic, data = dados_hemi_v1)
summary(a)
TukeyHSD(a)
a.TukeyHSD <- as.data.frame(TukeyHSD(a)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a)$`Diagnostic`))
a.TukeyHSD <- as_tibble(cbind(Contrasts, a.TukeyHSD))
rownames(a.TukeyHSD) <- NULL
colnames(a.TukeyHSD)[1] <- c("Contrast")
a.TukeyHSD <- a.TukeyHSD %>% mutate(ROI = "Hemisphere", variable = "K", agecorrection = "no")

a.F <- aov(K ~ Diagnostic, data = filter(dados_lobos_v1, ROI == "F"))
summary(a.F)
TukeyHSD(a.F)
a.F.TukeyHSD <- as.data.frame(TukeyHSD(a.F)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a.F)$`Diagnostic`))
a.F.TukeyHSD <- as_tibble(cbind(Contrasts, a.F.TukeyHSD))
rownames(a.F.TukeyHSD) <- NULL
colnames(a.F.TukeyHSD)[1] <- c("Contrast")
a.F.TukeyHSD <- a.F.TukeyHSD %>% mutate(ROI = "Frontal Lobe", variable = "K", agecorrection = "no")

a.O <- aov(K ~ Diagnostic, data = filter(dados_lobos_v1, ROI == "O"))
summary(a.O)
TukeyHSD(a.O)
a.O.TukeyHSD <- as.data.frame(TukeyHSD(a.O)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a.O)$`Diagnostic`))
a.O.TukeyHSD <- as_tibble(cbind(Contrasts, a.O.TukeyHSD))
rownames(a.O.TukeyHSD) <- NULL
colnames(a.O.TukeyHSD)[1] <- c("Contrast")
a.O.TukeyHSD <-a.O.TukeyHSD %>% mutate(ROI = "Occipital Lobe", variable = "K", agecorrection = "no")

a.P <- aov(K ~ Diagnostic, data = filter(dados_lobos_v1, ROI == "P"))
summary(a.P)
TukeyHSD(a.P)
a.P.TukeyHSD <- as.data.frame(TukeyHSD(a.P)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a.P)$`Diagnostic`))
a.P.TukeyHSD <- as_tibble(cbind(Contrasts, a.P.TukeyHSD))
rownames(a.P.TukeyHSD) <- NULL
colnames(a.P.TukeyHSD)[1] <- c("Contrast")
a.P.TukeyHSD <- a.P.TukeyHSD %>% mutate(ROI = "Parietal Lobe", variable = "K", agecorrection = "no")

a.T <- aov(K ~ Diagnostic, data = filter(dados_lobos_v1, ROI == "T"))
summary(a.T)
TukeyHSD(a.T)
a.T.TukeyHSD <- as.data.frame(TukeyHSD(a.T)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a.T)$`Diagnostic`))
a.T.TukeyHSD <- as_tibble(cbind(Contrasts, a.T.TukeyHSD))
rownames(a.T.TukeyHSD) <- NULL
colnames(a.T.TukeyHSD)[1] <- c("Contrast")
a.T.TukeyHSD <- a.T.TukeyHSD %>% mutate(ROI = "Temporal Lobe", variable = "K", agecorrection = "no")

aov_summary <- full_join(a.TukeyHSD, a.F.TukeyHSD) %>% full_join(a.O.TukeyHSD) %>% full_join(a.P.TukeyHSD) %>% full_join(a.T.TukeyHSD)

# K  age decay ----

a <- aov(K_age_decay ~ Diagnostic, data = dados_hemi_v1)
summary(a)
TukeyHSD(a)
a.TukeyHSD <- as.data.frame(TukeyHSD(a)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a)$`Diagnostic`))
a.TukeyHSD <- as_tibble(cbind(Contrasts, a.TukeyHSD))
rownames(a.TukeyHSD) <- NULL
colnames(a.TukeyHSD)[1] <- c("Contrast")
a.TukeyHSD <- a.TukeyHSD %>% mutate(ROI = "Hemisphere", variable = "K", agecorrection = "yes")

a.F <- aov(K_age_decay ~ Diagnostic, data = filter(dados_lobos_v1, ROI == "F"))
summary(a.F)
TukeyHSD(a.F)
a.F.TukeyHSD <- as.data.frame(TukeyHSD(a.F)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a.F)$`Diagnostic`))
a.F.TukeyHSD <- as_tibble(cbind(Contrasts, a.F.TukeyHSD))
rownames(a.F.TukeyHSD) <- NULL
colnames(a.F.TukeyHSD)[1] <- c("Contrast")
a.F.TukeyHSD <- a.F.TukeyHSD %>% mutate(ROI = "Frontal Lobe", variable = "K", agecorrection = "yes")

a.O <- aov(K_age_decay ~ Diagnostic, data = filter(dados_lobos_v1, ROI == "O"))
summary(a.O)
TukeyHSD(a.O)
a.O.TukeyHSD <- as.data.frame(TukeyHSD(a.O)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a.O)$`Diagnostic`))
a.O.TukeyHSD <- as_tibble(cbind(Contrasts, a.O.TukeyHSD))
rownames(a.O.TukeyHSD) <- NULL
colnames(a.O.TukeyHSD)[1] <- c("Contrast")
a.O.TukeyHSD <-a.O.TukeyHSD %>% mutate(ROI = "Occipital Lobe", variable = "K", agecorrection = "yes")

a.P <- aov(K_age_decay ~ Diagnostic, data = filter(dados_lobos_v1, ROI == "P"))
summary(a.P)
TukeyHSD(a.P)
a.P.TukeyHSD <- as.data.frame(TukeyHSD(a.P)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a.P)$`Diagnostic`))
a.P.TukeyHSD <- as_tibble(cbind(Contrasts, a.P.TukeyHSD))
rownames(a.P.TukeyHSD) <- NULL
colnames(a.P.TukeyHSD)[1] <- c("Contrast")
a.P.TukeyHSD <- a.P.TukeyHSD %>% mutate(ROI = "Parietal Lobe", variable = "K", agecorrection = "yes")

a.T <- aov(K_age_decay ~ Diagnostic, data = filter(dados_lobos_v1, ROI == "T"))
summary(a.T)
TukeyHSD(a.T)
a.T.TukeyHSD <- as.data.frame(TukeyHSD(a.T)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a.T)$`Diagnostic`))
a.T.TukeyHSD <- as_tibble(cbind(Contrasts, a.T.TukeyHSD))
rownames(a.T.TukeyHSD) <- NULL
colnames(a.T.TukeyHSD)[1] <- c("Contrast")
a.T.TukeyHSD <- a.T.TukeyHSD %>% mutate(ROI = "Temporal Lobe", variable = "K", agecorrection = "yes")

aov_summary <- full_join(aov_summary, a.TukeyHSD) %>% full_join(a.F.TukeyHSD) %>% full_join(a.O.TukeyHSD) %>% full_join(a.P.TukeyHSD) %>% full_join(a.T.TukeyHSD)

# logAvgThickness ----

a <- aov(logAvgThickness ~ Diagnostic, data = dados_hemi_v1)
summary(a)
a.TukeyHSD <- as.data.frame(TukeyHSD(a)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a)$`Diagnostic`))
a.TukeyHSD <- as_tibble(cbind(Contrasts, a.TukeyHSD))
rownames(a.TukeyHSD) <- NULL
colnames(a.TukeyHSD)[1] <- c("Contrast")
a.TukeyHSD <- a.TukeyHSD %>% mutate(ROI = "Hemisphere", variable = "T", agecorrection = "no")

a.F <- aov(logAvgThickness ~ Diagnostic, data = filter(dados_lobos_v1, ROI == "F"))
summary(a.F)
a.F.TukeyHSD <- as.data.frame(TukeyHSD(a.F)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a.F)$`Diagnostic`))
a.F.TukeyHSD <- as_tibble(cbind(Contrasts, a.F.TukeyHSD))
rownames(a.F.TukeyHSD) <- NULL
colnames(a.F.TukeyHSD)[1] <- c("Contrast")
a.F.TukeyHSD <- a.F.TukeyHSD %>% mutate(ROI = "Frontal Lobe", variable = "T", agecorrection = "no")

a.O <- aov(logAvgThickness ~ Diagnostic, data = filter(dados_lobos_v1, ROI == "O"))
summary(a.O)
a.O.TukeyHSD <- as.data.frame(TukeyHSD(a.O)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a.O)$`Diagnostic`))
a.O.TukeyHSD <- as_tibble(cbind(Contrasts, a.O.TukeyHSD))
rownames(a.O.TukeyHSD) <- NULL
colnames(a.O.TukeyHSD)[1] <- c("Contrast")
a.O.TukeyHSD <-a.O.TukeyHSD %>% mutate(ROI = "Occipital Lobe", variable = "T", agecorrection = "no")

a.P <- aov(logAvgThickness ~ Diagnostic, data = filter(dados_lobos_v1, ROI == "P"))
summary(a.P)
a.P.TukeyHSD <- as.data.frame(TukeyHSD(a.P)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a.P)$`Diagnostic`))
a.P.TukeyHSD <- as_tibble(cbind(Contrasts, a.P.TukeyHSD))
rownames(a.P.TukeyHSD) <- NULL
colnames(a.P.TukeyHSD)[1] <- c("Contrast")
a.P.TukeyHSD <- a.P.TukeyHSD %>% mutate(ROI = "Parietal Lobe", variable = "T", agecorrection = "no")

a.T <- aov(logAvgThickness ~ Diagnostic, data = filter(dados_lobos_v1, ROI == "T"))
summary(a.T)
a.T.TukeyHSD <- as.data.frame(TukeyHSD(a.T)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a.T)$`Diagnostic`))
a.T.TukeyHSD <- as_tibble(cbind(Contrasts, a.T.TukeyHSD))
rownames(a.T.TukeyHSD) <- NULL
colnames(a.T.TukeyHSD)[1] <- c("Contrast")
a.T.TukeyHSD <- a.T.TukeyHSD %>% mutate(ROI = "Temporal Lobe", variable = "T", agecorrection = "no")

aov_summary <- full_join(aov_summary, a.TukeyHSD) %>% full_join(a.F.TukeyHSD) %>% full_join(a.O.TukeyHSD) %>% full_join(a.P.TukeyHSD) %>% full_join(a.T.TukeyHSD)

# logAvgThickness  age decay ----

a <- aov(logAvgThickness_age_decay ~ Diagnostic, data = dados_hemi_v1)
summary(a)
a.TukeyHSD <- as.data.frame(TukeyHSD(a)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a)$`Diagnostic`))
a.TukeyHSD <- as_tibble(cbind(Contrasts, a.TukeyHSD))
rownames(a.TukeyHSD) <- NULL
colnames(a.TukeyHSD)[1] <- c("Contrast")
a.TukeyHSD <- a.TukeyHSD %>% mutate(ROI = "Hemisphere", variable = "T", agecorrection = "yes")

a.F <- aov(logAvgThickness_age_decay ~ Diagnostic, data = filter(dados_lobos_v1, ROI == "F"))
summary(a.F)
a.F.TukeyHSD <- as.data.frame(TukeyHSD(a.F)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a.F)$`Diagnostic`))
a.F.TukeyHSD <- as_tibble(cbind(Contrasts, a.F.TukeyHSD))
rownames(a.F.TukeyHSD) <- NULL
colnames(a.F.TukeyHSD)[1] <- c("Contrast")
a.F.TukeyHSD <- a.F.TukeyHSD %>% mutate(ROI = "Frontal Lobe", variable = "T", agecorrection = "yes")

a.O <- aov(logAvgThickness_age_decay ~ Diagnostic, data = filter(dados_lobos_v1, ROI == "O"))
summary(a.O)
a.O.TukeyHSD <- as.data.frame(TukeyHSD(a.O)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a.O)$`Diagnostic`))
a.O.TukeyHSD <- as_tibble(cbind(Contrasts, a.O.TukeyHSD))
rownames(a.O.TukeyHSD) <- NULL
colnames(a.O.TukeyHSD)[1] <- c("Contrast")
a.O.TukeyHSD <-a.O.TukeyHSD %>% mutate(ROI = "Occipital Lobe", variable = "T", agecorrection = "yes")

a.P <- aov(logAvgThickness_age_decay ~ Diagnostic, data = filter(dados_lobos_v1, ROI == "P"))
summary(a.P)
a.P.TukeyHSD <- as.data.frame(TukeyHSD(a.P)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a.P)$`Diagnostic`))
a.P.TukeyHSD <- as_tibble(cbind(Contrasts, a.P.TukeyHSD))
rownames(a.P.TukeyHSD) <- NULL
colnames(a.P.TukeyHSD)[1] <- c("Contrast")
a.P.TukeyHSD <- a.P.TukeyHSD %>% mutate(ROI = "Parietal Lobe", variable = "T", agecorrection = "yes")

a.T <- aov(logAvgThickness_age_decay ~ Diagnostic, data = filter(dados_lobos_v1, ROI == "T"))
summary(a.T)
a.T.TukeyHSD <- as.data.frame(TukeyHSD(a.T)$`Diagnostic`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a.T)$`Diagnostic`))
a.T.TukeyHSD <- as_tibble(cbind(Contrasts, a.T.TukeyHSD))
rownames(a.T.TukeyHSD) <- NULL
colnames(a.T.TukeyHSD)[1] <- c("Contrast")
a.T.TukeyHSD <- a.T.TukeyHSD %>% mutate(ROI = "Temporal Lobe", variable = "T", agecorrection = "yes")

# ----
aov_summary <- full_join(aov_summary, a.TukeyHSD) %>% full_join(a.F.TukeyHSD) %>% full_join(a.O.TukeyHSD) %>% full_join(a.P.TukeyHSD) %>% full_join(a.T.TukeyHSD)

agecorrection <- c(
  "no" = "No age correction",
  "yes" = "After age correction"
)

figs1 <- ggplot(data = filter(aov_summary, `p adj` < 0.05 | `p adj` == 0.05), aes(
  x = reorder(ROI, desc(ROI)),
  y = diff,
  ymin = lwr,
  ymax = upr, color = Contrast)) +
  geom_hline(yintercept = 0,
             linetype = "11",
             colour = "grey60") +
  geom_pointrange( position = position_dodge(width = 0.3)) +
  #  geom_text(aes(label = str_c("p adj = ", signif(`p adj`, digits = 2))), nudge_x = 0.3) +
  coord_flip() + 
  labs(y =  "Differences in mean levels of Diagnostic", x = "ROI") + facet_grid(variable ~ agecorrection, labeller = labeller(agecorrection.1 = agecorrection)) +
  theme_pubr() + 
  theme(axis.title = element_text(size = 11),
        axis.text = element_text(size = 10), text = element_text(size = 10))

ggsave("figs1.pdf", plot = figs1, dpi=1200, width = 15, height = 11, units = "cm", device = "pdf")
ggsave("figs1.jpeg", plot = figs1, dpi=1200, width = 15, height = 11, units = "cm", device = "jpeg")

aov_summary[order(aov_summary$diff, decreasing = TRUE),]

# aov_summary <- aov_summary %>% mutate(p.adjust.bonferroni = p.adjust(`p adj`, method = "bonferroni")
```


##### Diferenca por idade ---

```{r}
b <- lm(K ~ Age * ROI * Diagnostic, data = dados)
summary(b)
anova(b)

e <- allEffects(b)
e <- as.data.frame(e[[1]])
ggplot(e, aes(x = Age, y = fit, color = Diagnostic,ymin=lower,ymax=upper)) + geom_pointrange() + geom_line() + theme_pubr() + facet_wrap(ROI ~. ) + labs(y = "K")
```

```{r}
NSUBJ <- dados %>% group_by(Diagnostic, ROI, Age_interval10) %>% summarise(N = n_distinct(SUBJ))

a <- aov(K ~ Diagnostic*ROI*Age_interval10, data = dados)
a
summary(a)
a.TukeyHSD <- as.data.frame(TukeyHSD(a)$`Diagnostic:ROI:Age_interval10`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a)$`Diagnostic:ROI:Age_interval10`))
a.TukeyHSD <- as_tibble(cbind(Contrasts, a.TukeyHSD))
rownames(a.TukeyHSD) <- NULL
colnames(a.TukeyHSD)[1] <- c("Contrast")
a.TukeyHSD <- a.TukeyHSD %>%
  mutate(Contrast1 = str_split(a.TukeyHSD$Contrast, pattern = "-", simplify = TRUE)[,1], Contrast2 = str_split(a.TukeyHSD$Contrast, pattern = "-", simplify = TRUE)[,2])
a.TukeyHSD <- a.TukeyHSD%>%
  mutate(Diagnostic.1 = str_split(a.TukeyHSD$Contrast1, pattern = ":", simplify = TRUE)[,1], Diagnostic.2 = str_split(a.TukeyHSD$Contrast2, pattern = ":", simplify = TRUE)[,1], ROI.1 = str_split(a.TukeyHSD$Contrast1, pattern = ":", simplify = TRUE)[,2], ROI.2 = str_split(a.TukeyHSD$Contrast2, pattern = ":", simplify = TRUE)[,2], Age.1 = str_split(a.TukeyHSD$Contrast1, pattern = ":", simplify = TRUE)[,3], Age.2 = str_split(a.TukeyHSD$Contrast2, pattern = ":", simplify = TRUE)[,3], Contrasts = str_c(Diagnostic.1,Diagnostic.2, sep = "-")) %>% filter(ROI.1 == ROI.2 & Age.1 == Age.2) %>% dplyr::select(-c(Contrast1 , Contrast2))

a.TukeyHSD$ROI.1 <- as.factor(a.TukeyHSD$ROI.1)
a.TukeyHSD$ROI.1 <- relevel(a.TukeyHSD$ROI.1, ref = "hemisphere")

figs2a <- ggplot(data = a.TukeyHSD, aes(
    x = Age.1,
    y = diff,
    ymin = lwr,
    ymax = upr, color = ROI.1)) +
    geom_hline(yintercept = 0,
               linetype = "11",
               colour = "grey60") +
    geom_pointrange() + geom_line(aes(group=ROI.1)) + facet_wrap(Contrasts ~ .) +
    labs(y =  "Differences in mean levels of Diagnostic", x = "Age [years]", color = "ROI") +
    theme_pubr() +
  theme(axis.title = element_text(size = 11),
    axis.text = element_text(size = 10), text = element_text(size = 10))


a <- aov(K_age_decay ~ Diagnostic*ROI*Age_interval10, data = dados)
a
summary(a)
a.TukeyHSD <- as.data.frame(TukeyHSD(a)$`Diagnostic:ROI:Age_interval10`)
Contrasts <- as.data.frame(rownames(TukeyHSD(a)$`Diagnostic:ROI:Age_interval10`))
a.TukeyHSD <- as_tibble(cbind(Contrasts, a.TukeyHSD))
rownames(a.TukeyHSD) <- NULL
colnames(a.TukeyHSD)[1] <- c("Contrast")
a.TukeyHSD <- a.TukeyHSD %>%
  mutate(Contrast1 = str_split(a.TukeyHSD$Contrast, pattern = "-", simplify = TRUE)[,1], Contrast2 = str_split(a.TukeyHSD$Contrast, pattern = "-", simplify = TRUE)[,2])
a.TukeyHSD <- a.TukeyHSD%>%
  mutate(Diagnostic.1 = str_split(a.TukeyHSD$Contrast1, pattern = ":", simplify = TRUE)[,1], Diagnostic.2 = str_split(a.TukeyHSD$Contrast2, pattern = ":", simplify = TRUE)[,1], ROI.1 = str_split(a.TukeyHSD$Contrast1, pattern = ":", simplify = TRUE)[,2], ROI.2 = str_split(a.TukeyHSD$Contrast2, pattern = ":", simplify = TRUE)[,2], Age.1 = str_split(a.TukeyHSD$Contrast1, pattern = ":", simplify = TRUE)[,3], Age.2 = str_split(a.TukeyHSD$Contrast2, pattern = ":", simplify = TRUE)[,3], Contrasts = str_c(Diagnostic.1,Diagnostic.2, sep = "-")) %>% filter(ROI.1 == ROI.2 & Age.1 == Age.2) %>% dplyr::select(-c(Contrast1 , Contrast2))

a.TukeyHSD$ROI.1 <- as.factor(a.TukeyHSD$ROI.1)
a.TukeyHSD$ROI.1 <- relevel(a.TukeyHSD$ROI.1, ref = "hemisphere")

figs2b <- ggplot(data = a.TukeyHSD, aes(
    x = Age.1,
    y = diff,
    ymin = lwr,
    ymax = upr, color = ROI.1)) +
    geom_hline(yintercept = 0,
               linetype = "11",
               colour = "grey60") +
    geom_pointrange() + geom_line(aes(group=ROI.1)) + facet_wrap(Contrasts ~ .) +
    labs(y =  "Differences in mean levels of Diagnostic", x = "Age [years]", color = "ROI") +
    theme_pubr() +
  theme(axis.title = element_text(size = 11),
    axis.text = element_text(size = 10), text = element_text(size = 10))

figs2 <- ggarrange(figs2a, figs2b, labels = c("A", "B"), common.legend = TRUE, legend = "top", nrow = 2, ncol = 1, font.label = list(size = 11))

ggsave("figs2.pdf", plot = figs2, dpi=1200, width = 18, height = 22, units = "cm", device = "pdf")
ggsave("figs2.jpeg", plot = figs2, dpi=1200, width = 18, height = 22, units = "cm", device = "jpeg")
```

#### Comparing DA and CTL through age

```{r}
aov_diag_age <- aov(K ~ Diagnostic*Age_interval10, data = dados_hemi_v1)
summary(aov_diag_age)
a <- TukeyHSD(aov_diag_age) 
a <- as.data.frame(a$`Diagnostic:Age_interval10`)
a %>% filter(`p adj` < 0.05 |`p adj` == 0.05 )



aov_diag_age <- aov(K_age_decay ~ Diagnostic*Age_interval10, data = dados_hemi_v1)
summary(aov_diag_age)
a <- TukeyHSD(aov_diag_age) 
a <- as.data.frame(a$`Diagnostic:Age_interval10`)
a %>% filter(`p adj` < 0.05 |`p adj` == 0.05 )

```


### S and I - AD and CTL


```{r K I S}
mean_K_I_S <-
  dados_hemi_v1 %>% group_by(Diagnostic) %>% summarise(
    mean.K = mean(K, na.rm = TRUE),
    SD_K = sd(K, na.rm = TRUE),
    mean.I = mean(I, na.rm = TRUE),
    SD_I = sd(I, na.rm = TRUE),
    mean.S = mean(S, na.rm = TRUE),
    SD_S = sd(S, na.rm = TRUE),
    mean.K_age_decay = mean(K_age_decay, na.rm = TRUE),
    SD_K_age_decay = sd(K_age_decay, na.rm = TRUE),
    mean.I_age_decay = mean(I_age_decay, na.rm = TRUE),
    SD_I_age_decay = sd(I_age_decay, na.rm = TRUE),
    mean.S_age_decay = mean(S_age_decay, na.rm = TRUE),
    SD_S_age_decay = sd(S_age_decay, na.rm = TRUE),
    N_SUBJ = n_distinct(SUBJ)
    )

mean_K_I_S_lobes <-
  dados_lobos_v1 %>% group_by(ROI, Diagnostic) %>% summarise(
    mean.K = mean(K, na.rm = TRUE),
    SD_K = sd(K, na.rm = TRUE),
    mean.I = mean(I, na.rm = TRUE),
    SD_I = sd(I, na.rm = TRUE),
    mean.S = mean(S, na.rm = TRUE),
    SD_S = sd(S, na.rm = TRUE),
    mean.K_age_decay = mean(K_age_decay, na.rm = TRUE),
    SD_K_age_decay = sd(K_age_decay, na.rm = TRUE),
    mean.I_age_decay = mean(I_age_decay, na.rm = TRUE),
    SD_I_age_decay = sd(I_age_decay, na.rm = TRUE),
    mean.S_age_decay = mean(S_age_decay, na.rm = TRUE),
    SD_S_age_decay = sd(S_age_decay, na.rm = TRUE),
    N_SUBJ = n_distinct(SUBJ)
    )

mean_K_I_S_zscore <- mean_K_I_S %>%
mutate(
    mean.K = (mean.K-mean.K[Diagnostic=="CTL"])/SD_K[Diagnostic=="CTL"],
    mean.I = (mean.I-mean.I[Diagnostic=="CTL"])/SD_I[Diagnostic=="CTL"],
    mean.S = (mean.S-mean.S[Diagnostic=="CTL"])/SD_S[Diagnostic=="CTL"],
    mean.K_age_decay = (mean.K_age_decay -mean.K_age_decay[Diagnostic=="CTL"])/SD_K_age_decay[Diagnostic=="CTL"],
    mean.I_age_decay = (mean.I_age_decay -mean.I_age_decay[Diagnostic=="CTL"])/SD_I_age_decay[Diagnostic=="CTL"],
    mean.S_age_decay = (mean.S_age_decay -mean.S_age_decay[Diagnostic=="CTL"])/SD_S_age_decay[Diagnostic=="CTL"]
  )

mean_K_I_S_lobes_zscore <- mean_K_I_S_lobes  %>%
mutate(
    mean.K = (mean.K-mean.K[Diagnostic=="CTL"])/SD_K[Diagnostic=="CTL"],
    mean.I = (mean.I-mean.I[Diagnostic=="CTL"])/SD_I[Diagnostic=="CTL"],
    mean.S = (mean.S-mean.S[Diagnostic=="CTL"])/SD_S[Diagnostic=="CTL"],
    mean.K_age_decay = (mean.K_age_decay -mean.K_age_decay[Diagnostic=="CTL"])/SD_K_age_decay[Diagnostic=="CTL"],
    mean.I_age_decay = (mean.I_age_decay -mean.I_age_decay[Diagnostic=="CTL"])/SD_I_age_decay[Diagnostic=="CTL"],
    mean.S_age_decay = (mean.S_age_decay -mean.S_age_decay[Diagnostic=="CTL"])/SD_S_age_decay[Diagnostic=="CTL"]
  )

fig3a <- ggplot(mean_K_I_S_zscore, aes(x = mean.K, y = mean.S, color = Diagnostic)) +
  geom_point() +
  geom_line(group =1, color = "gray") +
  theme_pubr() +
  labs(x = "Mean K (z-score)", y = "Mean S (z-score)") + 
  theme(axis.title = element_text(size = 11),
    axis.text = element_text(size = 10), text = element_text(size = 10))


fig3c <- ggplot(mean_K_I_S_zscore, aes(x = mean.K, y = mean.I, color = Diagnostic)) +
  geom_point() +
  geom_line(group =1, color = "gray") +
  theme_pubr() +
  labs(x = "Mean K (z-score)", y = "Mean I (z-score)") +
  theme(axis.title = element_text(size = 11),
    axis.text = element_text(size = 10), text = element_text(size = 10))


lobes <- c(
    F = "Frontal Lobe",
    O = "Occipital Lobe",
    P = "Parietal Lobe",
    T = "Temporal Lobe"
)

fig3a.lobes <- ggplot(mean_K_I_S_lobes_zscore, aes(x = mean.K, y = mean.S, color = Diagnostic)) +
  geom_point() +
  geom_line(group =1, color = "gray") +
  theme_pubr() +
  labs(x = "Mean K (z-score)", y = "Mean S (z-score)") +
  facet_wrap(ROI ~ ., ncol=2, nrow=2, labeller = labeller(ROI =lobes)) +
  theme(axis.title = element_text(size = 11),
    axis.text = element_text(size = 10), text = element_text(size = 10))

fig3.withlobes <- ggarrange(fig3a, fig3a.lobes, labels = c("A", "B"), common.legend = TRUE, legend = "top", nrow = 1, ncol = 2, font.label = list(size = 11))

#ggsave("fig3.pdf", plot = fig3, dpi=1200, width = 11, height = 11, units = "cm", device = "pdf")
 
dados_hemi_v1_DACTL <- dados_hemi_v1 %>%
  mutate(Age.group = ifelse(
    Age > 75,
    "76-86",
    ifelse((Age < 75 | Age == 75 & Age > 65 | Age == 65),
           "66-75",
           "")))

mean_K_I_S_ADCTL <-
  filter(dados_hemi_v1_DACTL) %>% group_by(Diagnostic, Age.group) %>% summarise(
    mean.T = mean(logAvgThickness, na.rm = TRUE),
    SD_T = sd(logAvgThickness, na.rm = TRUE),
    mean.K = mean(K, na.rm = TRUE),
    SD_K = sd(K, na.rm = TRUE),
    mean.I = mean(I, na.rm = TRUE),
    SD_I = sd(I, na.rm = TRUE),
    mean.S = mean(S, na.rm = TRUE),
    SD_S = sd(S, na.rm = TRUE),
    mean.T_age_decay = mean(logAvgThickness_age_decay, na.rm = TRUE),
    SD_T_age_decay = sd(logAvgThickness_age_decay, na.rm = TRUE),
    mean.K_age_decay = mean(K_age_decay, na.rm = TRUE),
    SD_K_age_decay = sd(K_age_decay, na.rm = TRUE),
    mean.I_age_decay = mean(I_age_decay, na.rm = TRUE),
    SD_I_age_decay = sd(I_age_decay, na.rm = TRUE),
    mean.S_age_decay = mean(S_age_decay, na.rm = TRUE),
    SD_S_age_decay = sd(S_age_decay, na.rm = TRUE),
    N_SUBJ = n_distinct(SUBJ)
  )

mean_K_I_S_age_zscore <- mean_K_I_S_ADCTL %>%
  mutate(
    mean.T = (mean.T - mean_K_I_S_ADCTL$mean.T[mean_K_I_S_ADCTL$Diagnostic == "CTL" &
                                                 mean_K_I_S_ADCTL$Age.group == "66-75"]) / mean_K_I_S_ADCTL$SD_T[mean_K_I_S_ADCTL$Diagnostic == "CTL" &
                                                 mean_K_I_S_ADCTL$Age.group == "66-75"],
    mean.K = (mean.K - mean_K_I_S_ADCTL$mean.K[mean_K_I_S_ADCTL$Diagnostic == "CTL" &
                                                 mean_K_I_S_ADCTL$Age.group == "66-75"]) / mean_K_I_S_ADCTL$SD_K[mean_K_I_S_ADCTL$Diagnostic == "CTL" &
                                                 mean_K_I_S_ADCTL$Age.group == "66-75"],
    mean.I = (mean.I - mean_K_I_S_ADCTL$mean.I[mean_K_I_S_ADCTL$Diagnostic == "CTL" &
                                                 mean_K_I_S_ADCTL$Age.group == "66-75"]) / mean_K_I_S_ADCTL$SD_I[mean_K_I_S_ADCTL$Diagnostic == "CTL" &
                                                 mean_K_I_S_ADCTL$Age.group == "66-75"],
    mean.S = (mean.S - mean_K_I_S_ADCTL$mean.S[mean_K_I_S_ADCTL$Diagnostic == "CTL" &
                                                 mean_K_I_S_ADCTL$Age.group == "66-75"]) / mean_K_I_S_ADCTL$SD_S[mean_K_I_S_ADCTL$Diagnostic == "CTL" &
                                                 mean_K_I_S_ADCTL$Age.group == "66-75"],
    mean.K_age_decay = (mean.K_age_decay - mean_K_I_S_ADCTL$mean.K_age_decay[mean_K_I_S_ADCTL$Diagnostic == "CTL" &
                                                 mean_K_I_S_ADCTL$Age.group == "66-75"]) / mean_K_I_S_ADCTL$SD_K_age_decay[mean_K_I_S_ADCTL$Diagnostic == "CTL" &
                                                 mean_K_I_S_ADCTL$Age.group == "66-75"],
    mean.I_age_decay = (mean.I_age_decay - mean_K_I_S_ADCTL$mean.I_age_decay[mean_K_I_S_ADCTL$Diagnostic == "CTL" &
                                                 mean_K_I_S_ADCTL$Age.group == "66-75"]) / mean_K_I_S_ADCTL$SD_I_age_decay[mean_K_I_S_ADCTL$Diagnostic == "CTL" &
                                                 mean_K_I_S_ADCTL$Age.group == "66-75"],
    mean.S_age_decay = (mean.S_age_decay - mean_K_I_S_ADCTL$mean.S_age_decay[mean_K_I_S_ADCTL$Diagnostic == "CTL" &
                                                 mean_K_I_S_ADCTL$Age.group == "66-75"]) / mean_K_I_S_ADCTL$SD_S_age_decay[mean_K_I_S_ADCTL$Diagnostic == "CTL" &
                                                 mean_K_I_S_ADCTL$Age.group == "66-75"],
    N_SUBJ = N_SUBJ
  )

fig3b <- ggplot(mean_K_I_S_age_zscore, aes(x = mean.K, y = mean.S, color = Diagnostic, shape = Age.group ))+
    geom_point() +
    geom_line(aes(group = Diagnostic)) +
    #geom_text(aes(label=Age.group), nudge_y = 0.1, size =3)+
    theme_pubr() + 
    labs(x = "Mean K (z-score)", y = "Mean S (z-score)", shape = "Age") +
    theme(axis.title = element_text(size = 11),
          axis.text = element_text(size = 10), text = element_text(size = 8))

fig3d <- ggplot(mean_K_I_S_age_zscore, aes(x = mean.K, y = mean.I, color = Diagnostic, shape = Age.group ))+
    geom_point() +
    geom_line(aes(group = Diagnostic)) +
    #geom_text(aes(label=Age.group), nudge_y = 0.1, size =3)+
    theme_pubr() +
    labs(x = "Mean K (z-score)", y = "Mean I (z-score)", shape = "Age")  +
    theme(axis.title = element_text(size = 11),
          axis.text = element_text(size = 10), text = element_text(size = 8))

fig3 <- ggarrange(fig3a, fig3b, labels = c("A", "B"), nrow=2, ncol=1, font.label = list(size = 11))
fig3s <- ggarrange(fig3c, fig3d, labels = c("A", "B"), nrow=2, ncol=1, font.label = list(size = 11))


ggsave("fig3a.pdf", plot = fig3a, dpi=1200, width = 9, height = 6, units = "cm", device = "pdf")
ggsave("fig3a.jpeg", plot = fig3a, dpi=1200, width = 9, height = 6, units = "cm", device = "jpeg")
ggsave("fig3b.pdf", plot = fig3b, dpi=1200, width = 9, height = 6, units = "cm", device = "pdf")
ggsave("fig3b.jpeg", plot = fig3b, dpi=1200, width = 11, height = 11, units = "cm", device = "jpeg")

ggsave("fig3.pdf", plot = fig3, dpi=1200, width = 11, height = 11, units = "cm", device = "pdf")
ggsave("fig3.jpeg", plot = fig3, dpi=1200, width = 11, height = 11, units = "cm", device = "jpeg")

ggsave("fig3s.pdf", plot = fig3s, dpi=1200, width = 11, height = 11, units = "cm", device = "pdf")
ggsave("fig3s.jpeg", plot = fig3s, dpi=1200, width = 11, height = 11, units = "cm", device = "jpeg")

aK <- aov(K ~ Diagnostic*Age.group, data = dados_hemi_v1_DACTL)
summary(aK)
TukeyHSD(aK)

aS <- aov(S ~ Diagnostic*Age.group, data = dados_hemi_v1_DACTL)
summary(aS)
TukeyHSD(aS)
```

##### Lobos

```{r}
ggplot(dados_lobos_v1, aes(x = Diagnostic, y = S_corrected, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_boxplot() +
 stat_compare_means(method = "anova") + theme_pubr() + facet_wrap(ROI ~ . )

ggplot(dados_lobos_v1, aes(x = Diagnostic, y = I_corrected, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_boxplot() +
 stat_compare_means(method = "anova") + theme_pubr() + facet_wrap(ROI ~ . )
```


## Envelhecimento vs DA
### Decreasing rate
```{r decreasing rate hemi, eval=FALSE, include=FALSE}
K_rate_year_CTL = (max(filter(dados_hemi_v1, Diagnostic == "CTL")$K) - min(filter(dados_hemi_v1, Diagnostic == "CTL")$K))/(max(filter(dados_hemi_v1, Diagnostic == "CTL")$Age) - min(filter(dados_hemi_v1, Diagnostic == "CTL")$Age))

K_rate_year_AD = (max(filter(dados_hemi_v1, Diagnostic == "AD")$K) - min(filter(dados_hemi_v1, Diagnostic == "AD")$K))/(max(filter(dados_hemi_v1, Diagnostic == "AD")$Age) - min(filter(dados_hemi_v1, Diagnostic == "AD")$Age))

K_rate_year_MCI = (max(filter(dados_hemi_v1, Diagnostic == "MCI")$K) - min(filter(dados_hemi_v1, Diagnostic == "MCI")$K))/(max(filter(dados_hemi_v1, Diagnostic == "MCI")$Age) - min(filter(dados_hemi_v1, Diagnostic == "MCI")$Age))

paste("K decreasing rate/year (CTL-hemi)= ", signif(K_rate_year_CTL, digits=2))

paste("K decreasing rate/year (AD-hemi) = ", signif(K_rate_year_AD, digits=2))

paste("K decreasing rate/year (MCI-hemi) = ", signif(K_rate_year_MCI, digits=2))

paste("K decreasing rate/year (AD/CTL-hemi) = ", signif(K_rate_year_AD/K_rate_year_CTL, digits=2))

paste("K decreasing rate/year (MCI/CTL-hemi) = ", signif(K_rate_year_MCI/K_rate_year_CTL, digits=2))

# S ----

S_rate_year_CTL = (max(filter(dados_hemi_v1, Diagnostic == "CTL")$S) - min(filter(dados_hemi_v1, Diagnostic == "CTL")$S))/(max(filter(dados_hemi_v1, Diagnostic == "CTL")$Age) - min(filter(dados_hemi_v1, Diagnostic == "CTL")$Age))

S_rate_year_AD = (max(filter(dados_hemi_v1, Diagnostic == "AD")$S) - min(filter(dados_hemi_v1, Diagnostic == "AD")$S))/(max(filter(dados_hemi_v1, Diagnostic == "AD")$Age) - min(filter(dados_hemi_v1, Diagnostic == "AD")$Age))

S_rate_year_MCI = (max(filter(dados_hemi_v1, Diagnostic == "MCI")$S) - min(filter(dados_hemi_v1, Diagnostic == "MCI")$S))/(max(filter(dados_hemi_v1, Diagnostic == "MCI")$Age) - min(filter(dados_hemi_v1, Diagnostic == "MCI")$Age))

paste("S decreasing rate/year (CTL-hemi)= ", signif(S_rate_year_CTL, digits=2))

paste("S decreasing rate/year (AD-hemi) = ", signif(S_rate_year_AD, digits=2))

paste("S decreasing rate/year (MCI-hemi) = ", signif(S_rate_year_MCI, digits=2))

paste("S decreasing rate/year (AD/CTL-hemi) = ", signif(S_rate_year_AD/S_rate_year_CTL, digits=2))

paste("S decreasing rate/year (MCI/CTL-hemi) = ", signif(S_rate_year_MCI/S_rate_year_CTL, digits=2))

# I ----

I_rate_year_CTL = (max(filter(dados_hemi_v1, Diagnostic == "CTL")$I) - min(filter(dados_hemi_v1, Diagnostic == "CTL")$I))/(max(filter(dados_hemi_v1, Diagnostic == "CTL")$Age) - min(filter(dados_hemi_v1, Diagnostic == "CTL")$Age))

I_rate_year_AD = (max(filter(dados_hemi_v1, Diagnostic == "AD")$I) - min(filter(dados_hemi_v1, Diagnostic == "AD")$I))/(max(filter(dados_hemi_v1, Diagnostic == "AD")$Age) - min(filter(dados_hemi_v1, Diagnostic == "AD")$Age))

I_rate_year_MCI = (max(filter(dados_hemi_v1, Diagnostic == "MCI")$I) - min(filter(dados_hemi_v1, Diagnostic == "MCI")$I))/(max(filter(dados_hemi_v1, Diagnostic == "MCI")$Age) - min(filter(dados_hemi_v1, Diagnostic == "MCI")$Age))

paste("I decreasing rate/year (CTL-hemi)= ", signif(I_rate_year_CTL, digits=2))

paste("I decreasing rate/year (AD-hemi) = ", signif(I_rate_year_AD, digits=2))

paste("I decreasing rate/year (MCI-hemi) = ", signif(I_rate_year_MCI, digits=2))

paste("I decreasing rate/year (AD/CTL-hemi) = ", signif(I_rate_year_AD/I_rate_year_CTL, digits=2))
paste("I decreasing rate/year (MCI/CTL-hemi) = ", signif(I_rate_year_MCI/I_rate_year_CTL, digits=2))
```

```{r decreasing rate frontal lobe, eval=FALSE, include=FALSE}
K_rate_year_CTL = (max(filter(dados_lobos_v1_F, Diagnostic == "CTL")$K) - min(filter(dados_lobos_v1_F, Diagnostic == "CTL")$K))/(max(filter(dados_lobos_v1_F, Diagnostic == "CTL")$Age) - min(filter(dados_lobos_v1_F, Diagnostic == "CTL")$Age))

K_rate_year_AD = (max(filter(dados_lobos_v1_F, Diagnostic == "AD")$K) - min(filter(dados_lobos_v1_F, Diagnostic == "AD")$K))/(max(filter(dados_lobos_v1_F, Diagnostic == "AD")$Age) - min(filter(dados_lobos_v1_F, Diagnostic == "AD")$Age))

K_rate_year_MCI = (max(filter(dados_lobos_v1_F, Diagnostic == "MCI")$K) - min(filter(dados_lobos_v1_F, Diagnostic == "MCI")$K))/(max(filter(dados_lobos_v1_F, Diagnostic == "MCI")$Age) - min(filter(dados_lobos_v1_F, Diagnostic == "MCI")$Age))

paste("K decreasing rate/year (CTL-frontallobe)= ", signif(K_rate_year_CTL, digits=2))

paste("K decreasing rate/year (AD-frontallobe) = ", signif(K_rate_year_AD, digits=2))

paste("K decreasing rate/year (MCI-frontallobe) = ", signif(K_rate_year_MCI, digits=2))

paste("K decreasing rate/year (AD/CTL-frontallobe) = ", signif(K_rate_year_AD/K_rate_year_CTL, digits=2))

paste("K decreasing rate/year (MCI/CTL-frontallobe) = ", signif(K_rate_year_MCI/K_rate_year_CTL, digits=2))

# S ----

S_rate_year_CTL = (max(filter(dados_lobos_v1_F, Diagnostic == "CTL")$S) - min(filter(dados_lobos_v1_F, Diagnostic == "CTL")$S))/(max(filter(dados_lobos_v1_F, Diagnostic == "CTL")$Age) - min(filter(dados_lobos_v1_F, Diagnostic == "CTL")$Age))

S_rate_year_AD = (max(filter(dados_lobos_v1_F, Diagnostic == "AD")$S) - min(filter(dados_lobos_v1_F, Diagnostic == "AD")$S))/(max(filter(dados_lobos_v1_F, Diagnostic == "AD")$Age) - min(filter(dados_lobos_v1_F, Diagnostic == "AD")$Age))

S_rate_year_MCI = (max(filter(dados_lobos_v1_F, Diagnostic == "MCI")$S) - min(filter(dados_lobos_v1_F, Diagnostic == "MCI")$S))/(max(filter(dados_lobos_v1_F, Diagnostic == "MCI")$Age) - min(filter(dados_lobos_v1_F, Diagnostic == "MCI")$Age))

paste("S decreasing rate/year (CTL-frontallobe)= ", signif(S_rate_year_CTL, digits=2))

paste("S decreasing rate/year (AD-frontallobe) = ", signif(S_rate_year_AD, digits=2))

paste("S decreasing rate/year (MCI-frontallobe) = ", signif(S_rate_year_MCI, digits=2))

paste("S decreasing rate/year (AD/CTL-frontallobe) = ", signif(S_rate_year_AD/S_rate_year_CTL, digits=2))

paste("S decreasing rate/year (MCI/CTL-frontallobe) = ", signif(S_rate_year_MCI/S_rate_year_CTL, digits=2))

# I ----

I_rate_year_CTL = (max(filter(dados_lobos_v1_F, Diagnostic == "CTL")$I) - min(filter(dados_lobos_v1_F, Diagnostic == "CTL")$I))/(max(filter(dados_lobos_v1_F, Diagnostic == "CTL")$Age) - min(filter(dados_lobos_v1_F, Diagnostic == "CTL")$Age))

I_rate_year_AD = (max(filter(dados_lobos_v1_F, Diagnostic == "AD")$I) - min(filter(dados_lobos_v1_F, Diagnostic == "AD")$I))/(max(filter(dados_lobos_v1_F, Diagnostic == "AD")$Age) - min(filter(dados_lobos_v1_F, Diagnostic == "AD")$Age))

I_rate_year_MCI = (max(filter(dados_lobos_v1_F, Diagnostic == "MCI")$I) - min(filter(dados_lobos_v1_F, Diagnostic == "MCI")$I))/(max(filter(dados_lobos_v1_F, Diagnostic == "MCI")$Age) - min(filter(dados_lobos_v1_F, Diagnostic == "MCI")$Age))

paste("I decreasing rate/year (CTL-frontallobe)= ", signif(I_rate_year_CTL, digits=2))

paste("I decreasing rate/year (AD-frontallobe) = ", signif(I_rate_year_AD, digits=2))

paste("I decreasing rate/year (MCI-frontallobe) = ", signif(I_rate_year_MCI, digits=2))

paste("I decreasing rate/year (AD/CTL-frontallobe) = ", signif(I_rate_year_AD/I_rate_year_CTL, digits=2))

paste("I decreasing rate/year (MCI/CTL-frontallobe) = ", signif(I_rate_year_MCI/I_rate_year_CTL, digits=2))
```

```{r decreasing rate occipital lobe, eval=FALSE, include=FALSE}
K_rate_year_CTL = (max(filter(dados_lobos_v1_O, Diagnostic == "CTL")$K) - min(filter(dados_lobos_v1_O, Diagnostic == "CTL")$K))/(max(filter(dados_lobos_v1_O, Diagnostic == "CTL")$Age) - min(filter(dados_lobos_v1_O, Diagnostic == "CTL")$Age))

K_rate_year_AD = (max(filter(dados_lobos_v1_O, Diagnostic == "AD")$K) - min(filter(dados_lobos_v1_O, Diagnostic == "AD")$K))/(max(filter(dados_lobos_v1_O, Diagnostic == "AD")$Age) - min(filter(dados_lobos_v1_O, Diagnostic == "AD")$Age))

K_rate_year_MCI = (max(filter(dados_lobos_v1_O, Diagnostic == "MCI")$K) - min(filter(dados_lobos_v1_O, Diagnostic == "MCI")$K))/(max(filter(dados_lobos_v1_O, Diagnostic == "MCI")$Age) - min(filter(dados_lobos_v1_O, Diagnostic == "MCI")$Age))

paste("K decreasing rate/year (CTL-occipitallobe)= ", signif(K_rate_year_CTL, digits=2))

paste("K decreasing rate/year (AD-occipitallobe) = ", signif(K_rate_year_AD, digits=2))

paste("K decreasing rate/year (MCI-occipitallobe) = ", signif(K_rate_year_MCI, digits=2))

paste("K decreasing rate/year (AD/CTL-occipitallobe) = ", signif(K_rate_year_AD/K_rate_year_CTL, digits=2))

paste("K decreasing rate/year (MCI/CTL-occipitallobe) = ", signif(K_rate_year_MCI/K_rate_year_CTL, digits=2))

# S ----

S_rate_year_CTL = (max(filter(dados_lobos_v1_O, Diagnostic == "CTL")$S) - min(filter(dados_lobos_v1_O, Diagnostic == "CTL")$S))/(max(filter(dados_lobos_v1_O, Diagnostic == "CTL")$Age) - min(filter(dados_lobos_v1_O, Diagnostic == "CTL")$Age))

S_rate_year_AD = (max(filter(dados_lobos_v1_O, Diagnostic == "AD")$S) - min(filter(dados_lobos_v1_O, Diagnostic == "AD")$S))/(max(filter(dados_lobos_v1_O, Diagnostic == "AD")$Age) - min(filter(dados_lobos_v1_O, Diagnostic == "AD")$Age))

S_rate_year_MCI = (max(filter(dados_lobos_v1_O, Diagnostic == "MCI")$S) - min(filter(dados_lobos_v1_O, Diagnostic == "MCI")$S))/(max(filter(dados_lobos_v1_O, Diagnostic == "MCI")$Age) - min(filter(dados_lobos_v1_O, Diagnostic == "MCI")$Age))

paste("S decreasing rate/year (CTL-occipitallobe)= ", signif(S_rate_year_CTL, digits=2))

paste("S decreasing rate/year (AD-occipitallobe) = ", signif(S_rate_year_AD, digits=2))

paste("S decreasing rate/year (MCI-occipitallobe) = ", signif(S_rate_year_MCI, digits=2))

paste("S decreasing rate/year (AD/CTL-occipitallobe) = ", signif(S_rate_year_AD/S_rate_year_CTL, digits=2))

paste("S decreasing rate/year (MCI/CTL-occipitallobe) = ", signif(S_rate_year_MCI/S_rate_year_CTL, digits=2))

# I ----

I_rate_year_CTL = (max(filter(dados_lobos_v1_O, Diagnostic == "CTL")$I) - min(filter(dados_lobos_v1_O, Diagnostic == "CTL")$I))/(max(filter(dados_lobos_v1_O, Diagnostic == "CTL")$Age) - min(filter(dados_lobos_v1_O, Diagnostic == "CTL")$Age))

I_rate_year_AD = (max(filter(dados_lobos_v1_O, Diagnostic == "AD")$I) - min(filter(dados_lobos_v1_O, Diagnostic == "AD")$I))/(max(filter(dados_lobos_v1_O, Diagnostic == "AD")$Age) - min(filter(dados_lobos_v1_O, Diagnostic == "AD")$Age))

I_rate_year_MCI = (max(filter(dados_lobos_v1_O, Diagnostic == "MCI")$I) - min(filter(dados_lobos_v1_O, Diagnostic == "MCI")$I))/(max(filter(dados_lobos_v1_O, Diagnostic == "MCI")$Age) - min(filter(dados_lobos_v1_O, Diagnostic == "MCI")$Age))

paste("I decreasing rate/year (CTL-occipitallobe)= ", signif(I_rate_year_CTL, digits=2))

paste("I decreasing rate/year (AD-occipitallobe) = ", signif(I_rate_year_AD, digits=2))

paste("I decreasing rate/year (MCI-occipitallobe) = ", signif(I_rate_year_MCI, digits=2))

paste("I decreasing rate/year (AD/CTL-occipitallobe) = ", signif(I_rate_year_AD/I_rate_year_CTL, digits=2))

paste("I decreasing rate/year (MCI/CTL-occipitallobe) = ", signif(I_rate_year_MCI/I_rate_year_CTL, digits=2))
```

```{r decreasing rate parietal lobe, eval=FALSE, include=FALSE}
K_rate_year_CTL = (max(filter(dados_lobos_v1_P, Diagnostic == "CTL")$K) - min(filter(dados_lobos_v1_P, Diagnostic == "CTL")$K))/(max(filter(dados_lobos_v1_P, Diagnostic == "CTL")$Age) - min(filter(dados_lobos_v1_P, Diagnostic == "CTL")$Age))

K_rate_year_AD = (max(filter(dados_lobos_v1_P, Diagnostic == "AD")$K) - min(filter(dados_lobos_v1_P, Diagnostic == "AD")$K))/(max(filter(dados_lobos_v1_P, Diagnostic == "AD")$Age) - min(filter(dados_lobos_v1_P, Diagnostic == "AD")$Age))

K_rate_year_MCI = (max(filter(dados_lobos_v1_P, Diagnostic == "MCI")$K) - min(filter(dados_lobos_v1_P, Diagnostic == "MCI")$K))/(max(filter(dados_lobos_v1_P, Diagnostic == "MCI")$Age) - min(filter(dados_lobos_v1_P, Diagnostic == "MCI")$Age))

paste("K decreasing rate/year (CTL-parietallobe)= ", signif(K_rate_year_CTL, digits=2))

paste("K decreasing rate/year (AD-parietallobe) = ", signif(K_rate_year_AD, digits=2))

paste("K decreasing rate/year (MCI-parietallobe) = ", signif(K_rate_year_MCI, digits=2))

paste("K decreasing rate/year (AD/CTL-parietallobe) = ", signif(K_rate_year_AD/K_rate_year_CTL, digits=2))

paste("K decreasing rate/year (MCI/CTL-parietallobe) = ", signif(K_rate_year_MCI/K_rate_year_CTL, digits=2))

# S ----

S_rate_year_CTL = (max(filter(dados_lobos_v1_P, Diagnostic == "CTL")$S) - min(filter(dados_lobos_v1_P, Diagnostic == "CTL")$S))/(max(filter(dados_lobos_v1_P, Diagnostic == "CTL")$Age) - min(filter(dados_lobos_v1_P, Diagnostic == "CTL")$Age))

S_rate_year_AD = (max(filter(dados_lobos_v1_P, Diagnostic == "AD")$S) - min(filter(dados_lobos_v1_P, Diagnostic == "AD")$S))/(max(filter(dados_lobos_v1_P, Diagnostic == "AD")$Age) - min(filter(dados_lobos_v1_P, Diagnostic == "AD")$Age))

S_rate_year_MCI = (max(filter(dados_lobos_v1_P, Diagnostic == "MCI")$S) - min(filter(dados_lobos_v1_P, Diagnostic == "MCI")$S))/(max(filter(dados_lobos_v1_P, Diagnostic == "MCI")$Age) - min(filter(dados_lobos_v1_P, Diagnostic == "MCI")$Age))

paste("S decreasing rate/year (CTL-parietallobe)= ", signif(S_rate_year_CTL, digits=2))

paste("S decreasing rate/year (AD-parietallobe) = ", signif(S_rate_year_AD, digits=2))

paste("S decreasing rate/year (MCI-parietallobe) = ", signif(S_rate_year_MCI, digits=2))

paste("S decreasing rate/year (AD/CTL-parietallobe) = ", signif(S_rate_year_AD/S_rate_year_CTL, digits=2))

paste("S decreasing rate/year (MCI/CTL-parietallobe) = ", signif(S_rate_year_MCI/S_rate_year_CTL, digits=2))

# I ----

I_rate_year_CTL = (max(filter(dados_lobos_v1_P, Diagnostic == "CTL")$I) - min(filter(dados_lobos_v1_P, Diagnostic == "CTL")$I))/(max(filter(dados_lobos_v1_P, Diagnostic == "CTL")$Age) - min(filter(dados_lobos_v1_P, Diagnostic == "CTL")$Age))

I_rate_year_AD = (max(filter(dados_lobos_v1_P, Diagnostic == "AD")$I) - min(filter(dados_lobos_v1_P, Diagnostic == "AD")$I))/(max(filter(dados_lobos_v1_P, Diagnostic == "AD")$Age) - min(filter(dados_lobos_v1_P, Diagnostic == "AD")$Age))

I_rate_year_MCI = (max(filter(dados_lobos_v1_P, Diagnostic == "MCI")$I) - min(filter(dados_lobos_v1_P, Diagnostic == "MCI")$I))/(max(filter(dados_lobos_v1_P, Diagnostic == "MCI")$Age) - min(filter(dados_lobos_v1_P, Diagnostic == "MCI")$Age))

paste("I decreasing rate/year (CTL-parietallobe)= ", signif(I_rate_year_CTL, digits=2))

paste("I decreasing rate/year (AD-parietallobe) = ", signif(I_rate_year_AD, digits=2))

paste("I decreasing rate/year (MCI-parietallobe) = ", signif(I_rate_year_MCI, digits=2))

paste("I decreasing rate/year (AD/CTL-parietallobe) = ", signif(I_rate_year_AD/I_rate_year_CTL, digits=2))

paste("I decreasing rate/year (MCI/CTL-parietallobe) = ", signif(I_rate_year_MCI/I_rate_year_CTL, digits=2))
```

```{r decreasing rate temporal lobe, echo=FALSE}
K_rate_year_CTL = (max(filter(dados_lobos_v1_T, Diagnostic == "CTL")$K) - min(filter(dados_lobos_v1_T, Diagnostic == "CTL")$K))/(max(filter(dados_lobos_v1_T, Diagnostic == "CTL")$Age) - min(filter(dados_lobos_v1_T, Diagnostic == "CTL")$Age))

K_rate_year_AD = (max(filter(dados_lobos_v1_T, Diagnostic == "AD")$K) - min(filter(dados_lobos_v1_T, Diagnostic == "AD")$K))/(max(filter(dados_lobos_v1_T, Diagnostic == "AD")$Age) - min(filter(dados_lobos_v1_T, Diagnostic == "AD")$Age))

K_rate_year_MCI = (max(filter(dados_lobos_v1_T, Diagnostic == "MCI")$K) - min(filter(dados_lobos_v1_T, Diagnostic == "MCI")$K))/(max(filter(dados_lobos_v1_T, Diagnostic == "MCI")$Age) - min(filter(dados_lobos_v1_T, Diagnostic == "MCI")$Age))

paste("K decreasing rate/year (CTL-temporallobe)= ", signif(K_rate_year_CTL, digits=2))

paste("K decreasing rate/year (AD-temporallobe) = ", signif(K_rate_year_AD, digits=2))

paste("K decreasing rate/year (MCI-temporallobe) = ", signif(K_rate_year_MCI, digits=2))

paste("K decreasing rate/year (AD/CTL-temporallobe) = ", signif(K_rate_year_AD/K_rate_year_CTL, digits=2))

paste("K decreasing rate/year (MCI/CTL-temporallobe) = ", signif(K_rate_year_MCI/K_rate_year_CTL, digits=2))

# S ----

S_rate_year_CTL = (max(filter(dados_lobos_v1_T, Diagnostic == "CTL")$S) - min(filter(dados_lobos_v1_T, Diagnostic == "CTL")$S))/(max(filter(dados_lobos_v1_T, Diagnostic == "CTL")$Age) - min(filter(dados_lobos_v1_T, Diagnostic == "CTL")$Age))

S_rate_year_AD = (max(filter(dados_lobos_v1_T, Diagnostic == "AD")$S) - min(filter(dados_lobos_v1_T, Diagnostic == "AD")$S))/(max(filter(dados_lobos_v1_T, Diagnostic == "AD")$Age) - min(filter(dados_lobos_v1_T, Diagnostic == "AD")$Age))

S_rate_year_MCI = (max(filter(dados_lobos_v1_T, Diagnostic == "MCI")$S) - min(filter(dados_lobos_v1_T, Diagnostic == "MCI")$S))/(max(filter(dados_lobos_v1_T, Diagnostic == "MCI")$Age) - min(filter(dados_lobos_v1_T, Diagnostic == "MCI")$Age))

paste("S decreasing rate/year (CTL-temporallobe)= ", signif(S_rate_year_CTL, digits=2))

paste("S decreasing rate/year (AD-temporallobe) = ", signif(S_rate_year_AD, digits=2))

paste("S decreasing rate/year (MCI-temporallobe) = ", signif(S_rate_year_MCI, digits=2))

paste("S decreasing rate/year (AD/CTL-temporallobe) = ", signif(S_rate_year_AD/S_rate_year_CTL, digits=2))

paste("S decreasing rate/year (MCI/CTL-temporallobe) = ", signif(S_rate_year_MCI/S_rate_year_CTL, digits=2))

# I ----

I_rate_year_CTL = (max(filter(dados_lobos_v1_T, Diagnostic == "CTL")$I) - min(filter(dados_lobos_v1_T, Diagnostic == "CTL")$I))/(max(filter(dados_lobos_v1_T, Diagnostic == "CTL")$Age) - min(filter(dados_lobos_v1_T, Diagnostic == "CTL")$Age))

I_rate_year_AD = (max(filter(dados_lobos_v1_T, Diagnostic == "AD")$I) - min(filter(dados_lobos_v1_T, Diagnostic == "AD")$I))/(max(filter(dados_lobos_v1_T, Diagnostic == "AD")$Age) - min(filter(dados_lobos_v1_T, Diagnostic == "AD")$Age))

I_rate_year_MCI = (max(filter(dados_lobos_v1_T, Diagnostic == "MCI")$I) - min(filter(dados_lobos_v1_T, Diagnostic == "MCI")$I))/(max(filter(dados_lobos_v1_T, Diagnostic == "MCI")$Age) - min(filter(dados_lobos_v1_T, Diagnostic == "MCI")$Age))

paste("I decreasing rate/year (CTL-temporallobe)= ", signif(I_rate_year_CTL, digits=2))

paste("I decreasing rate/year (AD-temporallobe) = ", signif(I_rate_year_AD, digits=2))

paste("I decreasing rate/year (MCI-temporallobe) = ", signif(I_rate_year_MCI, digits=2))

paste("I decreasing rate/year (AD/CTL-temporallobe) = ", signif(I_rate_year_AD/I_rate_year_CTL, digits=2))

paste("I decreasing rate/year (MCI/CTL-temporallobe) = ", signif(I_rate_year_MCI/I_rate_year_CTL, digits=2))
```

### ANOVA

```{r Ageing vs DA, eval=FALSE, include=FALSE}
dados_hemi_v1_DACTL <- dados_hemi_v1 %>%
  mutate(Age.group = ifelse(
    Age > 75,
    "76-86yo",
    ifelse((Age < 75 | Age == 75 & Age > 65 | Age == 65),
           "65-75yo",
           "")))

```


### Sem MCI

```{r Ageing vs DA !MCI, eval=FALSE, include=FALSE}
dados_hemi_v1_CH_DACTL <- filter(dados_hemi_v1, Diagnostic != "MCI")

# source("06-calculo_zscore_k_s_i_Age.R")

aov_diag_K <- aov(K ~ Diagnostic, data = dados_hemi_v1_DACTL)
aov_diag_K_diag_TK <- TukeyHSD(aov_diag_K)
aov_diag_K_diag_TK_t <- mutate(as.data.frame(aov_diag_K_diag_TK$Diagnostic), Contrast = c("CTL-AD") , morphological_parameter = "K", ROI = "hemisphere", Age_correction = "no")

aov_diag_K_age_decay <- aov(K_age_decay ~ Diagnostic, data = dados_hemi_v1_DACTL)
aov_diag_K_age_decay_diag_TK <- TukeyHSD(aov_diag_K_age_decay)
aov_diag_K_age_decay_diag_TK_t <- mutate(as.data.frame(aov_diag_K_age_decay_diag_TK$Diagnostic), Contrast = c("CTL-AD") , morphological_parameter = "K", ROI = "hemisphere", Age_correction = "yes")

aov_diag_S <- aov(S ~ Diagnostic, data = dados_hemi_v1_DACTL)
aov_diag_S_diag_TK <- TukeyHSD(aov_diag_S)
aov_diag_S_diag_TK_t <- mutate(as.data.frame(aov_diag_S_diag_TK$Diagnostic), Contrast = c("CTL-AD")  , morphological_parameter = "S", ROI = "hemisphere", Age_correction = "no")

aov_diag_S_age_decay <- aov(S_age_decay ~ Diagnostic, data = dados_hemi_v1_DACTL)
aov_diag_S_age_decay_diag_TK <- TukeyHSD(aov_diag_S_age_decay)
aov_diag_S_age_decay_diag_TK_t <- mutate(as.data.frame(aov_diag_S_age_decay_diag_TK$Diagnostic), Contrast = c("CTL-AD")  , morphological_parameter = "S", ROI = "hemisphere", Age_correction = "yes")

aov_diag_I <- aov(I ~ Diagnostic, data = dados_hemi_v1_DACTL)
aov_diag_I_diag_TK <- TukeyHSD(aov_diag_I)
aov_diag_I_diag_TK_t <- mutate(as.data.frame(aov_diag_S_diag_TK$Diagnostic), Contrast = c("CTL-AD")  , morphological_parameter = "I", ROI = "hemisphere", Age_correction = "no")

aov_diag_I_age_decay <- aov(I_age_decay ~ Diagnostic, data = dados_hemi_v1_DACTL)
aov_diag_I_age_decay_diag_TK <- TukeyHSD(aov_diag_I_age_decay)
aov_diag_I_age_decay_diag_TK_t <- mutate(as.data.frame(aov_diag_I_age_decay_diag_TK$Diagnostic), Contrast = c("CTL-AD")  , morphological_parameter = "I", ROI = "hemisphere", Age_correction = "yes")

aov_summary_KSI_ADCTL <- full_join(aov_diag_K_diag_TK_t, aov_diag_K_age_decay_diag_TK_t) %>%
full_join(aov_diag_S_diag_TK_t) %>%
full_join(aov_diag_S_age_decay_diag_TK_t) %>%
full_join(aov_diag_I_diag_TK_t) %>%
full_join(aov_diag_I_age_decay_diag_TK_t)

ggplot(data = filter(aov_summary_KSI_ADCTL, `p adj` < 0.05 |
                         `p adj` == 0.05), aes(
  x = ROI,
  y = diff,
  ymin = lwr,
  ymax = upr,
  color = Contrast)) +
  geom_hline(yintercept = 0,
             linetype = "11",
             colour = "grey60") +
  geom_errorbar(width = 0.1, position = position_dodge(width = 0.6)) +
  geom_point(position = position_dodge(width = 0.6)) +
  coord_flip() +
  facet_grid(morphological_parameter ~ Age_correction, labeller = label_both) +
  labs(title = "95% family-wise confidence level", y =  "Differences in mean levels of Diagnostic", x = "ROI", caption = "only significant differences, p adj =< 0.05)") +
  theme_pubr()

aov_summary_KSI_ADCTL %>% kable() %>% kable_styling()

filter(aov_summary_KSI_ADCTL, `p adj` < 0.05 |
                         `p adj` == 0.05) %>% kable() %>% kable_styling()


```

## Clinical data

```{r clinical data summary, messAge=FALSE, warning=FALSE}

#hemisphere
dados_hemi_v1_CD <- dados_hemi_v1 %>% 
  pivot_longer(c(COGNITIVE_INDEX, `A7/A5`, `TMT B-A`, MMSE, relogio, `DIGIT SPAN BACK`, `AB1-40`, `AB1-42`, TAU, AB1_ratio, TAU_AB1_42_ratio, TAU_AB1_ratio, Lipoxina), names_to = "clinical_test", values_to = "clinical_test_value")

dados_hemi_v1_CD <- dados_hemi_v1_CD %>% 
  pivot_longer(c(K, K_age_decay, logAvgThickness, logAvgThickness_age_decay, S, S_age_decay, I, I_age_decay), names_to = "morphological_parameter", values_to = "morphological_parameter_value")

dados_hemi_v1_CD_behaviour <- unique(filter(dados_hemi_v1_CD, clinical_test == "A7/A5" | clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "relogio" | clinical_test == "DIGIT SPAN BACK"))

dados_hemi_v1_CD_biochq <- unique(filter(dados_hemi_v1_CD, clinical_test == "AB1-40" | clinical_test == "AB1-42" | clinical_test == "TAU" | clinical_test == "AB1_ratio" | clinical_test == "TAU_AB1_42_ratio" | clinical_test == "TAU_AB1_ratio"| clinical_test == "Lipoxina"))

#frontal lobe
dados_lobos_v1_F_CD <- dados_lobos_v1_F %>% 
  pivot_longer(c(COGNITIVE_INDEX, `A7/A5`, `TMT B-A`, MMSE, relogio, `DIGIT SPAN BACK`, `AB1-40`, `AB1-42`, TAU, AB1_ratio, TAU_AB1_42_ratio, TAU_AB1_ratio, Lipoxina), names_to = "clinical_test", values_to = "clinical_test_value")

dados_lobos_v1_F_CD <- dados_lobos_v1_F_CD %>% 
  pivot_longer(c(K_corrected, K_age_decay, logAvgThickness, logAvgThickness_age_decay, S_corrected, S_age_decay, I_corrected, I_age_decay), names_to = "morphological_parameter", values_to = "morphological_parameter_value")

dados_lobos_v1_F_CD_behaviour <- filter(dados_lobos_v1_F_CD, clinical_test == "A7/A5" | clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "relogio" | clinical_test == "DIGIT SPAN BACK") 

dados_lobos_v1_F_CD_biochq <- filter(dados_lobos_v1_F_CD, clinical_test == "AB1-40" | clinical_test == "AB1-42" | clinical_test == "TAU" | clinical_test == "AB1_ratio" | clinical_test == "TAU_AB1_42_ratio" | clinical_test == "TAU_AB1_ratio"| clinical_test == "Lipoxina")

#parietal lobe
dados_lobos_v1_P_CD <- dados_lobos_v1_P %>% 
  pivot_longer(c(COGNITIVE_INDEX, `A7/A5`, `TMT B-A`, MMSE, relogio, `DIGIT SPAN BACK`, `AB1-40`, `AB1-42`, TAU, AB1_ratio, TAU_AB1_42_ratio, TAU_AB1_ratio, Lipoxina), names_to = "clinical_test", values_to = "clinical_test_value")

dados_lobos_v1_P_CD <- dados_lobos_v1_P_CD %>% 
  pivot_longer(c(K_corrected, K_age_decay, logAvgThickness, logAvgThickness_age_decay, S_corrected, S_age_decay, I_corrected, I_age_decay), names_to = "morphological_parameter", values_to = "morphological_parameter_value")

dados_lobos_v1_P_CD_behaviour <- filter(dados_lobos_v1_P_CD, clinical_test == "A7/A5" | clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "relogio" | clinical_test == "DIGIT SPAN BACK") 

dados_lobos_v1_P_CD_biochq <- filter(dados_lobos_v1_P_CD, clinical_test == "AB1-40" | clinical_test == "AB1-42" | clinical_test == "TAU" | clinical_test == "AB1_ratio" | clinical_test == "TAU_AB1_42_ratio" | clinical_test == "TAU_AB1_ratio"| clinical_test == "Lipoxina")

#occipital lobe
dados_lobos_v1_O_CD <- dados_lobos_v1_O %>% 
  pivot_longer(c(COGNITIVE_INDEX, `A7/A5`, `TMT B-A`, MMSE, relogio, `DIGIT SPAN BACK`, `AB1-40`, `AB1-42`, TAU, AB1_ratio, TAU_AB1_42_ratio, TAU_AB1_ratio, Lipoxina), names_to = "clinical_test", values_to = "clinical_test_value")

dados_lobos_v1_O_CD <- dados_lobos_v1_O_CD %>% 
  pivot_longer(c(K_corrected, K_age_decay, logAvgThickness, logAvgThickness_age_decay, S_corrected, S_age_decay, I_corrected, I_age_decay), names_to = "morphological_parameter", values_to = "morphological_parameter_value")

dados_lobos_v1_O_CD_behaviour <- filter(dados_lobos_v1_O_CD, clinical_test == "A7/A5" | clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "relogio" | clinical_test == "DIGIT SPAN BACK") 

dados_lobos_v1_O_CD_biochq <- filter(dados_lobos_v1_O_CD, clinical_test == "AB1-40" | clinical_test == "AB1-42" | clinical_test == "TAU" | clinical_test == "AB1_ratio" | clinical_test == "TAU_AB1_42_ratio" | clinical_test == "TAU_AB1_ratio"| clinical_test == "Lipoxina")


#temporal lobe
dados_lobos_v1_T_CD <- dados_lobos_v1_T %>% 
  pivot_longer(c(COGNITIVE_INDEX, `A7/A5`, `TMT B-A`, MMSE, relogio, `DIGIT SPAN BACK`, `AB1-40`, `AB1-42`, TAU, AB1_ratio, TAU_AB1_42_ratio, TAU_AB1_ratio, Lipoxina), names_to = "clinical_test", values_to = "clinical_test_value")

dados_lobos_v1_T_CD <- dados_lobos_v1_T_CD %>% 
  pivot_longer(c(K_corrected, K_age_decay, logAvgThickness, logAvgThickness_age_decay, S_corrected, S_age_decay, I_corrected, I_age_decay), names_to = "morphological_parameter", values_to = "morphological_parameter_value")

dados_lobos_v1_T_CD_behaviour <- filter(dados_lobos_v1_T_CD, clinical_test == "A7/A5" | clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "relogio" | clinical_test == "DIGIT SPAN BACK") 

dados_lobos_v1_T_CD_biochq <- filter(dados_lobos_v1_T_CD, clinical_test == "AB1-40" | clinical_test == "AB1-42" | clinical_test == "TAU" | clinical_test == "AB1_ratio" | clinical_test == "TAU_AB1_42_ratio" | clinical_test == "TAU_AB1_ratio"| clinical_test == "Lipoxina")


sumario_dados_hemi_v1_diag_CD <-
dados_hemi_v1 %>%
group_by(Diagnostic) %>%
summarise(
N = n_distinct(SUBJ),
Mean_COGNITIVE_INDEX = mean(COGNITIVE_INDEX,  na.rm = TRUE),
STD_COGNITIVE_INDEX = sd(COGNITIVE_INDEX,  na.rm = TRUE),
Mean_A7_A5 = mean(`A7/A5`,  na.rm = TRUE),
STD_A7_A5 = sd(`A7/A5`,  na.rm = TRUE),
Mean_TMT_B_A = mean(`TMT B-A`,  na.rm = TRUE),
STD_TMT_B_A = sd(`TMT B-A`,  na.rm = TRUE),
Mean_relogio = mean(relogio,  na.rm = TRUE),
STD_relogio = sd(relogio,  na.rm = TRUE),
Mean_DIGIT_SPAN_BACK = mean(`DIGIT SPAN BACK`,  na.rm = TRUE),
STD_DIGIT_SPAN_BACK = sd(`DIGIT SPAN BACK`,  na.rm = TRUE),
Mean_Lipoxina = mean(Lipoxina ,  na.rm = TRUE),
STD_Lipoxina = sd(Lipoxina ,  na.rm = TRUE),
Mean_AB1_40 = mean(`AB1-40`,  na.rm = TRUE),
STD_AB1_40 = sd(`AB1-40`,  na.rm = TRUE),
Mean_AB1_42 = mean(`AB1-42`,  na.rm = TRUE),
STD_AB1_42 = sd(`AB1-42`,  na.rm = TRUE),
Mean_TAU = mean(TAU,  na.rm = TRUE),
STD_TAU = sd(TAU,  na.rm = TRUE))

sumario_dados_hemi_v1_diag_CD %>% kable(digits = 2) %>% kable_styling() %>%
  column_spec(1, width = "10cm")

sumario_dados_hemi_v1_diag_CD <-
dados_hemi_v1_CD %>%
group_by(clinical_test, Diagnostic) %>%
summarise(
N = n_distinct(SUBJ),
Mean = mean(clinical_test_value,  na.rm = TRUE),
STD = sd(clinical_test_value,  na.rm = TRUE))


sumario_dados_hemi_v1_diag_CD %>% kable(digits = 2) %>% kable_styling()

ggplot(data = dados_hemi_v1_CD_behaviour, aes(x = Diagnostic, y = clinical_test_value, color = Diagnostic, fill = Diagnostic, alpha = 0.4))+
  geom_boxplot() +
  facet_wrap(clinical_test ~ ., scales = "free", ncol = 2) +
  stat_compare_means(method = "anova") +
  theme_pubr()

ggplot(data = dados_hemi_v1_CD_biochq, aes(x = Diagnostic, y = clinical_test_value, color = Diagnostic, fill = Diagnostic, alpha = 0.4))+
  geom_boxplot()+
  facet_wrap(clinical_test ~ ., scales = "free", ncol = 2) +
  stat_compare_means(method = "anova") +
  theme_pubr()

```

K:
```{r clincal data, eval=FALSE, include=FALSE}

ggplot(data = filter(dados_hemi_v1, Lipoxina != 0 | !is.na(Lipoxina)), aes(K, Lipoxina, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, Lipoxina != 0 | !is.na(Lipoxina))$SUBJ))) 

ggplot(data = filter(dados_hemi_v1, COGNITIVE_INDEX != 0 | !is.na(COGNITIVE_INDEX)), aes(K, COGNITIVE_INDEX,  color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, COGNITIVE_INDEX != 0 | !is.na(COGNITIVE_INDEX))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `A7/A5` != 0 | !is.na(`A7/A5`)), aes(K,`A7/A5`, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `A7/A5` != 0 | !is.na(`A7/A5`))$SUBJ))) +
  

  ggplot(data = filter(dados_hemi_v1, `TMT B-A` != 0 | !is.na(`TMT B-A`)), aes(K,`TMT B-A`, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `TMT B-A` != 0 | !is.na(`TMT B-A`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, relogio != 0 | !is.na(relogio)), aes(K, relogio, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth( se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, relogio != 0 | !is.na(relogio))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `DIGIT SPAN BACK` != 0 | !is.na(`DIGIT SPAN BACK`)), aes(K, `DIGIT SPAN BACK`, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `DIGIT SPAN BACK` != 0 | !is.na(`DIGIT SPAN BACK`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `AB1-40` != 0 | !is.na(`AB1-40`)), aes(`AB1-40`, K, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `AB1-40` != 0 | !is.na(`AB1-40`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `AB1-42` != 0 | !is.na(`AB1-42`)), aes(K, `AB1-42`, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth( se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `AB1-42` != 0 | !is.na(`AB1-42`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, TAU != 0 | !is.na(TAU)), aes(TAU, K, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU != 0 | !is.na(TAU))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, AB1_ratio != 0 | !is.na(AB1_ratio)), aes(K, AB1_ratio, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, AB1_ratio != 0 | !is.na(AB1_ratio))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, TAU_AB1_42_ratio != 0 | !is.na(TAU_AB1_42_ratio)), aes(K, TAU_AB1_42_ratio, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth( se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU_AB1_42_ratio != 0 | !is.na(TAU_AB1_42_ratio))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, TAU_AB1_ratio != 0 | !is.na(TAU_AB1_ratio)), aes(K, TAU_AB1_ratio, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU_AB1_ratio != 0 | !is.na(TAU_AB1_ratio))$SUBJ)))

```

Avg Thickness:
```{r clincal data logAvgThickness, eval=FALSE, include=FALSE}

ggplot(data = filter(dados_hemi_v1, Lipoxina != 0 | !is.na(Lipoxina)), aes(logAvgThickness, Lipoxina, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, Lipoxina != 0 | !is.na(Lipoxina))$SUBJ))) 

ggplot(data = filter(dados_hemi_v1, COGNlogAvgThicknessTlogAvgThicknessVE_logAvgThicknessNDEX != 0 | !is.na(COGNlogAvgThicknessTlogAvgThicknessVE_logAvgThicknessNDEX)), aes(logAvgThickness, COGNlogAvgThicknessTlogAvgThicknessVE_logAvgThicknessNDEX,  color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, COGNlogAvgThicknessTlogAvgThicknessVE_logAvgThicknessNDEX != 0 | !is.na(COGNlogAvgThicknessTlogAvgThicknessVE_logAvgThicknessNDEX))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `A7/A5` != 0 | !is.na(`A7/A5`)), aes(logAvgThickness,`A7/A5`, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `A7/A5` != 0 | !is.na(`A7/A5`))$SUBJ))) +
  

ggplot(data = filter(dados_hemi_v1, `TMT B-A` != 0 | !is.na(`TMT B-A`)), aes(logAvgThickness,`TMT B-A`, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `TMT B-A` != 0 | !is.na(`TMT B-A`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, relogio != 0 | !is.na(relogio)), aes(logAvgThickness, relogio, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, relogio != 0 | !is.na(relogio))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `DlogAvgThicknessGlogAvgThicknessT SPAN BAClogAvgThickness` != 0 | !is.na(`DlogAvgThicknessGlogAvgThicknessT SPAN BAClogAvgThickness`)), aes(logAvgThickness, `DlogAvgThicknessGlogAvgThicknessT SPAN BAClogAvgThickness`, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `DlogAvgThicknessGlogAvgThicknessT SPAN BAClogAvgThickness` != 0 | !is.na(`DlogAvgThicknessGlogAvgThicknessT SPAN BAClogAvgThickness`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `AB1-40` != 0 | !is.na(`AB1-40`)), aes(`AB1-40`, logAvgThickness, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `AB1-40` != 0 | !is.na(`AB1-40`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `AB1-42` != 0 | !is.na(`AB1-42`)), aes(logAvgThickness, `AB1-42`, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `AB1-42` != 0 | !is.na(`AB1-42`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, TAU != 0 | !is.na(TAU)), aes(TAU, logAvgThickness, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU != 0 | !is.na(TAU))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, AB1_ratio != 0 | !is.na(AB1_ratio)), aes(logAvgThickness, AB1_ratio, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, AB1_ratio != 0 | !is.na(AB1_ratio))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, TAU_AB1_42_ratio != 0 | !is.na(TAU_AB1_42_ratio)), aes(logAvgThickness, TAU_AB1_42_ratio, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU_AB1_42_ratio != 0 | !is.na(TAU_AB1_42_ratio))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, TAU_AB1_ratio != 0 | !is.na(TAU_AB1_ratio)), aes(logAvgThickness, TAU_AB1_ratio, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU_AB1_ratio != 0 | !is.na(TAU_AB1_ratio))$SUBJ)))

```

S:

```{r clincal data S, eval=FALSE, include=FALSE}

ggplot(data = filter(dados_hemi_v1, Lipoxina != 0 | !is.na(Lipoxina)), aes(S, Lipoxina, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, Lipoxina != 0 | !is.na(Lipoxina))$SUBJ))) 

ggplot(data = filter(dados_hemi_v1, COGNSTSVE_SNDEX != 0 | !is.na(COGNSTSVE_SNDEX)), aes(S, COGNSTSVE_SNDEX,  color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, COGNSTSVE_SNDEX != 0 | !is.na(COGNSTSVE_SNDEX))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `A7/A5` != 0 | !is.na(`A7/A5`)), aes(S,`A7/A5`, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `A7/A5` != 0 | !is.na(`A7/A5`))$SUBJ))) +
  

ggplot(data = filter(dados_hemi_v1, `TMT B-A` != 0 | !is.na(`TMT B-A`)), aes(S,`TMT B-A`, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `TMT B-A` != 0 | !is.na(`TMT B-A`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, relogio != 0 | !is.na(relogio)), aes(S, relogio, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, relogio != 0 | !is.na(relogio))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `DSGST SPAN BACS` != 0 | !is.na(`DSGST SPAN BACS`)), aes(S, `DSGST SPAN BACS`, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `DSGST SPAN BACS` != 0 | !is.na(`DSGST SPAN BACS`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `AB1-40` != 0 | !is.na(`AB1-40`)), aes(`AB1-40`, S, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `AB1-40` != 0 | !is.na(`AB1-40`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `AB1-42` != 0 | !is.na(`AB1-42`)), aes(S, `AB1-42`, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `AB1-42` != 0 | !is.na(`AB1-42`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, TAU != 0 | !is.na(TAU)), aes(TAU, S, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU != 0 | !is.na(TAU))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, AB1_ratio != 0 | !is.na(AB1_ratio)), aes(S, AB1_ratio, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, AB1_ratio != 0 | !is.na(AB1_ratio))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, TAU_AB1_42_ratio != 0 | !is.na(TAU_AB1_42_ratio)), aes(S, TAU_AB1_42_ratio, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU_AB1_42_ratio != 0 | !is.na(TAU_AB1_42_ratio))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, TAU_AB1_ratio != 0 | !is.na(TAU_AB1_ratio)), aes(S, TAU_AB1_ratio, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU_AB1_ratio != 0 | !is.na(TAU_AB1_ratio))$SUBJ)))

```

I:
```{r clincal data I, eval=FALSE, include=FALSE}

ggplot(data = filter(dados_hemi_v1, Lipoxina != 0 | !is.na(Lipoxina)), aes(I, Lipoxina, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, Lipoxina != 0 | !is.na(Lipoxina))$SUBJ))) 

ggplot(data = filter(dados_hemi_v1, COGNITIVE_INDEX != 0 | !is.na(COGNITIVE_INDEX)), aes(I, COGNITIVE_INDEX,  color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, COGNITIVE_INDEX != 0 | !is.na(COGNITIVE_INDEX))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `A7/A5` != 0 | !is.na(`A7/A5`)), aes(I,`A7/A5`, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `A7/A5` != 0 | !is.na(`A7/A5`))$SUBJ))) +
  

ggplot(data = filter(dados_hemi_v1, `TMT B-A` != 0 | !is.na(`TMT B-A`)), aes(I,`TMT B-A`, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `TMT B-A` != 0 | !is.na(`TMT B-A`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, relogio != 0 | !is.na(relogio)), aes(I, relogio, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, relogio != 0 | !is.na(relogio))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `DIGIT SPAN BACI` != 0 | !is.na(`DIGIT SPAN BACI`)), aes(I, `DIGIT SPAN BACI`, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `DIGIT SPAN BACI` != 0 | !is.na(`DIGIT SPAN BACI`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `AB1-40` != 0 | !is.na(`AB1-40`)), aes(`AB1-40`, I, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `AB1-40` != 0 | !is.na(`AB1-40`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `AB1-42` != 0 | !is.na(`AB1-42`)), aes(I, `AB1-42`, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `AB1-42` != 0 | !is.na(`AB1-42`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, TAU != 0 | !is.na(TAU)), aes(TAU, I, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU != 0 | !is.na(TAU))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, AB1_ratio != 0 | !is.na(AB1_ratio)), aes(I, AB1_ratio, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, AB1_ratio != 0 | !is.na(AB1_ratio))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, TAU_AB1_42_ratio != 0 | !is.na(TAU_AB1_42_ratio)), aes(I, TAU_AB1_42_ratio, color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU_AB1_42_ratio != 0 | !is.na(TAU_AB1_42_ratio))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, TAU_AB1_ratio != 0 | !is.na(TAU_AB1_ratio)), aes(I, TAU_AB1_ratio, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU_AB1_ratio != 0 | !is.na(TAU_AB1_ratio))$SUBJ)))

```

### clinical data - CORRELATION AND COVARIATION

```{r corr cov hemi, include=FALSE}

Corr_cov1 <- dados_hemi_v1_CD_behaviour %>%
  group_by(morphological_parameter, clinical_test) %>%
summarise(
    t = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$statistic,2),
    df =  signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$parameter,2),
    Correlation = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,2),
    cor.conf.low = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[1],2),
    cor.conf.high = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[2],2),
    pvalue = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,4),
    eff.size = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$d,2),
    eff.size.conf.low = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$l.d,2),
    eff.size.conf.high = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$u.d,2),
    Covariance = signif(cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson"),2)) %>% 
  mutate(Diagnostic = "All", ROI = "Hemisphere", kind = "behaviour", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))


Corr_cov2 <- dados_hemi_v1_CD_behaviour %>%
  group_by(Diagnostic, morphological_parameter, clinical_test) %>%
summarise(
    t = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$statistic,2),
    df =  signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$parameter,2),
    Correlation = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,2),
    cor.conf.low = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[1],2),
    cor.conf.high = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[2],2),
    pvalue = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,4),
    eff.size = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$d,2),
    eff.size.conf.low = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$l.d,2),
    eff.size.conf.high = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$u.d,2),
    Covariance = signif(cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson"),2)) %>% 
  mutate(ROI = "Hemisphere", kind = "behaviour", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))

Corr_cov3 <- dados_hemi_v1_CD_biochq %>%
  group_by(morphological_parameter, clinical_test) %>%
summarise(
    t = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$statistic,2),
    df =  signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$parameter,2),
    Correlation = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,2),
    cor.conf.low = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[1],2),
    cor.conf.high = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[2],2),
    pvalue = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,4),
    eff.size = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$d,2),
    eff.size.conf.low = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$l.d,2),
    eff.size.conf.high = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$u.d,2),
    Covariance = signif(cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson"),2)) %>% 
  mutate(Diagnostic = "All", ROI = "Hemisphere", kind = "behaviour", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))

Corr_cov4 <- dados_hemi_v1_CD_biochq %>%
  group_by(Diagnostic, morphological_parameter, clinical_test) %>%
summarise(
    t = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$statistic,2),
    df =  signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$parameter,2),
    Correlation = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,2),
    cor.conf.low = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[1],2),
    cor.conf.high = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[2],2),
    pvalue = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,4),
    eff.size = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$d,2),
    eff.size.conf.low = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$l.d,2),
    eff.size.conf.high = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$u.d,2),
    Covariance = signif(cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson"),2)) %>% mutate(ROI = "Hemisphere", kind = "biochemical", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))

Corr_cov_all <- full_join(Corr_cov1, Corr_cov3)
Corr_cov_diag <- full_join(Corr_cov2, Corr_cov4)

Corr_cov_all %>% dplyr::select(-c(cor.conf.low,cor.conf.high, Covariance,kind )) %>% kable(digits = 2) %>% kable_styling()
#Corr_cov_diag %>% kable(digits = 2) %>% kable_styling()
```

```{r corr cov lobo frontal ,include=FALSE}

Corr_cov5 <- filter(dados_lobos_v1_F_CD_behaviour, clinical_test == "TMT B-A" | clinical_test == "relogio" | clinical_test == "DIGIT SPAN BACK") %>%
  group_by(morphological_parameter, clinical_test) %>%
summarise(
    t = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$statistic,2),
    df =  signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$parameter,2),
    Correlation = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,2),
    cor.conf.low = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[1],2),
    cor.conf.high = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[2],2),
    pvalue = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,4),
    eff.size = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$d,2),
    eff.size.conf.low = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$l.d,2),
    eff.size.conf.high = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$u.d,2),
    Covariance = signif(cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson"),2)) %>%  mutate(Diagnostic = "All", ROI = "Frontal lobe", kind = "behaviour", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))

Corr_cov6 <- filter(dados_lobos_v1_F_CD_behaviour, clinical_test == "TMT B-A" | clinical_test == "relogio" | clinical_test == "DIGIT SPAN BACK") %>%
  group_by(Diagnostic, morphological_parameter, clinical_test) %>%
summarise(
    t = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$statistic,2),
    df =  signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$parameter,2),
    Correlation = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,2),
    cor.conf.low = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[1],2),
    cor.conf.high = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[2],2),
    pvalue = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,4),
    eff.size = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$d,2),
    eff.size.conf.low = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$l.d,2),
    eff.size.conf.high = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$u.d,2),
    Covariance = signif(cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson"),2)) %>%  mutate(ROI = "Frontal lobe", kind = "behaviour", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))

# Corr_cov7 <- dados_lobos_v1_F_CD_biochq %>%
#   group_by(morphological_parameter, clinical_test) %>%
#   summarise(
#     Correlation = cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,
#     pvalue = cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,
#     Covariance = cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")
#   ) %>% mutate(Diagnostic = "All", ROI = "Frontal lobe", kind = "behaviour", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))
# 
# Corr_cov8 <- dados_lobos_v1_F_CD_biochq %>%
#   group_by(Diagnostic, morphological_parameter, clinical_test) %>%
#   summarise(
#     Correlation = cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,
#     pvalue = cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,
#     Covariance = cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")
#   ) %>% mutate(ROI = "Frontal lobe", kind = "biochemical", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))

Corr_cov_all <- full_join(Corr_cov_all, Corr_cov5)
Corr_cov_diag <- full_join(Corr_cov_diag, Corr_cov6)


filter(Corr_cov_all, ROI == "Frontal lobe")%>% dplyr::select(-c(cor.conf.low,cor.conf.high, Covariance,kind ))  %>% kable(digits = 2) %>% kable_styling()
#filter(Corr_cov_diag, ROI == "Frontal lobe") %>% kable(digits = 2) %>% kable_styling()
```

```{r corr cov lobo parietal, include=FALSE}

Corr_cov9 <- filter(dados_lobos_v1_P_CD_behaviour, clinical_test == "relogio") %>%
  group_by(morphological_parameter, clinical_test) %>%
summarise(
    t = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$statistic,2),
    df =  signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$parameter,2),
    Correlation = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,2),
    cor.conf.low = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[1],2),
    cor.conf.high = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[2],2),
    pvalue = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,4),
    eff.size = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$d,2),
    eff.size.conf.low = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$l.d,2),
    eff.size.conf.high = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$u.d,2),
    Covariance = signif(cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson"),2)) %>%  mutate(Diagnostic = "All", ROI = "Parietal lobe", kind = "behaviour", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))

Corr_cov10 <- filter(dados_lobos_v1_P_CD_behaviour, clinical_test == "relogio") %>%
  group_by(Diagnostic, morphological_parameter, clinical_test) %>%
summarise(
    t = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$statistic,2),
    df =  signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$parameter,2),
    Correlation = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,2),
    cor.conf.low = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[1],2),
    cor.conf.high = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[2],2),
    pvalue = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,4),
    eff.size = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$d,2),
    eff.size.conf.low = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$l.d,2),
    eff.size.conf.high = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$u.d,2),
    Covariance = signif(cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson"),2)) %>%  mutate(ROI = "Parietal lobe", kind = "behaviour", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))

# Corr_cov11 <- dados_lobos_v1_P_CD_biochq %>%
#   group_by(morphological_parameter, clinical_test) %>%
#   summarise(
#     Correlation = cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,
#     pvalue = cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,
#     Covariance = cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")
#   ) %>% mutate(Diagnostic = "All", ROI = "Parietal lobe", kind = "behaviour", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))
# 
# Corr_cov12 <- dados_lobos_v1_P_CD_biochq %>%
#   group_by(Diagnostic, morphological_parameter, clinical_test) %>%
#   summarise(
#     Correlation = cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,
#     pvalue = cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,
#     Covariance = cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")
#   ) %>% mutate(ROI = "Parietal lobe", kind = "biochemical", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))

Corr_cov_all <- full_join(Corr_cov_all, Corr_cov9)
Corr_cov_diag <- full_join(Corr_cov_diag, Corr_cov10)

filter(Corr_cov_all, ROI == "Parietal lobe")%>% dplyr::select(-c(cor.conf.low,cor.conf.high, Covariance,kind ))  %>% kable(digits = 2) %>% kable_styling()

#filter(Corr_cov_diag, ROI == "Parietal lobe") %>% kable(digits = 2) %>% kable_styling()
```

```{r corr cov lobo ocipital ,include=FALSE}

Corr_cov13 <- filter(dados_lobos_v1_O_CD_behaviour, clinical_test == "relogio") %>%
  group_by(morphological_parameter, clinical_test) %>%
summarise(
    t = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$statistic,2),
    df =  signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$parameter,2),
    Correlation = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,2),
    cor.conf.low = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[1],2),
    cor.conf.high = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[2],2),
    pvalue = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,4),
    eff.size = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$d,2),
    eff.size.conf.low = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$l.d,2),
    eff.size.conf.high = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$u.d,2),
    Covariance = signif(cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson"),2)) %>% 
  mutate(Diagnostic = "All", ROI = "Occipital lobe", kind = "behaviour", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))

Corr_cov14 <- filter(dados_lobos_v1_O_CD_behaviour, clinical_test == "relogio") %>%
  group_by(Diagnostic, morphological_parameter, clinical_test) %>%
summarise(
    t = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$statistic,2),
    df =  signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$parameter,2),
    Correlation = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,2),
    cor.conf.low = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[1],2),
    cor.conf.high = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[2],2),
    pvalue = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,4),
    eff.size = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$d,2),
    eff.size.conf.low = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$l.d,2),
    eff.size.conf.high = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$u.d,2),
    Covariance = signif(cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson"),2)) %>% 
  mutate(ROI = "Occipital lobe", kind = "behaviour", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))

# Corr_cov15 <- dados_lobos_v1_O_CD_biochq %>%
#   group_by(morphological_parameter, clinical_test) %>%
#   summarise(
#     Correlation = cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,
#     pvalue = cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,
#     Covariance = cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")
#   ) %>% mutate(Diagnostic = "All", ROI = "Occipital lobe", kind = "behaviour", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))
# 
# Corr_cov16 <- dados_lobos_v1_O_CD_biochq %>%
#   group_by(Diagnostic, morphological_parameter, clinical_test) %>%
#   summarise(
#     Correlation = cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,
#     pvalue = cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,
#     Covariance = cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")
#   ) %>% mutate(ROI = "Occipital lobe", kind = "biochemical", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))

Corr_cov_all <- full_join(Corr_cov_all, Corr_cov13)
Corr_cov_diag <- full_join(Corr_cov_diag, Corr_cov14)

filter(Corr_cov_all, ROI == "Occipital lobe")%>% dplyr::select(-c(cor.conf.low,cor.conf.high, Covariance,kind ))  %>% kable(digits = 2) %>% kable_styling()

#filter(Corr_cov_diag, ROI == "Occipital lobe") %>% kable(digits = 2) %>% kable_styling()
```

```{r corr cov lobo temporal ,include=FALSE}

Corr_cov17 <- filter(dados_lobos_v1_T_CD_behaviour, clinical_test == "A7/A5") %>%
  group_by(morphological_parameter, clinical_test) %>%
summarise(
    t = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$statistic,2),
    df =  signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$parameter,2),
    Correlation = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,2),
    cor.conf.low = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[1],2),
    cor.conf.high = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[2],2),
    pvalue = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,4),
    eff.size = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$d,2),
    eff.size.conf.low = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$l.d,2),
    eff.size.conf.high = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$u.d,2),
    Covariance = signif(cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson"),2)) %>%  mutate(Diagnostic = "All", ROI = "Temporal lobe", kind = "behaviour", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))

Corr_cov18 <- filter(dados_lobos_v1_T_CD_behaviour, clinical_test == "A7/A5") %>%
  group_by(Diagnostic, morphological_parameter, clinical_test) %>%
summarise(
    t = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$statistic,2),
    df =  signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$parameter,2),
    Correlation = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,2),
    cor.conf.low = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[1],2),
    cor.conf.high = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$conf.int[2],2),
    pvalue = signif(cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,4),
    eff.size = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$d,2),
    eff.size.conf.low = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$l.d,2),
    eff.size.conf.high = signif(res(Correlation, var.r = NULL,(df+2)/2, level = 95, dig = 2, verbose = FALSE)$u.d,2),
    Covariance = signif(cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson"),2)) %>% mutate(ROI = "Temporal lobe", kind = "behaviour", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))

# Corr_cov19 <- dados_lobos_v1_T_CD_biochq %>%
#   group_by(morphological_parameter, clinical_test) %>%
#   summarise(
#     Correlation = cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,
#     pvalue = cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,
#     Covariance = cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")
#   ) %>% mutate(Diagnostic = "All", ROI = "Temporal lobe", kind = "behaviour", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))
# 
# Corr_cov20 <- dados_lobos_v1_T_CD_biochq %>%
#   group_by(Diagnostic, morphological_parameter, clinical_test) %>%
#   summarise(
#     Correlation = cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$estimate,
#     pvalue = cor.test(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")$p.value,
#     Covariance = cov(morphological_parameter_value, clinical_test_value, use = "complete", method = "pearson")
#   ) %>% mutate(ROI = "Temporal lobe", kind = "biochemical", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))

Corr_cov_all <- full_join(Corr_cov_all, Corr_cov17)
Corr_cov_diag <- full_join(Corr_cov_diag, Corr_cov18)

filter(Corr_cov_all, ROI == "Temporal lobe")%>% dplyr::select(-c(cor.conf.low,cor.conf.high, Covariance,kind ))  %>% kable(digits = 2) %>% kable_styling()

#filter(Corr_cov_diag, ROI == "Temporal lobe") %>% kable(digits = 2) %>% kable_styling()
```

```{r echo=FALSE, warning=TRUE}


Corr_cov_all$morphological_parameter[Corr_cov_all$morphological_parameter == "K_corrected"] <- "K"
Corr_cov_all$morphological_parameter[Corr_cov_all$morphological_parameter == "I_corrected"] <- "I"
Corr_cov_all$morphological_parameter[Corr_cov_all$morphological_parameter == "S_corrected"] <- "S"

Corr_cov_all$morphological_parameter[Corr_cov_all$morphological_parameter == "K_age_decay"] <- "K"
Corr_cov_all$morphological_parameter[Corr_cov_all$morphological_parameter == "I_age_decay"] <- "I"
Corr_cov_all$morphological_parameter[Corr_cov_all$morphological_parameter == "S_age_decay"] <- "S"
Corr_cov_all$morphological_parameter[Corr_cov_all$morphological_parameter == "S_age_decay"] <- "S"
Corr_cov_all$morphological_parameter[Corr_cov_all$morphological_parameter == "logAvgThickness_age_decay"] <- "logAvgThickness"

Corr_cov_diag$morphological_parameter[Corr_cov_diag$morphological_parameter == "K_corrected"] <- "K"
Corr_cov_diag$morphological_parameter[Corr_cov_diag$morphological_parameter == "I_corrected"] <- "I"
Corr_cov_diag$morphological_parameter[Corr_cov_diag$morphological_parameter == "S_corrected"] <- "S"

Corr_cov_diag$morphological_parameter[Corr_cov_diag$morphological_parameter == "K_age_decay"] <- "K"
Corr_cov_diag$morphological_parameter[Corr_cov_diag$morphological_parameter == "I_age_decay"] <- "I"
Corr_cov_diag$morphological_parameter[Corr_cov_diag$morphological_parameter == "S_age_decay"] <- "S"
Corr_cov_diag$morphological_parameter[Corr_cov_diag$morphological_parameter == "S_age_decay"] <- "S"
Corr_cov_diag$morphological_parameter[Corr_cov_diag$morphological_parameter == "logAvgThickness_age_decay"] <- "logAvgThickness"

Corr_cov_all <- Corr_cov_all %>% group_by(morphological_parameter, clinical_test) %>% mutate(pval.adj = p.adjust (pvalue, method='bonferroni'))
Corr_cov_diag <- Corr_cov_diag %>% group_by(morphological_parameter, clinical_test) %>% mutate(pval.adj = p.adjust (pvalue, method='bonferroni'))

filter(Corr_cov_all, morphological_parameter == "K" | morphological_parameter == "logAvgThickness") %>% dplyr::select(-c(cor.conf.low,cor.conf.high, Covariance,kind,Diagnostic,pvalue)) %>% kable(digits = 3) %>% kable_styling()
#filter(Corr_cov_diag, morphological_parameter == "K" | morphological_parameter == "logAvgThickness") %>% dplyr::select(-c(cor.conf.low,cor.conf.high, Covariance,kind )) %>% kable(digits = 2) %>% kable_styling()

#  ggplot(filter(Corr_cov_all, clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "A7/A5" | clinical_test == "relogio", Diagnostic == "All"), aes(x = clinical_test, y = Correlation, color = morphological_parameter, fill = morphological_parameter, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ROI, labeller = label_both)
 
# ggplot(filter(Corr_cov_all, clinical_test == "Lipoxina" | clinical_test == "AB1-40" | clinical_test == "AB1-42" | clinical_test == "TAU" | clinical_test == "AB1_ratio" | clinical_test == "TAU_AB1_42_ratio" | clinical_test == "TAU_AB1_ratio", Diagnostic == "All"), aes(x = clinical_test, y = Correlation, color = morphological_parameter, fill = morphological_parameter, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ROI, labeller = label_both)

#  ggplot(filter(Corr_cov_all, clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "A7/A5" | clinical_test == "relogio", Diagnostic == "All"), aes(x = clinical_test, y = Correlation, color = morphological_parameter, fill = morphological_parameter, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ROI, labeller = label_both)
 
#  ggplot(filter(Corr_cov_all, clinical_test == "Lipoxina" | clinical_test == "AB1-40" | clinical_test == "AB1-42" | clinical_test == "TAU" | clinical_test == "AB1_ratio" | clinical_test == "TAU_AB1_42_ratio" | clinical_test == "TAU_AB1_ratio", Diagnostic == "All"), aes(x = clinical_test, y = Correlation, color = morphological_parameter, fill = morphological_parameter, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ROI, labeller = label_both)

```

K:
```{r corr cov K, eval=FALSE, include=FALSE}

filter(Corr_cov_filter, morphological_parameter == "K") %>% dplyr::select(-c(cor.conf.low,cor.conf.high, Covariance,kind )) %>% t() %>% kable(digits = 2) %>% kable_styling()
filter(Corr_cov_filter, morphological_parameter == "K", pval.adj < 0.05) %>% dplyr::select(-c(cor.conf.low,cor.conf.high, Covariance,kind )) %>% t() %>% kable(digits = 2) %>% kable_styling()


ggplot(filter(Corr_cov, clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "A7/A5" | clinical_test == "relogio", morphological_parameter == "K", Diagnostic == "All"), aes(x = clinical_test, y = Correlation, color = ROI, fill = ROI, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)

ggplot(filter(Corr_cov, clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "A7/A5" | clinical_test == "relogio", ROI == "Hemisphere", morphological_parameter == "K"), aes(x = clinical_test, y = Correlation, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)

ggplot(filter(Corr_cov_filter, clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "A7/A5" | clinical_test == "relogio", morphological_parameter == "K", Diagnostic == "All"), aes(x = clinical_test, y = Correlation, color = ROI, fill = ROI, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)

ggplot(filter(Corr_cov_filter, clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "A7/A5" | clinical_test == "relogio", ROI == "Hemisphere", morphological_parameter == "K"), aes(x = clinical_test, y = Correlation, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)

 
ggplot(filter(Corr_cov, clinical_test == "Lipoxina" | clinical_test == "AB1-40" | clinical_test == "AB1-42" | clinical_test == "TAU" | clinical_test == "AB1_ratio" | clinical_test == "TAU_AB1_42_ratio" | clinical_test == "TAU_AB1_ratio", morphological_parameter == "K", Diagnostic == "All"), aes(x = clinical_test, y = Correlation, color = ROI, fill = ROI, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)

ggplot(filter(Corr_cov, clinical_test == "Lipoxina" | clinical_test == "AB1-40" | clinical_test == "AB1-42" | clinical_test == "TAU" | clinical_test == "AB1_ratio" | clinical_test == "TAU_AB1_42_ratio" | clinical_test == "TAU_AB1_ratio", ROI == "Hemisphere", morphological_parameter == "K"), aes(x = clinical_test, y = Correlation, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)

  
```

Avg Thickness:
```{r corr Covariance AvgThickness, eval=FALSE, include=FALSE}

filter(Corr_cov_filter, morphological_parameter == "logAvgThickness") %>% dplyr::select(-c(cor.conf.low,cor.conf.high, Covariance,kind )) %>% t() %>% kable(digits = 2) %>% kable_styling()
filter(Corr_cov_filter , morphological_parameter == "logAvgThickness", pval.adj < 0.05) %>% dplyr::select(-c(cor.conf.low,cor.conf.high, Covariance,kind )) %>% t() %>% kable(digits = 2) %>% kable_styling()


ggplot(filter(Corr_cov, clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "A7/A5" | clinical_test == "relogio", morphological_parameter == "logAvgThickness", Diagnostic == "All"), aes(x = clinical_test, y = Correlation, color = ROI, fill = ROI, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)

ggplot(filter(Corr_cov, clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "A7/A5" | clinical_test == "relogio", morphological_parameter == "logAvgThickness", ROI == "Hemisphere"), aes(x = clinical_test, y = Correlation, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)
 
ggplot(filter(Corr_cov_filter, clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "A7/A5" | clinical_test == "relogio", morphological_parameter == "logAvgThickness", Diagnostic == "All"), aes(x = clinical_test, y = Correlation, color = ROI, fill = ROI, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)

ggplot(filter(Corr_cov_filter, clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "A7/A5" | clinical_test == "relogio", morphological_parameter == "logAvgThickness", ROI == "Hemisphere"), aes(x = clinical_test, y = Correlation, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)
 

ggplot(filter(Corr_cov, clinical_test == "Lipoxina" | clinical_test == "AB1-40" | clinical_test == "AB1-42" | clinical_test == "TAU" | clinical_test == "AB1_ratio" | clinical_test == "TAU_AB1_42_ratio" | clinical_test == "TAU_AB1_ratio" , morphological_parameter == "logAvgThickness", Diagnostic == "All"), aes(x = clinical_test, y = Correlation, color = ROI, fill = ROI, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)

ggplot(filter(Corr_cov, clinical_test == "Lipoxina" | clinical_test == "AB1-40" | clinical_test == "AB1-42" | clinical_test == "TAU" | clinical_test == "AB1_ratio" | clinical_test == "TAU_AB1_42_ratio" | clinical_test == "TAU_AB1_ratio" , morphological_parameter == "logAvgThickness", ROI == "Hemisphere"), aes(x = clinical_test, y = Correlation, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)

```

S: 
```{r corr Covariance S, eval=FALSE, include=FALSE}

filter(Corr_cov, morphological_parameter == "S") %>% t() %>% kable(digits = 2) %>% kable_styling()
filter(Corr_cov, morphological_parameter == "S", pval.adj < 0.05) %>% t() %>% kable(digits = 2) %>% kable_styling()


 ggplot(filter(Corr_cov, clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "A7/A5" | clinical_test == "relogio", morphological_parameter == "S", Diagnostic == "All"), aes(x = clinical_test, y = Correlation, color = ROI, fill = ROI, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)

 ggplot(filter(Corr_cov, clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "A7/A5" | clinical_test == "relogio", morphological_parameter == "S", ROI == "Hemisphere"), aes(x = clinical_test, y = Correlation, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both) 
  
  ggplot(filter(Corr_cov, clinical_test == "Lipoxina" | clinical_test == "AB1-40" | clinical_test == "AB1-42" | clinical_test == "TAU" | clinical_test == "AB1_ratio" | clinical_test == "TAU_AB1_42_ratio" | clinical_test == "TAU_AB1_ratio" , morphological_parameter == "S", Diagnostic == "All", ROI == "Hemisphere"), aes(x = clinical_test, y = Correlation, color = ROI, fill = ROI, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)
  
ggplot(filter(Corr_cov, clinical_test == "Lipoxina" | clinical_test == "AB1-40" | clinical_test == "AB1-42" | clinical_test == "TAU" | clinical_test == "AB1_ratio" | clinical_test == "TAU_AB1_42_ratio" | clinical_test == "TAU_AB1_ratio" , morphological_parameter == "S", ROI == "Hemisphere"), aes(x = clinical_test, y = Correlation, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)
```

I: 
```{r corr Covariance I, eval=FALSE, include=FALSE}

filter(Corr_cov, morphological_parameter == "I") %>% t() %>% kable(digits = 2) %>% kable_styling()
filter(Corr_cov, morphological_parameter == "I", pval.adj < 0.05) %>% t() %>% kable(digits = 2) %>% kable_styling()


 ggplot(filter(Corr_cov, clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "A7/A5" | clinical_test == "relogio", morphological_parameter == "I", Diagnostic == "All"), aes(x = clinical_test, y = Correlation, color = ROI, fill = ROI, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)

 ggplot(filter(Corr_cov, clinical_test == "COGNITIVE_INDEX" | clinical_test == "TMT B-A" | clinical_test == "A7/A5" | clinical_test == "relogio", morphological_parameter == "I", ROI == "Hemisphere"), aes(x = clinical_test, y = Correlation, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both) 
  
  ggplot(filter(Corr_cov, clinical_test == "Lipoxina" | clinical_test == "AB1-40" | clinical_test == "AB1-42" | clinical_test == "TAU" | clinical_test == "AB1_ratio" | clinical_test == "TAU_AB1_42_ratio" | clinical_test == "TAU_AB1_ratio", morphological_parameter == "I" , Diagnostic == "All"), aes(x = clinical_test, y = Correlation, color = ROI, fill = ROI, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)
  
  ggplot(filter(Corr_cov, clinical_test == "Lipoxina" | clinical_test == "AB1-40" | clinical_test == "AB1-42" | clinical_test == "TAU" | clinical_test == "AB1_ratio" | clinical_test == "TAU_AB1_42_ratio" | clinical_test == "TAU_AB1_ratio", morphological_parameter == "I", ROI == "Hemisphere"), aes(x = clinical_test, y = Correlation, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + geom_col(position = "dodge") + geom_text(aes(label = ifelse(pval.adj < 0.05, "*", "")), color = "black", position = position_dodge(width = 1)) + theme_pubr() + facet_grid(Age_correction ~ ., labeller = label_both)
  
```


### clinical data - ancova

```{r clinical data - ancova, eval=FALSE, warning=FALSE, include=FALSE, messAge=FALSE, pAged.print=TRUE}

ggplot(data = dados_hemi_v1, aes(K, COGNITIVE_INDEX, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("Global, N = ", n_distinct(filter(dados_hemi_v1, !is.na(COGNITIVE_INDEX))$SUBJ)))

model1.0 <- lm(COGNITIVE_INDEX ~ K, data = dados_hemi_v1)
summary(model1.0)

model1.1 <- lm(COGNITIVE_INDEX ~ K*Diagnostic*Age*ESC, data = dados_hemi_v1)
Anova(model1.1, type="II") %>% kable(digits = 2) %>% kable_styling()
model1.2 <- lm(COGNITIVE_INDEX ~ K + Diagnostic + Age + ESC, data = dados_hemi_v1)
Anova(model1.2, type="II") %>% kable(digits = 2) %>% kable_styling()
summary(model1.2)


hist(residuals(model1.2),
     col="darkgray")
plot(fitted(model1.2),
     residuals(model1.2))

anova(model1.1,model1.2) %>% kable(digits = 2) %>% kable_styling()
etaSquared(model1.2) %>% kable(digits = 2) %>% kable_styling()


ggplot(data = dados_lobos_v1_F, aes(K_corrected, `TMT B-A`, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("Lobo frontal, N = ", n_distinct(filter(dados_lobos_v1_F, !is.na(`TMT B-A`))$SUBJ)))

model2.0 <- lm(`TMT B-A` ~ K_corrected, data = dados_lobos_v1_F)
summary(model2.0)


model2.1 <- lm(`TMT B-A` ~ K_corrected*Diagnostic*Age*ESC, data = dados_lobos_v1_F)
Anova(model2.1, type="II") %>% kable(digits = 2) %>% kable_styling()
model2.2 <- lm(`TMT B-A` ~ K_corrected + Diagnostic + Age + ESC, data = dados_lobos_v1_F)
Anova(model2.2, type="II") %>% kable(digits = 2) %>% kable_styling()
summary(model2.2)

hist(residuals(model2.2),
     col="darkgray")
plot(fitted(model2.2),
     residuals(model2.2))


anova(model2.1,model2.2) %>% kable(digits = 2) %>% kable_styling()
etaSquared(model2.2) %>% kable(digits = 2) %>% kable_styling()

ggplot(data = dados_lobos_v1_T, aes(K_corrected, `A7/A5`, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("Lobo temporal, N = ", n_distinct(filter(dados_lobos_v1_T, !is.na(`A7/A5`))$SUBJ)))

model3.0 <- lm(`A7/A5` ~ K_corrected, data = dados_lobos_v1_T)
summary(model3.0)

model3.1 <- lm(`A7/A5` ~ K_corrected*Diagnostic*Age*ESC, data = dados_lobos_v1_T)
Anova(model3.1, type="II") %>% kable(digits = 2) %>% kable_styling()

model3.2 <- lm(`A7/A5` ~ K_corrected + Diagnostic + Age + ESC, data = dados_lobos_v1_T)
Anova(model3.2, type="II") %>% kable(digits = 2) %>% kable_styling()
summary(model3.2)


hist(residuals(model3.2),
     col="darkgray")
plot(fitted(model3.2),
     residuals(model3.2))


anova(model3.1,model3.2) %>% kable(digits = 2) %>% kable_styling()
etaSquared(model3.2) %>% kable(digits = 2) %>% kable_styling()


ggplot(data = dados_lobos_v1_F, aes(K_corrected, relogio, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("Lobo frontal, N = ", n_distinct(filter(dados_lobos_v1_F, !is.na(relogio))$SUBJ)))

model4.0 <- lm(relogio ~ K_corrected, data = dados_lobos_v1_F)
summary(model4.0)

model4.1<- lm(relogio ~ K_corrected*Diagnostic*Age*ESC, data = dados_lobos_v1_F)
Anova(model4.1, type="II") %>% kable(digits = 2) %>% kable_styling()

model4.2 <- lm(relogio ~ K_corrected + Diagnostic + Age + ESC, data = dados_lobos_v1_F)
Anova(model4.2, type="II") %>% kable(digits = 2) %>% kable_styling()
summary(model4.2)


hist(residuals(model4.2),
     col="darkgray")
plot(fitted(model4.2),
     residuals(model4.2))

anova(model4.1,model4.2) %>% kable(digits = 2) %>% kable_styling()
etaSquared(model4.2) %>% kable(digits = 2) %>% kable_styling()

ggplot(data = dados_lobos_v1_O, aes(K_corrected, relogio, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("Lobo ocipital, N = ", n_distinct(filter(dados_lobos_v1_O, !is.na(relogio))$SUBJ)))

model4.0.1 <- lm(relogio ~ K_corrected, data = dados_lobos_v1_O)
summary(model4.0.1)
cor.test(y = dados_lobos_v1_O$relogio, x = dados_lobos_v1_O$K_corrected, use = "complete", method = "pearson")
cov(y = dados_lobos_v1_O$relogio, x = dados_lobos_v1_O$K_corrected, use = "complete", method = "pearson")

model4.3 <- lm(relogio ~ K_corrected *Diagnostic*Age*ESC, data = dados_lobos_v1_O)
Anova(model4.3, type="II") %>% kable(digits = 2) %>% kable_styling()

model4.4 <- lm(relogio ~ K_corrected  + Diagnostic + Age + ESC, data = dados_lobos_v1_O)
Anova(model4.4, type="II") %>% kable(digits = 2) %>% kable_styling()
summary(model4.4)

hist(residuals(model4.4),
     col="darkgray")
plot(fitted(model4.4),
     residuals(model4.4))

anova(model4.3,model4.4) %>% kable(digits = 2) %>% kable_styling()
etaSquared(model4.4) %>% kable(digits = 2) %>% kable_styling()

ggplot(data = dados_lobos_v1_P, aes(K_corrected, relogio, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("Lobo parietal, N = ", n_distinct(filter(dados_lobos_v1_P, !is.na(relogio))$SUBJ)))

model4.0.2 <- lm(relogio ~ K_corrected, data = dados_lobos_v1_P)
summary(model4.0.2)
cor.test(y = dados_lobos_v1_P$relogio, x = dados_lobos_v1_P$K_corrected, use = "complete", method = "pearson")
cov(y = dados_lobos_v1_P$relogio, x = dados_lobos_v1_P$K_corrected, use = "complete", method = "pearson")

model4.5 <- lm(relogio ~ K_corrected*Diagnostic*Age*ESC, data = dados_lobos_v1_P)
Anova(model4.5, type="II") %>% kable(digits = 2) %>% kable_styling()

model4.6 <- lm(relogio ~ K_corrected + Diagnostic + Age + ESC, data = dados_lobos_v1_P)
Anova(model4.6, type="II") %>% kable(digits = 2) %>% kable_styling()
summary(model4.6) 

hist(residuals(model4.6),
     col="darkgray")
plot(fitted(model4.6),
     residuals(model4.6))

anova(model4.5,model4.6) %>% kable(digits = 2) %>% kable_styling()
etaSquared(model4.6) %>% kable(digits = 2) %>% kable_styling()

ggplot(data = dados_lobos_v1_F, aes(K_corrected, `DIGIT SPAN BACK`, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("Lobo frontal, N = ", n_distinct(filter(dados_lobos_v1_F, !is.na(`DIGIT SPAN BACK`))$SUBJ)))

model5.0 <- lm(`DIGIT SPAN BACK` ~ K_corrected, data = dados_lobos_v1_F)
summary(model5.0)
cor.test(y = dados_lobos_v1_F$`DIGIT SPAN BACK`, x = dados_lobos_v1_F$K_corrected, use = "complete", method = "pearson")
cov(y = dados_lobos_v1_F$`DIGIT SPAN BACK`, x = dados_lobos_v1_F$K_corrected, use = "complete", method = "pearson")

model5.1 <- lm(`DIGIT SPAN BACK` ~ K_corrected *Diagnostic*Age*ESC, data = dados_lobos_v1_F)
Anova(model5.1, type="II") %>% kable(digits = 2) %>% kable_styling()

model5.2 <- lm(`DIGIT SPAN BACK` ~ K_corrected + Diagnostic + Age + ESC, data = dados_lobos_v1_F)
Anova(model5.2, type="II") %>% kable(digits = 2) %>% kable_styling()
summary(model5.2)


hist(residuals(model5.2),
     col="darkgray")
plot(fitted(model5.2),
     residuals(model5.2))

anova(model5.1,model5.2) %>% kable(digits = 2) %>% kable_styling()
etaSquared(model5.2) %>% kable(digits = 2) %>% kable_styling()


ggplot(data = dados_hemi_v1, aes(K, Lipoxina, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1,  !is.na(Lipoxina))$SUBJ)))

model6.0 <- lm(Lipoxina ~ K, data = dados_hemi_v1)
summary(model6.0)

model6.1 <- lm(Lipoxina ~ K*Diagnostic*Age*ESC, data = dados_hemi_v1)
Anova(model6.1, type="II") %>% kable(digits = 2) %>% kable_styling()

model6.2 <- lm(Lipoxina ~ K+ Diagnostic + Age + ESC, data = dados_hemi_v1)
Anova(model6.2, type="II") %>% kable(digits = 2) %>% kable_styling()
summary(model6.2)

hist(residuals(model6.2),
     col="darkgray")
plot(fitted(model6.2),
     residuals(model6.2))

anova(model6.1,model6.2) %>% kable(digits = 2) %>% kable_styling()
etaSquared(model6.2) %>% kable(digits = 2) %>% kable_styling()


ggplot(data = dados_hemi_v1, aes(K, `AB1-40`, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1,  !is.na(`AB1-40`))$SUBJ)))

model7.0 <- lm(`AB1-40` ~ K, data = dados_hemi_v1)
summary(model7.0)


model7.1 <- lm(K ~ `AB1-40`*Diagnostic*Age*ESC, data = dados_hemi_v1)
Anova(model7.1, type="II") %>% kable(digits = 2) %>% kable_styling()

model7.2 <- lm(K ~ `AB1-40` + Diagnostic + Age + ESC, data = dados_hemi_v1)
Anova(model7.2, type="II") %>% kable(digits = 2) %>% kable_styling()
summary(model7.2) 

hist(residuals(model7.2),
     col="darkgray")
plot(fitted(model7.2),
     residuals(model7.2))

anova(model7.1,model7.2) %>% kable(digits = 2) %>% kable_styling()
etaSquared(model7.2) %>% kable(digits = 2) %>% kable_styling()


ggplot(data = dados_hemi_v1, aes(K, `AB1-42`, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1,  !is.na(`AB1-42`))$SUBJ)))

model8.0 <- lm(`AB1-42` ~ K, data = dados_hemi_v1)
summary(model8.0)


model8.1 <- lm(`AB1-42` ~ K*Diagnostic*Age*ESC, data = dados_hemi_v1)
Anova(model8.1, type="II") %>% kable(digits = 2) %>% kable_styling()

model8.2 <- lm(`AB1-42` ~ K + Diagnostic + Age + ESC, data = dados_hemi_v1)
Anova(model8.2, type="II") %>% kable(digits = 2) %>% kable_styling()
summary(model8.2)

hist(residuals(model8.2),
     col="darkgray")
plot(fitted(model8.2),
     residuals(model8.2))

anova(model8.1,model8.2) %>% kable(digits = 2) %>% kable_styling()
etaSquared(model8.2) %>% kable(digits = 2) %>% kable_styling()

ggplot(data = dados_hemi_v1, aes(K, TAU, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1,  !is.na(TAU))$SUBJ)))

model9.0 <- lm(TAU ~ K, data = dados_hemi_v1)
summary(model9.0)


model9.1 <- lm(TAU ~ K*Diagnostic*Age*ESC, data = dados_hemi_v1)
Anova(model9.1, type="II") %>% kable(digits = 2) %>% kable_styling()

model9.2 <- lm(TAU ~ K+ Diagnostic + Age + ESC, data = dados_hemi_v1)
Anova(model9.2, type="II") %>% kable(digits = 2) %>% kable_styling()
summary(model9.2)


hist(residuals(model9.2),
     col="darkgray")
plot(fitted(model9.2),
     residuals(model9.2))

anova(model9.1,model9.2) %>% kable(digits = 2) %>% kable_styling()
etaSquared(model9.2) %>% kable(digits = 2) %>% kable_styling()


ggplot(data = dados_hemi_v1, aes(K_corrected, AB1_ratio, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1,  !is.na(AB1_ratio))$SUBJ)))

model10.0 <- lm(AB1_ratio ~ K, data = dados_hemi_v1)
summary(model10.0)


model10.1 <- lm(AB1_ratio ~ K_corrected*Diagnostic*Age*ESC, data = dados_hemi_v1)
Anova(model10.1, type="II") %>% kable(digits = 2) %>% kable_styling()

model10.2 <- lm(AB1_ratio ~ K_corrected + Diagnostic + Age + ESC, data = dados_hemi_v1)
Anova(model10.2, type="II") %>% kable(digits = 2) %>% kable_styling()
summary(model10.2)


hist(residuals(model10.2),
     col="darkgray")
plot(fitted(model10.2),
     residuals(model10.2))

anova(model10.1,model10.2) %>% kable(digits = 2) %>% kable_styling()
etaSquared(model10.2) %>% kable(digits = 2) %>% kable_styling()


ggplot(data = dados_hemi_v1, aes(K, TAU_AB1_42_ratio, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1,  !is.na(TAU_AB1_42_ratio))$SUBJ)))

model11.0 <- lm(TAU_AB1_42_ratio ~ K, data = dados_hemi_v1)
summary(model11.0)


model11.1 <- lm(TAU_AB1_42_ratio ~ K*Diagnostic*Age*ESC, data = dados_hemi_v1)
Anova(model11.1, type="II") %>% kable(digits = 2) %>% kable_styling()

model11.2 <- lm(TAU_AB1_42_ratio ~ K + Diagnostic + Age + ESC, data = dados_hemi_v1)
Anova(model11.1, type="II") %>% kable(digits = 2) %>% kable_styling()
summary(model11.2)

hist(residuals(model11.2),
     col="darkgray")
plot(fitted(model11.2),
     residuals(model11.2))

anova(model11.1,model11.2) %>% kable(digits = 2) %>% kable_styling()
etaSquared(model11.2) %>% kable(digits = 2) %>% kable_styling()


ggplot(data = dados_hemi_v1, aes(K, TAU_AB1_ratio, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1,  !is.na(TAU_AB1_ratio))$SUBJ)))

model11.0 <- lm(TAU_AB1_ratio ~ K, data = dados_hemi_v1)
summary(model11.0)

model12.1 <- lm(TAU_AB1_ratio ~ K*Diagnostic*Age*ESC, data = dados_hemi_v1)
Anova(model12.1, type="II") %>% kable(digits = 2) %>% kable_styling()

model12.2 <- lm(TAU_AB1_ratio ~ K + Diagnostic + Age + ESC, data = dados_hemi_v1)
Anova(model12.2, type="II") %>% kable(digits = 2) %>% kable_styling()
summary(model12.2)


hist(residuals(model12.2),
     col="darkgray")
plot(fitted(model12.2),
     residuals(model12.2))


anova(model12.1,model12.2) %>% kable(digits = 2) %>% kable_styling()
etaSquared(model12.2) %>% kable(digits = 2) %>% kable_styling()


```

### clinical data -focused analysis ----

```{r clinical data -focused analysis, eval=FALSE, warning=FALSE, include=FALSE, messAge=FALSE, pAged.print=FALSE}

lm1 <- lm(K_corrected ~ COGNITIVE_INDEX, data = filter(dados_lobos_v1, ROI == "F"), na.action = na.omit)
augment <- augment(lm1)
summary(lm1)

ggplot(data = filter(dados_lobos_v1, ROI == "F"), aes(K_corrected, COGNITIVE_INDEX, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU_AB1_ratio != 0 | !is.na(TAU_AB1_ratio))$SUBJ)))


# dados_lobos_v1$COGNITIVE_INDEX <- as.factor(dados_lobos_v1$COGNITIVE_INDEX)
# dados_lobos_v1$ESC <- as.factor(dados_lobos_v1$ESC)
# dados_lobos_v1$Age <- as.factor(dados_lobos_v1$Age)

lmm1 <- lmer(K_corrected ~ COGNITIVE_INDEX + ESC + Age + Diagnostic + (1 | Diagnostic), data = filter(dados_lobos_v1, ROI == "F"),
    REML = FALSE)
summary(lmm1)
Anova(lmm1) %>% kable(digits = 2) %>% kable_styling()

# dados_lobos_v1$COGNITIVE_INDEX <- as.factor(dados_lobos_v1$COGNITIVE_INDEX)
# dados_lobos_v1$ESC <- as.factor(dados_lobos_v1$ESC)
# dados_lobos_v1$Age <- as.factor(dados_lobos_v1$Age)

lm2 <- lm(K_corrected ~ `TMT B-A`, data = filter(dados_lobos_v1, ROI == "F"), na.action = na.omit)
augment <- augment(lm2)
summary(lm2)

ggplot(data = filter(dados_lobos_v1, ROI == "F"), aes(K_corrected, `TMT B-A`, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU_AB1_ratio != 0 | !is.na(TAU_AB1_ratio))$SUBJ)))

lmm2 <- lmer(K_corrected ~ `TMT B-A` + ESC + Age + Diagnostic + (1 | Diagnostic), data = filter(dados_lobos_v1, ROI == "F"),
    REML = FALSE)
summary(lmm2)
Anova(lmm2) %>% kable(digits = 2) %>% kable_styling()

lm3 <- lm(K_corrected ~ `A7/A5`, data = filter(dados_lobos_v1, ROI == "T"), na.action = na.omit)
augment <- augment(lm3)
summary(lm3)

ggplot(data = filter(dados_lobos_v1, ROI == "T"), aes(K_corrected, `A7/A5`, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU_AB1_ratio != 0 | !is.na(TAU_AB1_ratio))$SUBJ)))

lmm3 <- lmer(K_corrected ~ `A7/A5` + ESC + Age + Diagnostic + (1 | Diagnostic), data = filter(dados_lobos_v1, ROI == "T"),
    REML = FALSE)
summary(lmm3)
Anova(lmm3) %>% kable(digits = 2) %>% kable_styling()


lm4 <- lm(K_corrected ~ relogio, data = filter(dados_lobos_v1, ROI == "T"), na.action = na.omit)
augment <- augment(lm4)
summary(lm4)

ggplot(data = filter(dados_lobos_v1, ROI == "T"), aes(K_corrected, relogio, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU_AB1_ratio != 0 | !is.na(TAU_AB1_ratio))$SUBJ)))

lmm4 <- lmer(K_corrected ~ relogio + ESC + Age + Diagnostic + (1 | Diagnostic), data = filter(dados_lobos_v1, ROI == "T"),
    REML = FALSE)
summary(lmm4)
Anova(lmm4) %>% kable(digits = 2) %>% kable_styling()

lm5 <- lm(K_corrected ~ `DIGIT SPAN BACK`, data = filter(dados_lobos_v1, ROI == "T"), na.action = na.omit)
augment <- augment(lm5)
summary(lm5)

ggplot(data = filter(dados_lobos_v1, ROI == "T"), aes(K_corrected, `DIGIT SPAN BACK`, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU_AB1_ratio != 0 | !is.na(TAU_AB1_ratio))$SUBJ)))

lmm5 <- lmer(K_corrected ~ `DIGIT SPAN BACK` + ESC + Age + Diagnostic +  (1 | Diagnostic), data = filter(dados_lobos_v1, ROI == "T"),
    REML = FALSE)
summary(lmm5)
Anova(lmm5) %>% kable(digits = 2) %>% kable_styling()
```


### and Age

```{r clincal data and Age, eval=FALSE, include=FALSE}

ggplot(data = filter(dados_hemi_v1, Lipoxina != 0 | !is.na(Lipoxina), Diagnostic == "CTL"), aes(Age, log10(Lipoxina), color = Diagnostic, fill = Diagnostic)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, Lipoxina != 0 | !is.na(Lipoxina))$SUBJ))) 

ggplot(data = filter(dados_hemi_v1, MMSE != 0 | !is.na(MMSE), Diagnostic == "CTL"), aes(Age, log10(MMSE), color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, MMSE != 0 | !is.na(MMSE))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `A7/A5` != 0 | !is.na(`A7/A5`), Diagnostic == "CTL"), aes(Age, log10(`A7/A5`),color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `A7/A5` != 0 | !is.na(`A7/A5`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `TMT B-A` != 0 | !is.na(`TMT B-A`), Diagnostic == "CTL"), aes(Age, log10(`TMT B-A`), color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `TMT B-A` != 0 | !is.na(`TMT B-A`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, relogio != 0 | !is.na(relogio), Diagnostic == "CTL"), aes(Age, log10(relogio), color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, relogio != 0 | !is.na(relogio))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `DIGIT SPAN BACK` != 0 | !is.na(`DIGIT SPAN BACK`), Diagnostic == "CTL"), aes(Age, log10(`DIGIT SPAN BACK`), color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `DIGIT SPAN BACK` != 0 | !is.na(`DIGIT SPAN BACK`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `AB1-40` != 0 | !is.na(`AB1-40`), Diagnostic == "CTL"), aes(Age, log10(`AB1-40`), color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `AB1-40` != 0 | !is.na(`AB1-40`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, `AB1-42` != 0 | !is.na(`AB1-42`), Diagnostic == "CTL"), aes(Age, log10(`AB1-42`), color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, `AB1-42` != 0 | !is.na(`AB1-42`))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, TAU != 0 | !is.na(TAU), Diagnostic == "CTL"), aes(Age, log10(TAU), Age, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU != 0 | !is.na(TAU))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, AB1_ratio != 0 | !is.na(AB1_ratio), Diagnostic == "CTL"), aes(Age, log10(AB1_ratio), color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, AB1_ratio != 0 | !is.na(AB1_ratio))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, TAU_AB1_42_ratio != 0 | !is.na(TAU_AB1_42_ratio), Diagnostic == "CTL"), aes(Age, log10(TAU_AB1_42_ratio), color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU_AB1_42_ratio != 0 | !is.na(TAU_AB1_42_ratio))$SUBJ)))

ggplot(data = filter(dados_hemi_v1, TAU_AB1_ratio != 0 | !is.na(TAU_AB1_ratio), Diagnostic == "CTL"), aes(Age, log10(TAU_AB1_ratio), color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, TAU_AB1_ratio != 0 | !is.na(TAU_AB1_ratio))$SUBJ)))
```

### deaging

```{r clincal data - deaging, eval=FALSE, include=FALSE}

ggplot(data = filter(dados_hemi_v1, Lipoxina != 0 | !is.na(Lipoxina)), aes(logLipoxina_age_decay, K_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, Lipoxina != 0 | !is.na(Lipoxina))$SUBJ))) 

ggplot(data = filter(dados_hemi_v1, MMSE != 0 | !is.na(MMSE)), aes(logMMSE_age_decay, K_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, MMSE != 0 | !is.na(MMSE))$SUBJ)))

```

### normalizado

```{r clinical data - normalizado, eval=FALSE, messAge=FALSE, warning=FALSE, include=FALSE}
ggplot(data = filter(dados_hemi_v1, MMSE != 0 | !is.na(MMSE)), aes(logMMSE_age_decay, K_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) +
  geom_point() + stat_cor() + 
  geom_smooth(method = "lm", se = TRUE) +
  theme_pubr() + labs(caption = paste("N = ", n_distinct(filter(dados_hemi_v1, MMSE != 0 | !is.na(MMSE))$SUBJ)))
```

## Escolaridade

```{r escolaridade, eval=FALSE, include=FALSE}

dados_hemi_v1_ESC <- dados_hemi_v1 %>% 
  pivot_longer(c(K, K_age_decay, logAvgThickness, logAvgThickness_age_decay, S, S_age_decay, I, I_age_decay), names_to = "morphological_parameter", values_to = "morphological_parameter_value")

ggplot(data = dados_hemi_v1, aes(x = ESC, y = K, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + 
  geom_point() + geom_smooth(method = "lm") + theme_pubr()

ggplot(data = dados_hemi_v1, aes(x = ESC, y = K_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + 
  geom_point() + geom_smooth(method = "lm") + theme_pubr()

ggplot(data = dados_hemi_v1, aes(x = ESC, y = logAvgThickness, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + 
  geom_point() + geom_smooth(method = "lm") + theme_pubr()

ggplot(data = dados_hemi_v1, aes(x = ESC, y = logAvgThickness_age_decay, color = Diagnostic, fill = Diagnostic, alpha = 0.4)) + 
  geom_point() + geom_smooth(method = "lm") + theme_pubr()

corr_cov_esc <- dados_hemi_v1_ESC %>%
  group_by(morphological_parameter) %>%
  summarise(
    Correlation = cor.test(morphological_parameter_value, ESC, use = "complete", method = "pearson")$estimate,
    pvalue = cor.test(morphological_parameter_value, ESC, use = "complete", method = "pearson")$p.value,
    Covariance = cov(morphological_parameter_value, ESC, use = "complete", method = "pearson")
  ) %>% mutate(Diagnostic = "All", ROI = "Hemisphere", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))

corr_cov_esc %>% group_by(morphological_parameter) %>% mutate(pval.adj = p.adjust (pvalue, method='bonferroni')) %>% kable(digits = 2) %>% kable_styling()


corr_cov_esc$morphological_parameter[corr_cov_esc$morphological_parameter == "K_age_decay"] <- "K"
corr_cov_esc$morphological_parameter[corr_cov_esc$morphological_parameter == "I_age_decay"] <- "I"
corr_cov_esc$morphological_parameter[corr_cov_esc$morphological_parameter == "S_age_decay"] <- "S"
corr_cov_esc$morphological_parameter[corr_cov_esc$morphological_parameter == "S_age_decay"] <- "S"
corr_cov_esc$morphological_parameter[corr_cov_esc$morphological_parameter == "logAvgThickness_age_decay"] <- "logAvgThickness"

corr_cov_esc_diag <- dados_hemi_v1_ESC %>%
  group_by(morphological_parameter, Diagnostic) %>%
  summarise(
    Correlation = cor.test(morphological_parameter_value, ESC, use = "complete", method = "pearson")$estimate,
    pvalue = cor.test(morphological_parameter_value, ESC, use = "complete", method = "pearson")$p.value,
    Covariance = cov(morphological_parameter_value, ESC, use = "complete", method = "pearson")
  ) %>% mutate(ROI = "Hemisphere", Age_correction = ifelse(str_detect(morphological_parameter, "_age_decay", negate = FALSE),"yes","no"))  


corr_cov_esc_diag$morphological_parameter[corr_cov_esc_diag$morphological_parameter == "K_age_decay"] <- "K"
corr_cov_esc_diag$morphological_parameter[corr_cov_esc_diag$morphological_parameter == "I_age_decay"] <- "I"
corr_cov_esc_diag$morphological_parameter[corr_cov_esc_diag$morphological_parameter == "S_age_decay"] <- "S"
corr_cov_esc_diag$morphological_parameter[corr_cov_esc_diag$morphological_parameter == "S_age_decay"] <- "S"
corr_cov_esc_diag$morphological_parameter[corr_cov_esc_diag$morphological_parameter == "logAvgThickness_age_decay"] <- "logAvgThickness"

corr_cov_esc_diag %>% group_by(morphological_parameter) %>% mutate(pval.adj = p.adjust (pvalue, method='bonferroni')) %>% kable(digits = 2) %>% kable_styling()

```

